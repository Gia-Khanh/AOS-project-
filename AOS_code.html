<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd"><html><head></head><body>















    




    
    
    
    

<div class="jp-Cell jp-CodeCell jp-Notebook-cell jp-mod-noOutputs">
<div class="jp-Cell-inputWrapper">
<div class="jp-Collapser jp-InputCollapser jp-Cell-inputCollapser">
</div>
<div class="jp-InputArea jp-Cell-inputArea">
<div class="jp-InputPrompt jp-InputArea-prompt">In&#160;[1]:</div>
<div class="jp-CodeMirrorEditor jp-Editor jp-InputArea-editor">
     <div class="CodeMirror cm-s-jupyter">
<div class="highlight hl-ipython3"><pre><span></span><span class="c1"># import needed packages</span>
<span class="kn">from</span> <span class="nn">datascience</span> <span class="kn">import</span> <span class="o">*</span>
<span class="kn">import</span> <span class="nn">gurobipy</span> <span class="k">as</span> <span class="nn">gp</span>
<span class="kn">from</span> <span class="nn">gurobipy</span> <span class="kn">import</span> <span class="n">GRB</span>
<span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="kn">import</span> <span class="nn">pandas</span> <span class="k">as</span> <span class="nn">pd</span>
<span class="kn">import</span> <span class="nn">math</span>

<span class="c1"># visualization</span>
<span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>
<span class="o">%</span><span class="k">matplotlib</span> inline
</pre></div>

     </div>
</div>
</div>
</div>

</div>
<div class="jp-Cell jp-MarkdownCell jp-Notebook-cell">
<div class="jp-Cell-inputWrapper">
<div class="jp-Collapser jp-InputCollapser jp-Cell-inputCollapser">
</div>
<div class="jp-InputArea jp-Cell-inputArea"><div class="jp-InputPrompt jp-InputArea-prompt">
</div><div class="jp-RenderedHTMLCommon jp-RenderedMarkdown jp-MarkdownOutput">
<h1>MGSC404—Midterm Case Study<a rel="noopener" class="anchor-link" href="#MGSC404%E2%80%94Midterm-Case-Study">&#182;</a></h1><h3>Desautles Faculty of Management, McGill University<a rel="noopener" class="anchor-link" href="#Desautles-Faculty-of-Management,-McGill-University">&#182;</a></h3><h3>February 29th,  2024<a rel="noopener" class="anchor-link" href="#February-29th,--2024">&#182;</a></h3><p>Gia Luong (261119805)</p>
<p>Donald Szeto (260403046)</p>
<p>Junzhe Zhou (260967720)</p>
<p>Kaibo Zhang (261110409)</p>

</div>
</div>
</div>
</div>
<div class="jp-Cell jp-MarkdownCell jp-Notebook-cell">
<div class="jp-Cell-inputWrapper">
<div class="jp-Collapser jp-InputCollapser jp-Cell-inputCollapser">
</div>
<div class="jp-InputArea jp-Cell-inputArea"><div class="jp-InputPrompt jp-InputArea-prompt">
</div><div class="jp-RenderedHTMLCommon jp-RenderedMarkdown jp-MarkdownOutput">
<h2>I. Introduction<a rel="noopener" class="anchor-link" href="#I.-Introduction">&#182;</a></h2><p>American Office Systems Inc., originally an office supply store founded in 1939, transitioned into manufacturing office equipment and entered the copier market. Notably, the company introduced a pioneering product—copier-to-computer adapters that are compatible with IBM and Macintosh (Mac) systems. Despite the product&#39;s promising potential, the firm confronts multifaceted challenges, including restricted brand visibility and initial capital constraints. Navigating these challenges, the company faces urgent needs for astute management of production and marketing investments, strategies that it is short of at the current status quo. In the following sections, the report will explore AOS&#39; financial constraints, cost and revenue structures, and market realities and build a sounding model to provide sounding suggestions for its capital allocations for fiscal year 1996.</p>

</div>
</div>
</div>
</div>
<div class="jp-Cell jp-MarkdownCell jp-Notebook-cell">
<div class="jp-Cell-inputWrapper">
<div class="jp-Collapser jp-InputCollapser jp-Cell-inputCollapser">
</div>
<div class="jp-InputArea jp-Cell-inputArea"><div class="jp-InputPrompt jp-InputArea-prompt">
</div><div class="jp-RenderedHTMLCommon jp-RenderedMarkdown jp-MarkdownOutput">
<h2>II. Model Formulation<a rel="noopener" class="anchor-link" href="#II.-Model-Formulation">&#182;</a></h2><p>To maximize profits, a linear model is formulated and established to help the executive action team make a decision about how to allocate funds between production and advertising, ensuring that all cash flow, financial, accounting, marketing, inventory, and production considerations are taken into account. While the degree of which models adhere to real-life circumstances defines the reliability of the solution produced, to ensure that this model satisfy the immediate needs of use on the next executive meeting, the following assumptions are made.</p>

</div>
</div>
</div>
</div>
<div class="jp-Cell jp-MarkdownCell jp-Notebook-cell">
<div class="jp-Cell-inputWrapper">
<div class="jp-Collapser jp-InputCollapser jp-Cell-inputCollapser">
</div>
<div class="jp-InputArea jp-Cell-inputArea"><div class="jp-InputPrompt jp-InputArea-prompt">
</div><div class="jp-RenderedHTMLCommon jp-RenderedMarkdown jp-MarkdownOutput">
<h4>Assumptions:<a rel="noopener" class="anchor-link" href="#Assumptions:">&#182;</a></h4><ul>
<li><p>The 15% interest rate of the 750,000 dollars line of credit for 1996 from Citibank is an annual rate that can be converted to quarterly rate (15%/4). The accured interest is paid at the end of each quarter. In addition, the company will borrow all of the avaliable credits from it and treat the amount as a lump sum loan.</p>
</li>
<li><p>The 6% annual return on short-term government securities matures quarterly. Its quarterly rate can be computed as 6%/4.</p>
</li>
<li><p>Due to lack of information about the company&#39;s cashflow in the previous year, the company is assumed to start blank in 1996 onward. All the past lines of credit have already been spent and fully paid back to the institution of issuance. Past investments have matured and gains on interests have deposited.</p>
</li>
<li><p>Except the 750,000 line of credit, the company has no other cash on its books or other funds for sustaining operations starting in year 1996.</p>
</li>
<li><p>The factory has the capacity and capability to operate 12 hrs per day for 20 production days each month.</p>
</li>
<li><p>The 1% inventory carry-on cost for each month is calculated based on the COGs (their production variable cost) of the items in stock. Let $I_{a}$ denotes for the monetary value of monthly inventory. The monthly inventory cost is then calculated by 0.01&#183;$I_{a}$. The quarterly inventory cost is the total cost of the three months: 0.01&#183;$I_{1}$+0.01&#183;$I_{2}$+0.01&#183;$I_{3}$=0.01&#183;($I_{1}+I_{2}+I_{3}$). Thus the quarterly inventory carry-on cost is also 1%.</p>
</li>
<li><p>All cash flows occur at the end of the quarter.</p>
</li>
<li><p>Adertisement efforts will reflect immediately on the maximum possible sales (maximum expected sales + advertisement effect) of the same quarter.</p>
</li>
<li><p>All left cash on the company&#39;s book, including revenues earned from operation, will be directed toward short-term investments.</p>
</li>
<li><p>When computing the total profit generated at the end of the year (4th quarter), the initial credit line of 750,000 will be deducted as loan payable, a liability account.</p>
</li>
</ul>

</div>
</div>
</div>
</div>
<div class="jp-Cell jp-MarkdownCell jp-Notebook-cell">
<div class="jp-Cell-inputWrapper">
<div class="jp-Collapser jp-InputCollapser jp-Cell-inputCollapser">
</div>
<div class="jp-InputArea jp-Cell-inputArea"><div class="jp-InputPrompt jp-InputArea-prompt">
</div><div class="jp-RenderedHTMLCommon jp-RenderedMarkdown jp-MarkdownOutput">
<h4>Decision Variable<a rel="noopener" class="anchor-link" href="#Decision-Variable">&#182;</a></h4><ul>
<li>$Adv_{t}$ -&gt; money allocated to advertisement in quarter t.</li>
<li>$AdvIbm_{t}$ -&gt; money allocated to advertising IBM adapters in quarter t.</li>
<li>$AdvMac_{t}$ -&gt; money allocated to advertising Mac adapters in quarter t.</li>
<li>$Ibm_{t}$ -&gt; number of IBM version adapters to produce in quarter t.</li>
<li>$Mac_{t}$ -&gt; number of Mac version adapters to produce in quarter t.</li>
<li>$Prod_{t}$ -&gt; money allocated to production in quarter t.</li>
<li>$Sibm_{t}$ -&gt; number of IBM version adapters sold in quarter t.</li>
<li>$Smac_{t}$ -&gt; number of Mac version adapters sold in quarter t.</li>
<li>$InvIbm_{t}$ -&gt; the inventory of IBM version adapters at the end of quarter t.</li>
<li>$InvMac_{t}$ -&gt; the inventory of Mac version adapters at the end of quarter t.</li>
<li>$Invest_{t}$ -&gt; excess money allocated to short-term government securities in quarter t.</li>
<li>$Rev_{t}$ -&gt; total operational revenue made in quarter t.</li>
</ul>

</div>
</div>
</div>
</div>
<div class="jp-Cell jp-MarkdownCell jp-Notebook-cell">
<div class="jp-Cell-inputWrapper">
<div class="jp-Collapser jp-InputCollapser jp-Cell-inputCollapser">
</div>
<div class="jp-InputArea jp-Cell-inputArea"><div class="jp-InputPrompt jp-InputArea-prompt">
</div><div class="jp-RenderedHTMLCommon jp-RenderedMarkdown jp-MarkdownOutput">
<h4>Parameters<a rel="noopener" class="anchor-link" href="#Parameters">&#182;</a></h4><ul>
<li>Let <strong>$t \in \text{{1,2,3,4}}$</strong> denotes for the end of quarters 1,2,3,4 of 1996, respectively.</li>
<li>Let <em>Pibm</em> = 175 denotes for the price of one IBM version adapter.</li>
<li>Let <em>Pmac</em> = 200 denotes for the price of one Mac version adapter.</li>
<li>Let <em>Cibm</em> = 100 denotes for the cost of producing one IBM version adapter.</li>
<li>Let <em>Cmac</em> = 110 denotes for the price of producing one Mac version adapter.</li>
<li>Let <em>CreditCost</em> = 750000&#183;(0.15/4) denotes for the quarterly the monthly interest costs from the loan.</li>
<li>Let <em>CreditLine</em> = 750000 denotes for the inital credit line at the beginning of the year.</li>
<li>The company holds beginning inventory of 10,000 IBM and 5,000 Macintosh adapters in quarter 1.</li>
</ul>

</div>
</div>
</div>
</div>
<div class="jp-Cell jp-MarkdownCell jp-Notebook-cell">
<div class="jp-Cell-inputWrapper">
<div class="jp-Collapser jp-InputCollapser jp-Cell-inputCollapser">
</div>
<div class="jp-InputArea jp-Cell-inputArea"><div class="jp-InputPrompt jp-InputArea-prompt">
</div><div class="jp-RenderedHTMLCommon jp-RenderedMarkdown jp-MarkdownOutput">
<h4>Objective Function<a rel="noopener" class="anchor-link" href="#Objective-Function">&#182;</a></h4>$$max \sum_{t=1}^{4} (0.06/4)&#183;Invest_{t-1}+ Rev_{t} - Prod_{t} - Adv_{t} - 0.01&#183;(Cibm&#183;InvIbm_{t} + Cmac&#183;InvMac_{t}) - CreditCost - FixedCost, ~\forall t$$
</div>
</div>
</div>
</div>
<div class="jp-Cell jp-MarkdownCell jp-Notebook-cell">
<div class="jp-Cell-inputWrapper">
<div class="jp-Collapser jp-InputCollapser jp-Cell-inputCollapser">
</div>
<div class="jp-InputArea jp-Cell-inputArea"><div class="jp-InputPrompt jp-InputArea-prompt">
</div><div class="jp-RenderedHTMLCommon jp-RenderedMarkdown jp-MarkdownOutput">
<h4>Constraints<a rel="noopener" class="anchor-link" href="#Constraints">&#182;</a></h4><ol>
<li>Demand Constraints</li>
</ol>
<ul>
<li>The sales of adapaters cannot exceed the maximum expected sales and the subsequent effects of advertisement of that quarter. The advertisement effect is defined as the maximum expected sales will increase by 1 unit for every 10 dollars spent in advertisement.</li>
</ul>
$$Sibm_{t} ≤ E[ibmDemand_{t}] + Adv_{t}/10,$$$$Smac_{t} ≤ E[macDemand_{t}] + Adv_{t}/10$$<p>Algebraic Form：</p>
$$ Sibm_{t} - AdvIbm_{t}/10 ≤ E[ibmDemand_{t}],$$$$ Smac_{t} - AdvMac_{t}/10 ≤ E[macDemand_{t}]$$<ol>
<li>Inventory Constraints</li>
</ol>
<ul>
<li>The sales of adapters cannot exceed the number of items in hand.</li>
</ul>
$$Sibm_{t} ≤ InvIbm_{t-1} + Ibm_{t},$$<p>
$$Smac_{t} ≤ InvMac_{t-1} + Mac_{t}$$</p>
<p>Algebraic Form：</p>
$$InvIbm_{t-1} + Ibm_{t} - Sibm_{t} ≥ 0,$$<p>
$$InvMac_{t-1} + Mac_{t} - Smac_{t} ≥ 0$$</p>
<ul>
<li>Inventory of each adapter is equal to the inventory of the previous quarter + number produced - number sold.</li>
</ul>
$$InvIbm_{t} = InvIbm_{t-1} + Ibm_{t} - Sibm_{t},$$$$InvMac_{t} = InvMac_{t-1} + Mac_{t} - Smac_{t}$$<p>Algebraic Form：</p>
$$InvIbm_{t-1} + Ibm_{t} - Sibm_{t} - InvIbm_{t} = 0,$$$$InvIbm_{t-1} + Ibm_{t} - Sibm_{t} - InvMac_{t} = 0$$<ol>
<li>Cashflow Constraints</li>
</ol>
<ul>
<li>The total avaliable funds at the beginning of quarter 1 is 750,000 dollars. Excess funds, or money to be invested in short-term securities, is updated at the end of each quarter. For each quarter, money invested at the end of the last quarter will mature. Together with the revenue generated, operation costs, such as production, advertisement, inventory carry-on, and the loan&#39;s accured interest will be substracted to compute the excess fund. </li>
</ul>
<p>for t = 1:</p>
$$ 750,000 + Rev_{1} - Pord_{1} - Adv_{1} - 0.01&#183;(Cibm&#183;InvIbm_{1} + Cmac&#183;InvMac_{1}) - CreditCost - FixedCost = Invest_{1} $$<p>Algebraic Form：</p>
$$ Invest_{1} - Rev_{1} + Pord_{1} + Adv_{1} + 0.01&#183;(Cibm&#183;InvIbm_{1} + Cmac&#183;InvMac_{1}) + CreditCost + FixedCost = 750,000 $$<p>for t &gt; 1:</p>
$$(1 + 0.06/4)&#183;Invest_{t-1} + Rev_{t} - Pord_{t} - Adv_{t} - 0.01&#183;(Cibm&#183;InvIbm_{t} + Cmac&#183;InvMac_{t}) - CreditCost - FixedCost = Invest_{t}$$<p>Algebraic Form：</p>
$$Invest_{t} - (1 + 0.06/4)&#183;Invest_{t-1} - Rev_{t} + Pord_{t} + Adv_{t} + 0.01&#183;(Cibm&#183;InvIbm_{t} + Cmac&#183;InvMac_{t}) + CreditCost + FixedCost = 0$$<ol>
<li>Production Constraints</li>
</ol>
<ul>
<li>for t &lt; 4, production plus the end-of-period inventory should be at least 10% larger than the estimated sales for the next period.</li>
</ul>
$$ Ibm_{t} + InvIbm_{t} ≥ 1.1&#183;E[ibmDemand_{t+1}],$$<p>
$$ Mac_{t} + InvMac_{t} ≥ 1.1&#183;E[macDemand_{t+1}]$$</p>
<ul>
<li>for t &lt; 4, production in each quarter cannot exceed the production capacity of 30 IBM adapters and 10 Macintosh adapters per hour.</li>
</ul>
$$  Ibm_{t} ≤ 30&#183;12&#183;20&#183;3,$$$$  Mac_{t} ≤ 10&#183;12&#183;20&#183;3$$<ul>
<li>for t = 4, the inventory level plus production at the end of the fourth quarter should be at least twice the maximum expected sales for that quarter.</li>
</ul>
$$ Ibm_{4} + InvIbm_{4} ≥ 2&#183;E[ibmDemand_{4}],$$<p>
$$ Mac_{4} + InvMac_{4} ≥ 2&#183;E[macDemand_{4}]$$</p>
<ul>
<li>for t = 4, the production capacity will increase by 10%.</li>
</ul>
$$ Ibm_{4} ≤ 1.1&#183;30&#183;12&#183;20&#183;3,$$$$ Mac_{4} ≤ 1.1&#183;10&#183;12&#183;20&#183;3 $$<ol>
<li>Variable Relationship Constraints</li>
</ol>
<ul>
<li>Total Advertisement cost in quarter t is equal to the sum of the respective funds allocated to advertise each adapter.</li>
</ul>
$$ AdvIbm_{t} + AdvMac_{t} = Adv_{t}$$<p>Algebraic Form：</p>
$$ AdvIbm_{t} + AdvMac_{t} - Adv_{t} = 0$$<ul>
<li>Production cost in quarter t is equal to the variable costs of each adapter times the number of each adapter produced.</li>
</ul>
$$ Cibm&#183;Ibm_{t} +  Cmac&#183;Mac_{t} = Prod_{t} $$<p>Algebraic Form：</p>
$$ Cibm&#183;Ibm_{t} +  Cmac&#183;Mac_{t} - Prod_{t} = 0 $$<ul>
<li>Revenue in quarter t is equal to the total value of collectibles of account receivables.</li>
</ul>
$$ 0.75&#183;Pibm&#183;Sibm_{t} + 0.8&#183;Pmac&#183;Smac_{t} + 0.2&#183;Pibm&#183;Sibm_{t-1} + 0.11&#183;Pmac&#183;Smac_{t-1} + 0.03&#183;Pibm&#183;Sibm_{t-2} + 0.05&#183;Pmac&#183;Smac_{t-2} + 0.02&#183;0.5&#183;Pibm&#183;Sibm_{t-3} + 0.04&#183;0.5&#183;Pmac&#183;Smac_{t-3} = Rev_{t}$$<p>Algebraic Form：</p>
$$ 0.75&#183;Pibm&#183;Sibm_{t} + 0.8&#183;Pmac&#183;Smac_{t} + 0.2&#183;Pibm&#183;Sibm_{t-1} + 0.11&#183;Pmac&#183;Smac_{t-1} + 0.03&#183;Pibm&#183;Sibm_{t-2} + 0.05&#183;Pmac&#183;Smac_{t-2} + 0.02&#183;0.5&#183;Pibm&#183;Sibm_{t-3} + 0.04&#183;0.5&#183;Pmac&#183;Smac_{t-3} - Rev_{t} = 0$$<ol>
<li>Nonnegativity Constraints</li>
</ol>
$$ Adv_{t},AdvIbm_{t},AdvMac_{t},Ibm_{t},Mac_{t},Prod_{t},Sibm_{t},Smac_{t},InvIbm_{t},InvMac_{t},Invest_{t},Rev_{t} ≥ 0 $$
</div>
</div>
</div>
</div>
<div class="jp-Cell jp-MarkdownCell jp-Notebook-cell">
<div class="jp-Cell-inputWrapper">
<div class="jp-Collapser jp-InputCollapser jp-Cell-inputCollapser">
</div>
<div class="jp-InputArea jp-Cell-inputArea"><div class="jp-InputPrompt jp-InputArea-prompt">
</div><div class="jp-RenderedHTMLCommon jp-RenderedMarkdown jp-MarkdownOutput">
<h2>III. Model Implementation<a rel="noopener" class="anchor-link" href="#III.-Model-Implementation">&#182;</a></h2><p>Based on the formulation, a linear optimization model is implemented and solved in Gurobi.</p>

</div>
</div>
</div>
</div>
<div class="jp-Cell jp-MarkdownCell jp-Notebook-cell">
<div class="jp-Cell-inputWrapper">
<div class="jp-Collapser jp-InputCollapser jp-Cell-inputCollapser">
</div>
<div class="jp-InputArea jp-Cell-inputArea"><div class="jp-InputPrompt jp-InputArea-prompt">
</div><div class="jp-RenderedHTMLCommon jp-RenderedMarkdown jp-MarkdownOutput">
<h3>a. Data Importation<a rel="noopener" class="anchor-link" href="#a.-Data-Importation">&#182;</a></h3><p>Before moving to the actual establishment, data collected and the estimates made by the members of the executive action team is imported as tables.</p>

</div>
</div>
</div>
</div>
<div class="jp-Cell jp-MarkdownCell jp-Notebook-cell">
<div class="jp-Cell-inputWrapper">
<div class="jp-Collapser jp-InputCollapser jp-Cell-inputCollapser">
</div>
<div class="jp-InputArea jp-Cell-inputArea"><div class="jp-InputPrompt jp-InputArea-prompt">
</div><div class="jp-RenderedHTMLCommon jp-RenderedMarkdown jp-MarkdownOutput">
<p><strong>1.Fixed Cost:</strong> The original the list of quarterly fixed operating expenses is replicated as below. However, for simplicity, this value is decreased to $0.15 million (150000).</p>

</div>
</div>
</div>
</div><div class="jp-Cell jp-CodeCell jp-Notebook-cell">
<div class="jp-Cell-inputWrapper">
<div class="jp-Collapser jp-InputCollapser jp-Cell-inputCollapser">
</div>
<div class="jp-InputArea jp-Cell-inputArea">
<div class="jp-InputPrompt jp-InputArea-prompt">In&#160;[2]:</div>
<div class="jp-CodeMirrorEditor jp-Editor jp-InputArea-editor">
     <div class="CodeMirror cm-s-jupyter">
<div class="highlight hl-ipython3"><pre><span></span><span class="c1"># fixed cost table</span>
<span class="n">cost</span> <span class="o">=</span> <span class="n">make_array</span><span class="p">(</span><span class="mi">1500000</span><span class="p">,</span><span class="mi">750000</span><span class="p">,</span><span class="mi">750000</span><span class="p">,</span><span class="mi">100000</span><span class="p">)</span>
<span class="n">expense</span> <span class="o">=</span> <span class="n">make_array</span><span class="p">(</span><span class="s1">&#39;Administrative Expense&#39;</span><span class="p">,</span><span class="s1">&#39;Fixed Manufacturing Costs&#39;</span><span class="p">,</span><span class="s1">&#39;Sales Agents’ Salaries&#39;</span><span class="p">,</span><span class="s1">&#39;Depreciation&#39;</span><span class="p">)</span>
<span class="n">fixedCost_tbl</span> <span class="o">=</span> <span class="n">Table</span><span class="p">()</span><span class="o">.</span><span class="n">with_columns</span><span class="p">(</span><span class="s1">&#39;Expense&#39;</span><span class="p">,</span><span class="n">expense</span><span class="p">,</span><span class="s1">&#39;Cost&#39;</span><span class="p">,</span><span class="n">cost</span><span class="p">)</span>
<span class="n">fixedCost_tbl</span>
</pre></div>

     </div>
</div>
</div>
</div>

<div class="jp-Cell-outputWrapper">
<div class="jp-Collapser jp-OutputCollapser jp-Cell-outputCollapser">
</div>


<div class="jp-OutputArea jp-Cell-outputArea">

<div class="jp-OutputArea-child">

    
    <div class="jp-OutputPrompt jp-OutputArea-prompt">Out[2]:</div>



<div class="jp-RenderedHTMLCommon jp-RenderedHTML jp-OutputArea-output jp-OutputArea-executeResult">
<table border="1" class="dataframe">
    <thead>
        <tr>
            <th>Expense</th> <th>Cost</th>
        </tr>
    </thead>
    <tbody>
        <tr>
            <td>Administrative Expense   </td> <td>1500000</td>
        </tr>
        <tr>
            <td>Fixed Manufacturing Costs</td> <td>750000 </td>
        </tr>
        <tr>
            <td>Sales Agents’ Salaries   </td> <td>750000 </td>
        </tr>
        <tr>
            <td>Depreciation             </td> <td>100000 </td>
        </tr>
    </tbody>
</table>
</div>

</div>

</div>

</div>

</div>
<div class="jp-Cell jp-MarkdownCell jp-Notebook-cell">
<div class="jp-Cell-inputWrapper">
<div class="jp-Collapser jp-InputCollapser jp-Cell-inputCollapser">
</div>
<div class="jp-InputArea jp-Cell-inputArea"><div class="jp-InputPrompt jp-InputArea-prompt">
</div><div class="jp-RenderedHTMLCommon jp-RenderedMarkdown jp-MarkdownOutput">
<p><strong>2.Maximum Expected Sales:</strong> past sales data from the last three quarters of 1995 and the demand forecast made by the executive team are imported into the table as below. Data from Q1 1995 is excluded because it is irrelevent with AOS&#39; operations in 1996. Its collectibles were fully collected at the end of Q4 1995.</p>

</div>
</div>
</div>
</div><div class="jp-Cell jp-CodeCell jp-Notebook-cell">
<div class="jp-Cell-inputWrapper">
<div class="jp-Collapser jp-InputCollapser jp-Cell-inputCollapser">
</div>
<div class="jp-InputArea jp-Cell-inputArea">
<div class="jp-InputPrompt jp-InputArea-prompt">In&#160;[3]:</div>
<div class="jp-CodeMirrorEditor jp-Editor jp-InputArea-editor">
     <div class="CodeMirror cm-s-jupyter">
<div class="highlight hl-ipython3"><pre><span></span><span class="c1"># maximum expected sales for 1996</span>
<span class="n">ibm</span> <span class="o">=</span> <span class="n">make_array</span><span class="p">(</span><span class="mi">6000</span><span class="p">,</span><span class="mi">7000</span><span class="p">,</span><span class="mi">8000</span><span class="p">,</span><span class="mi">9000</span><span class="p">,</span><span class="mi">10000</span><span class="p">,</span><span class="mi">11000</span><span class="p">,</span><span class="mi">12000</span><span class="p">)</span>
<span class="n">mac</span> <span class="o">=</span> <span class="n">make_array</span><span class="p">(</span><span class="mi">1200</span><span class="p">,</span><span class="mi">1400</span><span class="p">,</span><span class="mi">1600</span><span class="p">,</span><span class="mi">1800</span><span class="p">,</span><span class="mi">2000</span><span class="p">,</span><span class="mi">2200</span><span class="p">,</span><span class="mi">2400</span><span class="p">)</span>
<span class="n">quarter</span> <span class="o">=</span> <span class="n">make_array</span><span class="p">(</span><span class="s1">&#39;1995 Q2&#39;</span><span class="p">,</span><span class="s1">&#39;1995 Q3&#39;</span><span class="p">,</span><span class="s1">&#39;1995 Q4&#39;</span><span class="p">,</span><span class="s1">&#39;1996 Q1&#39;</span><span class="p">,</span><span class="s1">&#39;1996 Q2&#39;</span><span class="p">,</span><span class="s1">&#39;1995 Q3&#39;</span><span class="p">,</span><span class="s1">&#39;1995 Q4&#39;</span><span class="p">)</span>
<span class="n">demand</span> <span class="o">=</span> <span class="n">Table</span><span class="p">()</span><span class="o">.</span><span class="n">with_columns</span><span class="p">(</span><span class="s1">&#39;Quarter&#39;</span><span class="p">,</span><span class="n">quarter</span><span class="p">,</span><span class="s1">&#39;IBM&#39;</span><span class="p">,</span><span class="n">ibm</span><span class="p">,</span><span class="s1">&#39;Mac&#39;</span><span class="p">,</span><span class="n">mac</span><span class="p">)</span>
<span class="n">demand</span>
</pre></div>

     </div>
</div>
</div>
</div>

<div class="jp-Cell-outputWrapper">
<div class="jp-Collapser jp-OutputCollapser jp-Cell-outputCollapser">
</div>


<div class="jp-OutputArea jp-Cell-outputArea">

<div class="jp-OutputArea-child">

    
    <div class="jp-OutputPrompt jp-OutputArea-prompt">Out[3]:</div>



<div class="jp-RenderedHTMLCommon jp-RenderedHTML jp-OutputArea-output jp-OutputArea-executeResult">
<table border="1" class="dataframe">
    <thead>
        <tr>
            <th>Quarter</th> <th>IBM</th> <th>Mac</th>
        </tr>
    </thead>
    <tbody>
        <tr>
            <td>1995 Q2</td> <td>6000 </td> <td>1200</td>
        </tr>
        <tr>
            <td>1995 Q3</td> <td>7000 </td> <td>1400</td>
        </tr>
        <tr>
            <td>1995 Q4</td> <td>8000 </td> <td>1600</td>
        </tr>
        <tr>
            <td>1996 Q1</td> <td>9000 </td> <td>1800</td>
        </tr>
        <tr>
            <td>1996 Q2</td> <td>10000</td> <td>2000</td>
        </tr>
        <tr>
            <td>1995 Q3</td> <td>11000</td> <td>2200</td>
        </tr>
        <tr>
            <td>1995 Q4</td> <td>12000</td> <td>2400</td>
        </tr>
    </tbody>
</table>
</div>

</div>

</div>

</div>

</div><div class="jp-Cell jp-CodeCell jp-Notebook-cell jp-mod-noOutputs">
<div class="jp-Cell-inputWrapper">
<div class="jp-Collapser jp-InputCollapser jp-Cell-inputCollapser">
</div>
<div class="jp-InputArea jp-Cell-inputArea">
<div class="jp-InputPrompt jp-InputArea-prompt">In&#160;[4]:</div>
<div class="jp-CodeMirrorEditor jp-Editor jp-InputArea-editor">
     <div class="CodeMirror cm-s-jupyter">
<div class="highlight hl-ipython3"><pre><span></span><span class="c1"># demand</span>
<span class="n">demand_ibm</span> <span class="o">=</span> <span class="n">demand</span><span class="o">.</span><span class="n">column</span><span class="p">(</span><span class="s1">&#39;IBM&#39;</span><span class="p">)</span>
<span class="n">demand_mac</span> <span class="o">=</span> <span class="n">demand</span><span class="o">.</span><span class="n">column</span><span class="p">(</span><span class="s1">&#39;Mac&#39;</span><span class="p">)</span>
</pre></div>

     </div>
</div>
</div>
</div>

</div>
<div class="jp-Cell jp-MarkdownCell jp-Notebook-cell">
<div class="jp-Cell-inputWrapper">
<div class="jp-Collapser jp-InputCollapser jp-Cell-inputCollapser">
</div>
<div class="jp-InputArea jp-Cell-inputArea"><div class="jp-InputPrompt jp-InputArea-prompt">
</div><div class="jp-RenderedHTMLCommon jp-RenderedMarkdown jp-MarkdownOutput">
<p><strong>3.Account Receivable Rates:</strong> The rates are recorded in the table below.</p>

</div>
</div>
</div>
</div><div class="jp-Cell jp-CodeCell jp-Notebook-cell">
<div class="jp-Cell-inputWrapper">
<div class="jp-Collapser jp-InputCollapser jp-Cell-inputCollapser">
</div>
<div class="jp-InputArea jp-Cell-inputArea">
<div class="jp-InputPrompt jp-InputArea-prompt">In&#160;[5]:</div>
<div class="jp-CodeMirrorEditor jp-Editor jp-InputArea-editor">
     <div class="CodeMirror cm-s-jupyter">
<div class="highlight hl-ipython3"><pre><span></span><span class="n">coll_ibm</span> <span class="o">=</span> <span class="n">make_array</span><span class="p">(</span><span class="mf">0.75</span><span class="p">,</span><span class="mf">0.20</span><span class="p">,</span><span class="mf">0.03</span><span class="p">,</span><span class="mf">0.02</span><span class="p">)</span>
<span class="n">coll_mac</span> <span class="o">=</span> <span class="n">make_array</span><span class="p">(</span><span class="mf">0.80</span><span class="p">,</span><span class="mf">0.11</span><span class="p">,</span><span class="mf">0.05</span><span class="p">,</span><span class="mf">0.04</span><span class="p">)</span>
<span class="n">qua</span> <span class="o">=</span> <span class="n">make_array</span><span class="p">(</span><span class="s1">&#39;Current Quarter&#39;</span><span class="p">,</span><span class="s1">&#39;Following Quarter&#39;</span><span class="p">,</span><span class="s1">&#39;Third Quarter&#39;</span><span class="p">,</span><span class="s1">&#39;Uncollectible&#39;</span><span class="p">)</span>
<span class="n">coll</span> <span class="o">=</span> <span class="n">Table</span><span class="p">()</span><span class="o">.</span><span class="n">with_columns</span><span class="p">(</span><span class="s1">&#39;Quarter&#39;</span><span class="p">,</span><span class="n">qua</span><span class="p">,</span><span class="s1">&#39;IBM&#39;</span><span class="p">,</span><span class="n">coll_ibm</span><span class="p">,</span><span class="s1">&#39;Mac&#39;</span><span class="p">,</span><span class="n">coll_mac</span><span class="p">)</span>
<span class="n">coll</span>
</pre></div>

     </div>
</div>
</div>
</div>

<div class="jp-Cell-outputWrapper">
<div class="jp-Collapser jp-OutputCollapser jp-Cell-outputCollapser">
</div>


<div class="jp-OutputArea jp-Cell-outputArea">

<div class="jp-OutputArea-child">

    
    <div class="jp-OutputPrompt jp-OutputArea-prompt">Out[5]:</div>



<div class="jp-RenderedHTMLCommon jp-RenderedHTML jp-OutputArea-output jp-OutputArea-executeResult">
<table border="1" class="dataframe">
    <thead>
        <tr>
            <th>Quarter</th> <th>IBM</th> <th>Mac</th>
        </tr>
    </thead>
    <tbody>
        <tr>
            <td>Current Quarter  </td> <td>0.75</td> <td>0.8 </td>
        </tr>
        <tr>
            <td>Following Quarter</td> <td>0.2 </td> <td>0.11</td>
        </tr>
        <tr>
            <td>Third Quarter    </td> <td>0.03</td> <td>0.05</td>
        </tr>
        <tr>
            <td>Uncollectible    </td> <td>0.02</td> <td>0.04</td>
        </tr>
    </tbody>
</table>
</div>

</div>

</div>

</div>

</div><div class="jp-Cell jp-CodeCell jp-Notebook-cell jp-mod-noOutputs">
<div class="jp-Cell-inputWrapper">
<div class="jp-Collapser jp-InputCollapser jp-Cell-inputCollapser">
</div>
<div class="jp-InputArea jp-Cell-inputArea">
<div class="jp-InputPrompt jp-InputArea-prompt">In&#160;[6]:</div>
<div class="jp-CodeMirrorEditor jp-Editor jp-InputArea-editor">
     <div class="CodeMirror cm-s-jupyter">
<div class="highlight hl-ipython3"><pre><span></span><span class="c1"># collectible rate</span>
<span class="n">coll_rate</span> <span class="o">=</span> <span class="p">{</span>
    <span class="s1">&#39;ibm&#39;</span><span class="p">:</span><span class="n">coll_ibm</span><span class="p">,</span>
    <span class="s1">&#39;mac&#39;</span><span class="p">:</span><span class="n">coll_mac</span>
<span class="p">}</span>
</pre></div>

     </div>
</div>
</div>
</div>

</div>
<div class="jp-Cell jp-MarkdownCell jp-Notebook-cell">
<div class="jp-Cell-inputWrapper">
<div class="jp-Collapser jp-InputCollapser jp-Cell-inputCollapser">
</div>
<div class="jp-InputArea jp-Cell-inputArea"><div class="jp-InputPrompt jp-InputArea-prompt">
</div><div class="jp-RenderedHTMLCommon jp-RenderedMarkdown jp-MarkdownOutput">
<h3>b. Physical Model<a rel="noopener" class="anchor-link" href="#b.-Physical-Model">&#182;</a></h3><p>The following section documents the related Python codes for model implementation. A list of id labels is created for future identification purposes.</p>

</div>
</div>
</div>
</div><div class="jp-Cell jp-CodeCell jp-Notebook-cell jp-mod-noOutputs">
<div class="jp-Cell-inputWrapper">
<div class="jp-Collapser jp-InputCollapser jp-Cell-inputCollapser">
</div>
<div class="jp-InputArea jp-Cell-inputArea">
<div class="jp-InputPrompt jp-InputArea-prompt">In&#160;[7]:</div>
<div class="jp-CodeMirrorEditor jp-Editor jp-InputArea-editor">
     <div class="CodeMirror cm-s-jupyter">
<div class="highlight hl-ipython3"><pre><span></span><span class="c1"># id label for vars</span>
<span class="n">id_lbl</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;1995 Q2&#39;</span><span class="p">,</span><span class="s1">&#39;1995 Q3&#39;</span><span class="p">,</span><span class="s1">&#39;1995 Q4&#39;</span><span class="p">,</span><span class="s1">&#39;1996 Q1&#39;</span><span class="p">,</span><span class="s1">&#39;1996 Q2&#39;</span><span class="p">,</span><span class="s1">&#39;1996 Q3&#39;</span><span class="p">,</span><span class="s1">&#39;1996 Q4&#39;</span><span class="p">]</span>
</pre></div>

     </div>
</div>
</div>
</div>

</div><div class="jp-Cell jp-CodeCell jp-Notebook-cell jp-mod-noOutputs">
<div class="jp-Cell-inputWrapper">
<div class="jp-Collapser jp-InputCollapser jp-Cell-inputCollapser">
</div>
<div class="jp-InputArea jp-Cell-inputArea">
<div class="jp-InputPrompt jp-InputArea-prompt">In&#160;[8]:</div>
<div class="jp-CodeMirrorEditor jp-Editor jp-InputArea-editor">
     <div class="CodeMirror cm-s-jupyter">
<div class="highlight hl-ipython3"><pre><span></span><span class="c1"># sensitivity table function</span>
<span class="k">def</span> <span class="nf">sensitivity_analysis_table</span><span class="p">(</span><span class="n">model</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">:</span>
    <span class="c1"># Ensure the model has been solved</span>
    <span class="k">if</span> <span class="n">model</span><span class="o">.</span><span class="n">Status</span> <span class="o">!=</span> <span class="mi">2</span><span class="p">:</span>  <span class="c1"># Model status 2 is &#39;Optimized&#39;</span>
        <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;Model must be optimized before sensitivity analysis can be performed.&quot;</span><span class="p">)</span>
    
    <span class="c1"># Collecting sensitivity analysis for variables</span>
    <span class="n">variables_data</span> <span class="o">=</span> <span class="p">{</span>
        <span class="s1">&#39;Variable&#39;</span><span class="p">:</span> <span class="p">[],</span>
        <span class="s1">&#39;Optimal Value&#39;</span><span class="p">:</span> <span class="p">[],</span>
        <span class="s1">&#39;Reduced Cost&#39;</span><span class="p">:</span> <span class="p">[],</span>
        <span class="s1">&#39;Allowable Increase (Obj Coeff)&#39;</span><span class="p">:</span> <span class="p">[],</span>
        <span class="s1">&#39;Allowable Decrease (Obj Coeff)&#39;</span><span class="p">:</span> <span class="p">[]</span>
    <span class="p">}</span>
    <span class="k">for</span> <span class="n">v</span> <span class="ow">in</span> <span class="n">model</span><span class="o">.</span><span class="n">getVars</span><span class="p">():</span>
        <span class="n">variables_data</span><span class="p">[</span><span class="s1">&#39;Variable&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">v</span><span class="o">.</span><span class="n">VarName</span><span class="p">)</span>
        <span class="n">variables_data</span><span class="p">[</span><span class="s1">&#39;Optimal Value&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">v</span><span class="o">.</span><span class="n">X</span><span class="p">)</span>
        <span class="n">variables_data</span><span class="p">[</span><span class="s1">&#39;Reduced Cost&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">v</span><span class="o">.</span><span class="n">RC</span><span class="p">)</span>
        <span class="n">variables_data</span><span class="p">[</span><span class="s1">&#39;Allowable Increase (Obj Coeff)&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">v</span><span class="o">.</span><span class="n">SAObjUp</span><span class="p">)</span>
        <span class="n">variables_data</span><span class="p">[</span><span class="s1">&#39;Allowable Decrease (Obj Coeff)&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">v</span><span class="o">.</span><span class="n">SAObjLow</span><span class="p">)</span>
    
    <span class="n">variables_df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">variables_data</span><span class="p">)</span>
    
    <span class="c1"># Collecting sensitivity analysis for constraints</span>
    <span class="n">constraints_data</span> <span class="o">=</span> <span class="p">{</span>
        <span class="s1">&#39;Constraint&#39;</span><span class="p">:</span> <span class="p">[],</span>
        <span class="s1">&#39;Shadow Price&#39;</span><span class="p">:</span> <span class="p">[],</span>
        <span class="s1">&#39;Allowable Increase (RHS)&#39;</span><span class="p">:</span> <span class="p">[],</span>
        <span class="s1">&#39;Allowable Decrease (RHS)&#39;</span><span class="p">:</span> <span class="p">[]</span>
    <span class="p">}</span>
    <span class="k">for</span> <span class="n">c</span> <span class="ow">in</span> <span class="n">model</span><span class="o">.</span><span class="n">getConstrs</span><span class="p">():</span>
        <span class="n">constraints_data</span><span class="p">[</span><span class="s1">&#39;Constraint&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">c</span><span class="o">.</span><span class="n">ConstrName</span><span class="p">)</span>
        <span class="n">constraints_data</span><span class="p">[</span><span class="s1">&#39;Shadow Price&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">c</span><span class="o">.</span><span class="n">Pi</span><span class="p">)</span>
        <span class="n">constraints_data</span><span class="p">[</span><span class="s1">&#39;Allowable Increase (RHS)&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">c</span><span class="o">.</span><span class="n">SARHSUp</span><span class="p">)</span>
        <span class="n">constraints_data</span><span class="p">[</span><span class="s1">&#39;Allowable Decrease (RHS)&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">c</span><span class="o">.</span><span class="n">SARHSLow</span><span class="p">)</span>
    
    <span class="n">constraints_df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">constraints_data</span><span class="p">)</span>
 
    <span class="c1"># Return both DataFrames separately</span>
    <span class="k">return</span>  <span class="n">variables_df</span><span class="p">,</span> <span class="n">constraints_df</span>
</pre></div>

     </div>
</div>
</div>
</div>

</div><div class="jp-Cell jp-CodeCell jp-Notebook-cell jp-mod-noOutputs">
<div class="jp-Cell-inputWrapper">
<div class="jp-Collapser jp-InputCollapser jp-Cell-inputCollapser">
</div>
<div class="jp-InputArea jp-Cell-inputArea">
<div class="jp-InputPrompt jp-InputArea-prompt">In&#160;[9]:</div>
<div class="jp-CodeMirrorEditor jp-Editor jp-InputArea-editor">
     <div class="CodeMirror cm-s-jupyter">
<div class="highlight hl-ipython3"><pre><span></span><span class="c1"># Adapative function for LP model</span>
<span class="k">def</span> <span class="nf">AOS</span><span class="p">(</span><span class="n">display</span><span class="p">:</span><span class="nb">bool</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">price</span><span class="p">:</span><span class="nb">tuple</span><span class="o">=</span><span class="p">(</span><span class="mi">175</span><span class="p">,</span><span class="mi">200</span><span class="p">),</span> <span class="n">cost</span><span class="p">:</span><span class="nb">tuple</span><span class="o">=</span><span class="p">(</span><span class="mi">100</span><span class="p">,</span><span class="mi">110</span><span class="p">),</span> <span class="n">adv_eff</span><span class="p">:</span><span class="nb">float</span><span class="o">=</span><span class="mi">10</span><span class="p">,</span> <span class="n">collect_rate</span><span class="p">:</span><span class="nb">dict</span><span class="o">=</span><span class="n">coll_rate</span><span class="p">,</span> <span class="n">rate_loan</span><span class="p">:</span><span class="nb">float</span><span class="o">=</span><span class="mf">0.15</span><span class="p">,</span> <span class="n">inv_cushion</span><span class="p">:</span><span class="nb">float</span><span class="o">=</span><span class="mf">0.1</span><span class="p">,</span> <span class="n">prodCap_Q4</span><span class="p">:</span><span class="nb">float</span><span class="o">=</span><span class="mf">0.1</span><span class="p">,</span> <span class="n">creditLine</span><span class="p">:</span><span class="nb">int</span><span class="o">=</span><span class="mi">750000</span><span class="p">,</span><span class="n">demand_ibm</span><span class="o">=</span><span class="n">demand_ibm</span><span class="p">,</span> <span class="n">demand_mac</span><span class="o">=</span><span class="n">demand_mac</span><span class="p">):</span>
    <span class="n">FixedCost</span> <span class="o">=</span> <span class="mi">150000</span>
    <span class="c1"># price</span>
    <span class="n">price_ibm</span> <span class="o">=</span> <span class="n">price</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
    <span class="n">price_mac</span> <span class="o">=</span> <span class="n">price</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>
    
    <span class="c1"># cost</span>
    <span class="n">cost_ibm</span> <span class="o">=</span> <span class="n">cost</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
    <span class="n">cost_mac</span> <span class="o">=</span> <span class="n">cost</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>
    
    <span class="c1"># collectible rate</span>
    
    <span class="n">coll_ibm</span> <span class="o">=</span> <span class="n">collect_rate</span><span class="p">[</span><span class="s1">&#39;ibm&#39;</span><span class="p">]</span>
    <span class="n">coll_mac</span> <span class="o">=</span> <span class="n">collect_rate</span><span class="p">[</span><span class="s1">&#39;mac&#39;</span><span class="p">]</span>
    
    <span class="c1"># create model</span>
    <span class="n">m</span> <span class="o">=</span> <span class="n">gp</span><span class="o">.</span><span class="n">Model</span><span class="p">()</span>

    <span class="c1"># cal credit cost</span>
    <span class="n">CreditCost</span> <span class="o">=</span> <span class="n">creditLine</span><span class="o">*</span><span class="n">rate_loan</span><span class="o">/</span><span class="mi">4</span>

    <span class="c1"># decision variables</span>
    <span class="n">Adv</span> <span class="o">=</span> <span class="n">m</span><span class="o">.</span><span class="n">addVars</span><span class="p">(</span><span class="mi">7</span><span class="p">,</span> <span class="n">lb</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">name</span><span class="o">=</span><span class="p">[</span><span class="n">i</span><span class="o">+</span><span class="s1">&#39; Adv&#39;</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">id_lbl</span><span class="p">])</span>
    <span class="n">AdvIbm</span> <span class="o">=</span> <span class="n">m</span><span class="o">.</span><span class="n">addVars</span><span class="p">(</span><span class="mi">7</span><span class="p">,</span> <span class="n">lb</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">name</span><span class="o">=</span><span class="p">[</span><span class="n">i</span><span class="o">+</span><span class="s1">&#39; AdvIbm&#39;</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">id_lbl</span><span class="p">])</span>
    <span class="n">AdvMac</span> <span class="o">=</span> <span class="n">m</span><span class="o">.</span><span class="n">addVars</span><span class="p">(</span><span class="mi">7</span><span class="p">,</span> <span class="n">lb</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">name</span><span class="o">=</span><span class="p">[</span><span class="n">i</span><span class="o">+</span><span class="s1">&#39; AdvMac&#39;</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">id_lbl</span><span class="p">])</span>
    <span class="n">Ibm</span> <span class="o">=</span> <span class="n">m</span><span class="o">.</span><span class="n">addVars</span><span class="p">(</span><span class="mi">7</span><span class="p">,</span> <span class="n">lb</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span><span class="n">name</span><span class="o">=</span><span class="p">[</span><span class="n">i</span><span class="o">+</span><span class="s1">&#39; Ibm&#39;</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">id_lbl</span><span class="p">])</span>
    <span class="n">Mac</span> <span class="o">=</span> <span class="n">m</span><span class="o">.</span><span class="n">addVars</span><span class="p">(</span><span class="mi">7</span><span class="p">,</span> <span class="n">lb</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">name</span><span class="o">=</span><span class="p">[</span><span class="n">i</span><span class="o">+</span><span class="s1">&#39; Mac&#39;</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">id_lbl</span><span class="p">])</span>
    <span class="n">Prod</span> <span class="o">=</span> <span class="n">m</span><span class="o">.</span><span class="n">addVars</span><span class="p">(</span><span class="mi">7</span><span class="p">,</span> <span class="n">lb</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">name</span><span class="o">=</span><span class="p">[</span><span class="n">i</span><span class="o">+</span><span class="s1">&#39; Prod&#39;</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">id_lbl</span><span class="p">])</span>
    <span class="n">Sibm</span> <span class="o">=</span> <span class="n">m</span><span class="o">.</span><span class="n">addVars</span><span class="p">(</span><span class="mi">7</span><span class="p">,</span> <span class="n">lb</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">name</span><span class="o">=</span><span class="p">[</span><span class="n">i</span><span class="o">+</span><span class="s1">&#39; Sibm&#39;</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">id_lbl</span><span class="p">])</span>
    <span class="n">Smac</span> <span class="o">=</span> <span class="n">m</span><span class="o">.</span><span class="n">addVars</span><span class="p">(</span><span class="mi">7</span><span class="p">,</span> <span class="n">lb</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">name</span><span class="o">=</span><span class="p">[</span><span class="n">i</span><span class="o">+</span><span class="s1">&#39; Smac&#39;</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">id_lbl</span><span class="p">])</span>
    <span class="n">InvIbm</span> <span class="o">=</span> <span class="n">m</span><span class="o">.</span><span class="n">addVars</span><span class="p">(</span><span class="mi">7</span><span class="p">,</span> <span class="n">lb</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">name</span><span class="o">=</span><span class="p">[</span><span class="n">i</span><span class="o">+</span><span class="s1">&#39; InvIbm&#39;</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">id_lbl</span><span class="p">])</span>
    <span class="n">InvMac</span> <span class="o">=</span> <span class="n">m</span><span class="o">.</span><span class="n">addVars</span><span class="p">(</span><span class="mi">7</span><span class="p">,</span> <span class="n">lb</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">name</span><span class="o">=</span><span class="p">[</span><span class="n">i</span><span class="o">+</span><span class="s1">&#39; InvMac&#39;</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">id_lbl</span><span class="p">])</span>
    <span class="n">Invest</span> <span class="o">=</span> <span class="n">m</span><span class="o">.</span><span class="n">addVars</span><span class="p">(</span><span class="mi">7</span><span class="p">,</span> <span class="n">lb</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">name</span><span class="o">=</span><span class="p">[</span><span class="n">i</span><span class="o">+</span><span class="s1">&#39; Invest&#39;</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">id_lbl</span><span class="p">])</span>
    <span class="n">Rev</span> <span class="o">=</span> <span class="n">m</span><span class="o">.</span><span class="n">addVars</span><span class="p">(</span><span class="mi">7</span><span class="p">,</span> <span class="n">lb</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">name</span><span class="o">=</span><span class="p">[</span><span class="n">i</span><span class="o">+</span><span class="s1">&#39; Rev&#39;</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">id_lbl</span><span class="p">])</span>

    <span class="c1"># constraints</span>

    <span class="c1"># start blank in 1996</span>
    <span class="k">for</span> <span class="n">t</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">3</span><span class="p">):</span>
        <span class="n">m</span><span class="o">.</span><span class="n">addConstr</span><span class="p">(</span><span class="n">AdvIbm</span><span class="p">[</span><span class="n">t</span><span class="p">]</span><span class="o">==</span><span class="mi">0</span><span class="p">)</span>
        <span class="n">m</span><span class="o">.</span><span class="n">addConstr</span><span class="p">(</span><span class="n">AdvMac</span><span class="p">[</span><span class="n">t</span><span class="p">]</span><span class="o">==</span><span class="mi">0</span><span class="p">)</span>
        <span class="n">m</span><span class="o">.</span><span class="n">addConstr</span><span class="p">(</span><span class="n">Adv</span><span class="p">[</span><span class="n">t</span><span class="p">]</span><span class="o">==</span><span class="mi">0</span><span class="p">)</span>
        <span class="n">m</span><span class="o">.</span><span class="n">addConstr</span><span class="p">(</span><span class="n">Ibm</span><span class="p">[</span><span class="n">t</span><span class="p">]</span><span class="o">==</span><span class="mi">0</span><span class="p">)</span>
        <span class="n">m</span><span class="o">.</span><span class="n">addConstr</span><span class="p">(</span><span class="n">Mac</span><span class="p">[</span><span class="n">t</span><span class="p">]</span><span class="o">==</span><span class="mi">0</span><span class="p">)</span>
        <span class="n">m</span><span class="o">.</span><span class="n">addConstr</span><span class="p">(</span><span class="n">Invest</span><span class="p">[</span><span class="n">t</span><span class="p">]</span><span class="o">==</span><span class="mi">0</span><span class="p">)</span>
        <span class="n">m</span><span class="o">.</span><span class="n">addConstr</span><span class="p">(</span><span class="n">Rev</span><span class="p">[</span><span class="n">t</span><span class="p">]</span><span class="o">==</span><span class="mi">0</span><span class="p">)</span>

    <span class="k">for</span> <span class="n">t</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">2</span><span class="p">):</span>
        <span class="n">m</span><span class="o">.</span><span class="n">addConstr</span><span class="p">(</span><span class="n">InvIbm</span><span class="p">[</span><span class="n">t</span><span class="p">]</span><span class="o">==</span><span class="mi">0</span><span class="p">)</span>
        <span class="n">m</span><span class="o">.</span><span class="n">addConstr</span><span class="p">(</span><span class="n">InvMac</span><span class="p">[</span><span class="n">t</span><span class="p">]</span><span class="o">==</span><span class="mi">0</span><span class="p">)</span>

    <span class="c1"># beginning of Q1 1996</span>
    <span class="n">m</span><span class="o">.</span><span class="n">addConstr</span><span class="p">(</span><span class="n">InvIbm</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span><span class="o">==</span><span class="mi">10000</span><span class="p">)</span>
    <span class="n">m</span><span class="o">.</span><span class="n">addConstr</span><span class="p">(</span><span class="n">InvMac</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span><span class="o">==</span><span class="mi">5000</span><span class="p">)</span>

    <span class="c1"># def rev</span>
    <span class="k">for</span> <span class="n">t</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span><span class="mi">7</span><span class="p">):</span>
        <span class="n">m</span><span class="o">.</span><span class="n">addConstr</span><span class="p">(</span><span class="n">Rev</span><span class="p">[</span><span class="n">t</span><span class="p">]</span><span class="o">==</span><span class="n">coll_ibm</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">*</span><span class="n">price_ibm</span><span class="o">*</span><span class="n">Sibm</span><span class="p">[</span><span class="n">t</span><span class="p">]</span><span class="o">+</span><span class="n">coll_mac</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">*</span><span class="n">price_mac</span><span class="o">*</span><span class="n">Smac</span><span class="p">[</span><span class="n">t</span><span class="p">]</span><span class="o">+</span><span class="n">coll_ibm</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">*</span><span class="n">price_ibm</span><span class="o">*</span><span class="p">(</span><span class="n">Sibm</span><span class="p">[</span><span class="n">t</span><span class="o">-</span><span class="mi">1</span><span class="p">])</span><span class="o">+</span><span class="n">coll_mac</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">*</span><span class="n">price_mac</span><span class="o">*</span><span class="p">(</span><span class="n">Smac</span><span class="p">[</span><span class="n">t</span><span class="o">-</span><span class="mi">1</span><span class="p">])</span><span class="o">+</span><span class="n">coll_ibm</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span><span class="o">*</span><span class="n">price_ibm</span><span class="o">*</span><span class="p">(</span><span class="n">Sibm</span><span class="p">[</span><span class="n">t</span><span class="o">-</span><span class="mi">2</span><span class="p">])</span><span class="o">+</span><span class="n">coll_mac</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span><span class="o">*</span><span class="n">price_mac</span><span class="o">*</span><span class="p">(</span><span class="n">Smac</span><span class="p">[</span><span class="n">t</span><span class="o">-</span><span class="mi">2</span><span class="p">])</span><span class="o">+</span><span class="n">coll_ibm</span><span class="p">[</span><span class="mi">3</span><span class="p">]</span><span class="o">*</span><span class="mf">0.5</span><span class="o">*</span><span class="n">price_ibm</span><span class="o">*</span><span class="p">(</span><span class="n">Sibm</span><span class="p">[</span><span class="n">t</span><span class="o">-</span><span class="mi">3</span><span class="p">])</span><span class="o">+</span><span class="n">coll_mac</span><span class="p">[</span><span class="mi">3</span><span class="p">]</span><span class="o">*</span><span class="mf">0.5</span><span class="o">*</span><span class="n">price_mac</span><span class="o">*</span><span class="p">(</span><span class="n">Smac</span><span class="p">[</span><span class="n">t</span><span class="o">-</span><span class="mi">3</span><span class="p">]))</span>

    <span class="c1"># def inventory </span>
    <span class="k">for</span> <span class="n">t</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span><span class="mi">7</span><span class="p">):</span>
        <span class="n">m</span><span class="o">.</span><span class="n">addConstr</span><span class="p">(</span><span class="n">InvIbm</span><span class="p">[</span><span class="n">t</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span><span class="o">+</span><span class="n">Ibm</span><span class="p">[</span><span class="n">t</span><span class="p">]</span><span class="o">-</span><span class="n">Sibm</span><span class="p">[</span><span class="n">t</span><span class="p">]</span><span class="o">==</span><span class="n">InvIbm</span><span class="p">[</span><span class="n">t</span><span class="p">],</span> <span class="n">name</span><span class="o">=</span><span class="s1">&#39;inv_IBM &#39;</span><span class="o">+</span><span class="n">id_lbl</span><span class="p">[</span><span class="n">t</span><span class="p">])</span>
        <span class="n">m</span><span class="o">.</span><span class="n">addConstr</span><span class="p">(</span><span class="n">InvMac</span><span class="p">[</span><span class="n">t</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span><span class="o">+</span><span class="n">Mac</span><span class="p">[</span><span class="n">t</span><span class="p">]</span><span class="o">-</span><span class="n">Smac</span><span class="p">[</span><span class="n">t</span><span class="p">]</span><span class="o">==</span><span class="n">InvMac</span><span class="p">[</span><span class="n">t</span><span class="p">],</span> <span class="n">name</span><span class="o">=</span><span class="s1">&#39;inv_Mac &#39;</span><span class="o">+</span><span class="n">id_lbl</span><span class="p">[</span><span class="n">t</span><span class="p">])</span>

    <span class="c1"># sales</span>
    <span class="c1"># actual sales in 1995</span>
    <span class="k">for</span> <span class="n">t</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">3</span><span class="p">):</span>
        <span class="n">m</span><span class="o">.</span><span class="n">addConstr</span><span class="p">(</span><span class="n">Sibm</span><span class="p">[</span><span class="n">t</span><span class="p">]</span><span class="o">==</span><span class="n">demand_ibm</span><span class="p">[</span><span class="n">t</span><span class="p">])</span> 
        <span class="n">m</span><span class="o">.</span><span class="n">addConstr</span><span class="p">(</span><span class="n">Smac</span><span class="p">[</span><span class="n">t</span><span class="p">]</span><span class="o">==</span><span class="n">demand_mac</span><span class="p">[</span><span class="n">t</span><span class="p">])</span>
    
    <span class="c1"># def adv</span>
    <span class="k">for</span> <span class="n">t</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span><span class="mi">7</span><span class="p">):</span>
        <span class="n">m</span><span class="o">.</span><span class="n">addConstr</span><span class="p">(</span><span class="n">AdvIbm</span><span class="p">[</span><span class="n">t</span><span class="p">]</span><span class="o">+</span><span class="n">AdvMac</span><span class="p">[</span><span class="n">t</span><span class="p">]</span><span class="o">==</span><span class="n">Adv</span><span class="p">[</span><span class="n">t</span><span class="p">])</span>
    
    <span class="c1"># sales &lt;= E[demand]+Adv effect</span>
    <span class="k">for</span> <span class="n">t</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span><span class="mi">7</span><span class="p">):</span>
        <span class="n">m</span><span class="o">.</span><span class="n">addConstr</span><span class="p">(</span><span class="n">Sibm</span><span class="p">[</span><span class="n">t</span><span class="p">]</span><span class="o">&lt;=</span><span class="n">demand_ibm</span><span class="p">[</span><span class="n">t</span><span class="p">]</span><span class="o">+</span><span class="p">(</span><span class="n">AdvIbm</span><span class="p">[</span><span class="n">t</span><span class="p">]</span><span class="o">/</span><span class="n">adv_eff</span><span class="p">),</span> <span class="n">name</span><span class="o">=</span><span class="s1">&#39;demand_IBM &#39;</span><span class="o">+</span><span class="n">id_lbl</span><span class="p">[</span><span class="n">t</span><span class="p">])</span>
        <span class="n">m</span><span class="o">.</span><span class="n">addConstr</span><span class="p">(</span><span class="n">Smac</span><span class="p">[</span><span class="n">t</span><span class="p">]</span><span class="o">&lt;=</span><span class="n">demand_mac</span><span class="p">[</span><span class="n">t</span><span class="p">]</span><span class="o">+</span><span class="p">(</span><span class="n">AdvMac</span><span class="p">[</span><span class="n">t</span><span class="p">]</span><span class="o">/</span><span class="n">adv_eff</span><span class="p">),</span> <span class="n">name</span><span class="o">=</span><span class="s1">&#39;demand_Mac &#39;</span><span class="o">+</span><span class="n">id_lbl</span><span class="p">[</span><span class="n">t</span><span class="p">])</span>

    <span class="c1"># sales &lt;= Inventory in stock</span>
    <span class="k">for</span> <span class="n">t</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span><span class="mi">7</span><span class="p">):</span>
        <span class="n">m</span><span class="o">.</span><span class="n">addConstr</span><span class="p">(</span><span class="n">Sibm</span><span class="p">[</span><span class="n">t</span><span class="p">]</span><span class="o">&lt;=</span><span class="n">InvIbm</span><span class="p">[</span><span class="n">t</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span><span class="o">+</span><span class="n">Ibm</span><span class="p">[</span><span class="n">t</span><span class="p">],</span> <span class="n">name</span><span class="o">=</span><span class="s1">&#39;stock_IBM &#39;</span><span class="o">+</span><span class="n">id_lbl</span><span class="p">[</span><span class="n">t</span><span class="p">])</span>
        <span class="n">m</span><span class="o">.</span><span class="n">addConstr</span><span class="p">(</span><span class="n">Smac</span><span class="p">[</span><span class="n">t</span><span class="p">]</span><span class="o">&lt;=</span><span class="n">InvMac</span><span class="p">[</span><span class="n">t</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span><span class="o">+</span><span class="n">Mac</span><span class="p">[</span><span class="n">t</span><span class="p">],</span> <span class="n">name</span><span class="o">=</span><span class="s1">&#39;stock_Mac &#39;</span><span class="o">+</span><span class="n">id_lbl</span><span class="p">[</span><span class="n">t</span><span class="p">])</span>

    <span class="c1"># def production cost</span>
    <span class="k">for</span> <span class="n">t</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">7</span><span class="p">):</span>
        <span class="n">m</span><span class="o">.</span><span class="n">addConstr</span><span class="p">(</span><span class="n">cost_ibm</span><span class="o">*</span><span class="n">Ibm</span><span class="p">[</span><span class="n">t</span><span class="p">]</span><span class="o">+</span><span class="n">cost_mac</span><span class="o">*</span><span class="n">Mac</span><span class="p">[</span><span class="n">t</span><span class="p">]</span><span class="o">==</span><span class="n">Prod</span><span class="p">[</span><span class="n">t</span><span class="p">])</span>

    <span class="c1"># def cashflow</span>
    <span class="c1"># inital credit 750000</span>
    <span class="c1"># excess funds in quarter 1</span>
    <span class="n">m</span><span class="o">.</span><span class="n">addConstr</span><span class="p">(</span><span class="n">Invest</span><span class="p">[</span><span class="mi">3</span><span class="p">]</span><span class="o">+</span><span class="n">Prod</span><span class="p">[</span><span class="mi">3</span><span class="p">]</span><span class="o">+</span><span class="n">Adv</span><span class="p">[</span><span class="mi">3</span><span class="p">]</span><span class="o">+</span><span class="n">CreditCost</span><span class="o">+</span><span class="n">FixedCost</span><span class="o">+</span><span class="mf">0.01</span><span class="o">*</span><span class="p">(</span><span class="n">cost_ibm</span><span class="o">*</span><span class="n">InvIbm</span><span class="p">[</span><span class="mi">3</span><span class="p">]</span><span class="o">+</span><span class="n">cost_mac</span><span class="o">*</span><span class="n">InvMac</span><span class="p">[</span><span class="mi">3</span><span class="p">])</span><span class="o">==</span><span class="n">creditLine</span><span class="o">+</span><span class="n">Rev</span><span class="p">[</span><span class="mi">3</span><span class="p">],</span> <span class="n">name</span><span class="o">=</span><span class="s1">&#39;Invest &#39;</span><span class="o">+</span><span class="n">id_lbl</span><span class="p">[</span><span class="mi">3</span><span class="p">])</span>
    <span class="c1"># excess funds in quarter 2-4</span>
    <span class="k">for</span> <span class="n">t</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">4</span><span class="p">,</span><span class="mi">7</span><span class="p">):</span>
        <span class="n">m</span><span class="o">.</span><span class="n">addConstr</span><span class="p">(</span><span class="n">Invest</span><span class="p">[</span><span class="n">t</span><span class="p">]</span><span class="o">+</span><span class="n">Prod</span><span class="p">[</span><span class="n">t</span><span class="p">]</span><span class="o">+</span><span class="n">Adv</span><span class="p">[</span><span class="n">t</span><span class="p">]</span><span class="o">+</span><span class="n">CreditCost</span><span class="o">+</span><span class="n">FixedCost</span><span class="o">+</span><span class="mf">0.01</span><span class="o">*</span><span class="p">(</span><span class="n">cost_ibm</span><span class="o">*</span><span class="n">InvIbm</span><span class="p">[</span><span class="n">t</span><span class="p">]</span><span class="o">+</span><span class="n">cost_mac</span><span class="o">*</span><span class="n">InvMac</span><span class="p">[</span><span class="n">t</span><span class="p">])</span><span class="o">==</span><span class="p">(</span><span class="mi">1</span><span class="o">+</span><span class="mf">0.06</span><span class="o">/</span><span class="mi">4</span><span class="p">)</span><span class="o">*</span><span class="n">Invest</span><span class="p">[</span><span class="n">t</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span><span class="o">+</span><span class="n">Rev</span><span class="p">[</span><span class="n">t</span><span class="p">],</span> <span class="n">name</span><span class="o">=</span><span class="s1">&#39;Invest &#39;</span><span class="o">+</span><span class="n">id_lbl</span><span class="p">[</span><span class="n">t</span><span class="p">])</span>


    <span class="c1"># production</span>
    <span class="c1"># t&lt;4</span>
    <span class="k">for</span> <span class="n">t</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span><span class="mi">6</span><span class="p">):</span>
        <span class="n">m</span><span class="o">.</span><span class="n">addConstr</span><span class="p">(</span><span class="n">Ibm</span><span class="p">[</span><span class="n">t</span><span class="p">]</span><span class="o">+</span><span class="n">InvIbm</span><span class="p">[</span><span class="n">t</span><span class="p">]</span><span class="o">&gt;=</span><span class="p">(</span><span class="mi">1</span><span class="o">+</span><span class="n">inv_cushion</span><span class="p">)</span><span class="o">*</span><span class="n">demand_ibm</span><span class="p">[</span><span class="n">t</span><span class="o">+</span><span class="mi">1</span><span class="p">],</span> <span class="n">name</span><span class="o">=</span><span class="s1">&#39;prod_IBM &#39;</span><span class="o">+</span><span class="n">id_lbl</span><span class="p">[</span><span class="n">t</span><span class="p">])</span>
        <span class="n">m</span><span class="o">.</span><span class="n">addConstr</span><span class="p">(</span><span class="n">Mac</span><span class="p">[</span><span class="n">t</span><span class="p">]</span><span class="o">+</span><span class="n">InvMac</span><span class="p">[</span><span class="n">t</span><span class="p">]</span><span class="o">&gt;=</span><span class="p">(</span><span class="mi">1</span><span class="o">+</span><span class="n">inv_cushion</span><span class="p">)</span><span class="o">*</span><span class="n">demand_mac</span><span class="p">[</span><span class="n">t</span><span class="o">+</span><span class="mi">1</span><span class="p">],</span> <span class="n">name</span><span class="o">=</span><span class="s1">&#39;prod_Mac &#39;</span><span class="o">+</span><span class="n">id_lbl</span><span class="p">[</span><span class="n">t</span><span class="p">])</span>

    <span class="k">for</span> <span class="n">t</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span><span class="mi">6</span><span class="p">):</span>
        <span class="n">m</span><span class="o">.</span><span class="n">addConstr</span><span class="p">(</span><span class="n">Ibm</span><span class="p">[</span><span class="n">t</span><span class="p">]</span><span class="o">&lt;=</span><span class="mi">30</span><span class="o">*</span><span class="mi">12</span><span class="o">*</span><span class="mi">20</span><span class="o">*</span><span class="mi">3</span><span class="p">,</span> <span class="n">name</span><span class="o">=</span><span class="s1">&#39;capacity_IBM &#39;</span><span class="o">+</span><span class="n">id_lbl</span><span class="p">[</span><span class="n">t</span><span class="p">])</span>
        <span class="n">m</span><span class="o">.</span><span class="n">addConstr</span><span class="p">(</span><span class="n">Mac</span><span class="p">[</span><span class="n">t</span><span class="p">]</span><span class="o">&lt;=</span><span class="mi">10</span><span class="o">*</span><span class="mi">12</span><span class="o">*</span><span class="mi">20</span><span class="o">*</span><span class="mi">3</span><span class="p">,</span> <span class="n">name</span><span class="o">=</span><span class="s1">&#39;capacity_Mac &#39;</span><span class="o">+</span><span class="n">id_lbl</span><span class="p">[</span><span class="n">t</span><span class="p">])</span>

    <span class="c1"># t=4</span>
    <span class="n">m</span><span class="o">.</span><span class="n">addConstr</span><span class="p">(</span><span class="n">Ibm</span><span class="p">[</span><span class="mi">6</span><span class="p">]</span><span class="o">+</span><span class="n">InvIbm</span><span class="p">[</span><span class="mi">6</span><span class="p">]</span><span class="o">&gt;=</span><span class="mi">2</span><span class="o">*</span><span class="n">demand_ibm</span><span class="p">[</span><span class="mi">6</span><span class="p">],</span> <span class="n">name</span><span class="o">=</span><span class="s1">&#39;prod_IBM &#39;</span><span class="o">+</span><span class="n">id_lbl</span><span class="p">[</span><span class="mi">6</span><span class="p">])</span>
    <span class="n">m</span><span class="o">.</span><span class="n">addConstr</span><span class="p">(</span><span class="n">Mac</span><span class="p">[</span><span class="mi">6</span><span class="p">]</span><span class="o">+</span><span class="n">InvMac</span><span class="p">[</span><span class="mi">6</span><span class="p">]</span><span class="o">&gt;=</span><span class="mi">2</span><span class="o">*</span><span class="n">demand_mac</span><span class="p">[</span><span class="mi">6</span><span class="p">],</span> <span class="n">name</span><span class="o">=</span><span class="s1">&#39;prod_Mac &#39;</span><span class="o">+</span><span class="n">id_lbl</span><span class="p">[</span><span class="mi">6</span><span class="p">])</span>

    <span class="n">m</span><span class="o">.</span><span class="n">addConstr</span><span class="p">(</span><span class="n">Ibm</span><span class="p">[</span><span class="mi">6</span><span class="p">]</span><span class="o">&lt;=</span><span class="p">(</span><span class="mi">1</span><span class="o">+</span><span class="n">prodCap_Q4</span><span class="p">)</span><span class="o">*</span><span class="mi">30</span><span class="o">*</span><span class="mi">12</span><span class="o">*</span><span class="mi">20</span><span class="o">*</span><span class="mi">3</span><span class="p">,</span> <span class="n">name</span><span class="o">=</span><span class="s1">&#39;capacity_IBM &#39;</span><span class="o">+</span><span class="n">id_lbl</span><span class="p">[</span><span class="mi">6</span><span class="p">])</span>
    <span class="n">m</span><span class="o">.</span><span class="n">addConstr</span><span class="p">(</span><span class="n">Mac</span><span class="p">[</span><span class="mi">6</span><span class="p">]</span><span class="o">&lt;=</span><span class="p">(</span><span class="mi">1</span><span class="o">+</span><span class="n">prodCap_Q4</span><span class="p">)</span><span class="o">*</span><span class="mi">10</span><span class="o">*</span><span class="mi">12</span><span class="o">*</span><span class="mi">20</span><span class="o">*</span><span class="mi">3</span><span class="p">,</span> <span class="n">name</span><span class="o">=</span><span class="s1">&#39;capacity_Mac &#39;</span><span class="o">+</span><span class="n">id_lbl</span><span class="p">[</span><span class="mi">6</span><span class="p">])</span>

    <span class="c1"># objective function: max(profit)</span>
    <span class="n">m</span><span class="o">.</span><span class="n">setObjective</span><span class="p">(</span><span class="n">gp</span><span class="o">.</span><span class="n">quicksum</span><span class="p">((</span><span class="mf">0.06</span><span class="o">/</span><span class="mi">4</span><span class="p">)</span><span class="o">*</span><span class="n">Invest</span><span class="p">[</span><span class="n">t</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span><span class="o">+</span><span class="n">Rev</span><span class="p">[</span><span class="n">t</span><span class="p">]</span><span class="o">-</span><span class="n">Adv</span><span class="p">[</span><span class="n">t</span><span class="p">]</span><span class="o">-</span><span class="n">Prod</span><span class="p">[</span><span class="n">t</span><span class="p">]</span><span class="o">-</span><span class="mf">0.01</span><span class="o">*</span><span class="p">(</span><span class="n">cost_ibm</span><span class="o">*</span><span class="n">InvIbm</span><span class="p">[</span><span class="n">t</span><span class="p">]</span><span class="o">+</span><span class="n">cost_mac</span><span class="o">*</span><span class="n">InvMac</span><span class="p">[</span><span class="n">t</span><span class="p">])</span><span class="o">-</span><span class="n">CreditCost</span><span class="o">-</span><span class="n">FixedCost</span>  <span class="k">for</span> <span class="n">t</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span><span class="mi">7</span><span class="p">)),</span> <span class="n">GRB</span><span class="o">.</span><span class="n">MAXIMIZE</span><span class="p">)</span>

    <span class="n">status</span> <span class="o">=</span> <span class="n">m</span><span class="o">.</span><span class="n">optimize</span><span class="p">()</span>
    
    <span class="nb">print</span><span class="p">()</span>
    <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Optimal Values for Decision Variables:&#39;</span><span class="p">)</span>
    <span class="n">adv</span> <span class="o">=</span> <span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">*</span> <span class="mi">7</span>
    <span class="n">advibm</span> <span class="o">=</span> <span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">*</span> <span class="mi">7</span>
    <span class="n">advmac</span> <span class="o">=</span> <span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">*</span> <span class="mi">7</span>
    <span class="n">ibm</span> <span class="o">=</span> <span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">*</span> <span class="mi">7</span>
    <span class="n">mac</span> <span class="o">=</span> <span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">*</span> <span class="mi">7</span>
    <span class="n">prod</span> <span class="o">=</span> <span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">*</span> <span class="mi">7</span>
    <span class="n">sibm</span> <span class="o">=</span> <span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">*</span> <span class="mi">7</span>
    <span class="n">smac</span> <span class="o">=</span> <span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">*</span> <span class="mi">7</span>
    <span class="n">invibm</span> <span class="o">=</span> <span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">*</span> <span class="mi">7</span>
    <span class="n">invmac</span> <span class="o">=</span> <span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">*</span> <span class="mi">7</span>
    <span class="n">invest</span> <span class="o">=</span> <span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">*</span> <span class="mi">7</span>
    <span class="n">rev</span> <span class="o">=</span> <span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">*</span> <span class="mi">7</span>

    <span class="k">for</span> <span class="n">t</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">7</span><span class="p">):</span>
        <span class="n">adv</span><span class="p">[</span><span class="n">t</span><span class="p">]</span><span class="o">=</span><span class="n">Adv</span><span class="p">[</span><span class="n">t</span><span class="p">]</span><span class="o">.</span><span class="n">x</span>  
        <span class="n">advibm</span><span class="p">[</span><span class="n">t</span><span class="p">]</span><span class="o">=</span><span class="n">AdvIbm</span><span class="p">[</span><span class="n">t</span><span class="p">]</span><span class="o">.</span><span class="n">x</span>
        <span class="n">advmac</span><span class="p">[</span><span class="n">t</span><span class="p">]</span><span class="o">=</span><span class="n">AdvMac</span><span class="p">[</span><span class="n">t</span><span class="p">]</span><span class="o">.</span><span class="n">x</span>
        <span class="n">ibm</span><span class="p">[</span><span class="n">t</span><span class="p">]</span><span class="o">=</span><span class="n">Ibm</span><span class="p">[</span><span class="n">t</span><span class="p">]</span><span class="o">.</span><span class="n">x</span>
        <span class="n">mac</span><span class="p">[</span><span class="n">t</span><span class="p">]</span><span class="o">=</span><span class="n">Mac</span><span class="p">[</span><span class="n">t</span><span class="p">]</span><span class="o">.</span><span class="n">x</span>
        <span class="n">prod</span><span class="p">[</span><span class="n">t</span><span class="p">]</span><span class="o">=</span><span class="n">Prod</span><span class="p">[</span><span class="n">t</span><span class="p">]</span><span class="o">.</span><span class="n">x</span>
        <span class="n">sibm</span><span class="p">[</span><span class="n">t</span><span class="p">]</span><span class="o">=</span><span class="n">Sibm</span><span class="p">[</span><span class="n">t</span><span class="p">]</span><span class="o">.</span><span class="n">x</span>
        <span class="n">smac</span><span class="p">[</span><span class="n">t</span><span class="p">]</span><span class="o">=</span><span class="n">Smac</span><span class="p">[</span><span class="n">t</span><span class="p">]</span><span class="o">.</span><span class="n">x</span>
        <span class="n">invibm</span><span class="p">[</span><span class="n">t</span><span class="p">]</span><span class="o">=</span><span class="n">InvIbm</span><span class="p">[</span><span class="n">t</span><span class="p">]</span><span class="o">.</span><span class="n">x</span>
        <span class="n">invmac</span><span class="p">[</span><span class="n">t</span><span class="p">]</span><span class="o">=</span><span class="n">InvMac</span><span class="p">[</span><span class="n">t</span><span class="p">]</span><span class="o">.</span><span class="n">x</span>
        <span class="n">invest</span><span class="p">[</span><span class="n">t</span><span class="p">]</span><span class="o">=</span><span class="n">Invest</span><span class="p">[</span><span class="n">t</span><span class="p">]</span><span class="o">.</span><span class="n">x</span>
        <span class="n">rev</span><span class="p">[</span><span class="n">t</span><span class="p">]</span><span class="o">=</span><span class="n">Rev</span><span class="p">[</span><span class="n">t</span><span class="p">]</span><span class="o">.</span><span class="n">x</span>
        
    <span class="n">var_dict</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;ADV&#39;</span><span class="p">:</span><span class="n">adv</span><span class="p">,</span>
                <span class="s1">&#39;ADV_IBM&#39;</span><span class="p">:</span><span class="n">advibm</span><span class="p">,</span>
                <span class="s1">&#39;ADV_MAC&#39;</span><span class="p">:</span><span class="n">advmac</span><span class="p">,</span>
                <span class="s1">&#39;IBM&#39;</span><span class="p">:</span><span class="n">ibm</span><span class="p">,</span>
                <span class="s1">&#39;MAC&#39;</span><span class="p">:</span><span class="n">mac</span><span class="p">,</span>
                <span class="s1">&#39;PROD&#39;</span><span class="p">:</span><span class="n">prod</span><span class="p">,</span>
                <span class="s1">&#39;SIBM&#39;</span><span class="p">:</span><span class="n">sibm</span><span class="p">,</span>
                <span class="s1">&#39;SMAC&#39;</span><span class="p">:</span><span class="n">smac</span><span class="p">,</span>
                <span class="s1">&#39;INVIBM&#39;</span><span class="p">:</span><span class="n">invibm</span><span class="p">,</span>
                <span class="s1">&#39;INVMAC&#39;</span><span class="p">:</span><span class="n">invmac</span><span class="p">,</span>
                <span class="s1">&#39;INVEST&#39;</span><span class="p">:</span><span class="n">invest</span><span class="p">,</span>
                <span class="s1">&#39;REV&#39;</span><span class="p">:</span><span class="n">rev</span><span class="p">}</span>
    
    <span class="k">if</span> <span class="n">display</span><span class="o">==</span><span class="kc">True</span><span class="p">:</span>
        <span class="n">i</span><span class="o">=</span><span class="mi">1</span>
        <span class="k">for</span> <span class="n">v</span> <span class="ow">in</span> <span class="n">m</span><span class="o">.</span><span class="n">getVars</span><span class="p">():</span> 
            <span class="k">if</span> <span class="n">i</span> <span class="o">&lt;</span> <span class="mi">7</span><span class="p">:</span>
                <span class="n">i</span><span class="o">+=</span><span class="mi">1</span>
                <span class="k">if</span> <span class="n">v</span><span class="o">.</span><span class="n">varName</span><span class="p">[</span><span class="mi">0</span><span class="p">:</span><span class="mi">4</span><span class="p">]</span><span class="o">!=</span><span class="s1">&#39;1995&#39;</span> <span class="ow">or</span> <span class="n">v</span><span class="o">.</span><span class="n">varName</span><span class="p">[</span><span class="mi">0</span><span class="p">:</span><span class="mi">7</span><span class="p">]</span><span class="o">==</span><span class="s1">&#39;1995 Q4&#39;</span><span class="p">:</span>
                    <span class="k">if</span> <span class="n">v</span><span class="o">.</span><span class="n">varName</span><span class="p">[</span><span class="mi">8</span><span class="p">:]</span> <span class="ow">in</span> <span class="p">[</span><span class="s1">&#39;Ibm&#39;</span><span class="p">,</span><span class="s1">&#39;Mac&#39;</span><span class="p">,</span><span class="s1">&#39;Sibm&#39;</span><span class="p">,</span><span class="s1">&#39;Smac&#39;</span><span class="p">,</span><span class="s1">&#39;InvIbm&#39;</span><span class="p">,</span><span class="s1">&#39;InvMac&#39;</span><span class="p">]:</span>
                        <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;%s: %g &#39;</span> <span class="o">%</span><span class="p">(</span><span class="n">v</span><span class="o">.</span><span class="n">varName</span><span class="p">,</span><span class="n">math</span><span class="o">.</span><span class="n">floor</span><span class="p">(</span><span class="n">v</span><span class="o">.</span><span class="n">x</span><span class="p">)),</span> <span class="n">end</span><span class="o">=</span><span class="s1">&#39;| &#39;</span><span class="p">)</span>
                    <span class="k">else</span><span class="p">:</span> 
                        <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;%s: %g &#39;</span> <span class="o">%</span><span class="p">(</span><span class="n">v</span><span class="o">.</span><span class="n">varName</span><span class="p">,</span><span class="n">v</span><span class="o">.</span><span class="n">x</span><span class="p">),</span> <span class="n">end</span><span class="o">=</span><span class="s1">&#39;| &#39;</span><span class="p">)</span>

            <span class="k">else</span><span class="p">:</span>
                <span class="n">i</span><span class="o">=</span><span class="mi">1</span>
                <span class="k">if</span> <span class="n">v</span><span class="o">.</span><span class="n">varName</span><span class="p">[</span><span class="mi">0</span><span class="p">:</span><span class="mi">4</span><span class="p">]</span><span class="o">!=</span><span class="s1">&#39;1995&#39;</span> <span class="ow">or</span> <span class="n">v</span><span class="o">.</span><span class="n">varName</span><span class="p">[</span><span class="mi">0</span><span class="p">:</span><span class="mi">7</span><span class="p">]</span><span class="o">==</span><span class="s1">&#39;1995 Q4&#39;</span><span class="p">:</span>
                    <span class="k">if</span> <span class="n">v</span><span class="o">.</span><span class="n">varName</span><span class="p">[</span><span class="mi">8</span><span class="p">:]</span> <span class="ow">in</span> <span class="p">[</span><span class="s1">&#39;Ibm&#39;</span><span class="p">,</span><span class="s1">&#39;Mac&#39;</span><span class="p">,</span><span class="s1">&#39;Sibm&#39;</span><span class="p">,</span><span class="s1">&#39;Smac&#39;</span><span class="p">,</span><span class="s1">&#39;InvIbm&#39;</span><span class="p">,</span><span class="s1">&#39;InvMac&#39;</span><span class="p">]:</span>
                        <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;%s: %g &#39;</span> <span class="o">%</span><span class="p">(</span><span class="n">v</span><span class="o">.</span><span class="n">varName</span><span class="p">,</span><span class="n">math</span><span class="o">.</span><span class="n">floor</span><span class="p">(</span><span class="n">v</span><span class="o">.</span><span class="n">x</span><span class="p">)))</span>
                    <span class="k">else</span><span class="p">:</span> 
                        <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;%s: %g &#39;</span> <span class="o">%</span><span class="p">(</span><span class="n">v</span><span class="o">.</span><span class="n">varName</span><span class="p">,</span><span class="n">v</span><span class="o">.</span><span class="n">x</span><span class="p">))</span>
                <span class="nb">print</span><span class="p">()</span>
            
    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;The objective value achieved in profit: </span><span class="si">{</span><span class="nb">round</span><span class="p">(</span><span class="n">m</span><span class="o">.</span><span class="n">objVal</span><span class="p">,</span><span class="mi">2</span><span class="p">)</span><span class="si">}</span><span class="s1"> dollars&#39;</span><span class="p">)</span>
    
    <span class="n">variables_df</span><span class="p">,</span> <span class="n">constraints_df</span> <span class="o">=</span> <span class="n">sensitivity_analysis_table</span><span class="p">(</span><span class="n">m</span><span class="p">)</span>
    
    <span class="k">return</span> <span class="n">status</span><span class="p">,</span> <span class="n">variables_df</span><span class="p">,</span> <span class="n">constraints_df</span><span class="p">,</span> <span class="n">var_dict</span>
    
    
</pre></div>

     </div>
</div>
</div>
</div>

</div>
<div class="jp-Cell jp-MarkdownCell jp-Notebook-cell">
<div class="jp-Cell-inputWrapper">
<div class="jp-Collapser jp-InputCollapser jp-Cell-inputCollapser">
</div>
<div class="jp-InputArea jp-Cell-inputArea"><div class="jp-InputPrompt jp-InputArea-prompt">
</div><div class="jp-RenderedHTMLCommon jp-RenderedMarkdown jp-MarkdownOutput">
<h3>c. Optimal Solution<a rel="noopener" class="anchor-link" href="#c.-Optimal-Solution">&#182;</a></h3><p>As displayed in the summary output below, the original solution yields an achieved profit of 9311204.7 dollars. The solution of each of the decision variables is also shown.</p>
<p>The output suggests that the optimal strategy for the company is to fully utilize its production capacity and avoid accumulating excess inventory for the following managerial insights and reasons:</p>
<ol>
<li>Optimize Production Capacity Utilization: Given the option of achieving sales volumes beyond the estimated demand through advertisements, the company should strive to maximize the utilization of its production capacity. Take IBM adapters, one of the company&#39;s product line, as an example. Only taking the variable costs into consideration, the per unit profit of sales beyond the expected demand is 65 (175-100-10). This implies that as long as the advertisement effect remain fixed throughout the year, AOS will gain positive profits from producing and selling items that are not included in the demand predicions. In addition, if taking the quarterly fixed cost into consideration, utilizing all of the production capacities can also help to achieve economies of scales as ATC attenuates with increased productions.</li>
</ol>

</div>
</div>
</div>
</div><div class="jp-Cell jp-CodeCell jp-Notebook-cell">
<div class="jp-Cell-inputWrapper">
<div class="jp-Collapser jp-InputCollapser jp-Cell-inputCollapser">
</div>
<div class="jp-InputArea jp-Cell-inputArea">
<div class="jp-InputPrompt jp-InputArea-prompt">In&#160;[10]:</div>
<div class="jp-CodeMirrorEditor jp-Editor jp-InputArea-editor">
     <div class="CodeMirror cm-s-jupyter">
<div class="highlight hl-ipython3"><pre><span></span><span class="c1"># graph display for reduced ATC as output expands</span>
<span class="n">output_levels</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">101</span><span class="p">)</span>


<span class="n">fixed_costs</span> <span class="o">=</span> <span class="mi">150000</span>  
<span class="n">variable_costs_per_unit</span> <span class="o">=</span> <span class="mi">100</span>  

<span class="c1"># Calculate average total cost (ATC) for each output level</span>
<span class="n">total_costs</span> <span class="o">=</span> <span class="n">fixed_costs</span> <span class="o">+</span> <span class="p">(</span><span class="n">variable_costs_per_unit</span> <span class="o">*</span> <span class="n">output_levels</span><span class="p">)</span>
<span class="n">average_costs</span> <span class="o">=</span> <span class="n">total_costs</span> <span class="o">/</span> <span class="n">output_levels</span>

<span class="c1"># Plot the average total cost (ATC) curve</span>
<span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">7</span><span class="p">,</span> <span class="mi">3</span><span class="p">))</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">output_levels</span><span class="p">,</span> <span class="n">average_costs</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;ATC&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s1">&#39;Average Total Cost (ATC)&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s1">&#39;Output Level&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s1">&#39;Average Total Cost&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">legend</span><span class="p">()</span>
<span class="n">plt</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span><span class="kc">True</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xticks</span><span class="p">([])</span> 
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>

     </div>
</div>
</div>
</div>

<div class="jp-Cell-outputWrapper">
<div class="jp-Collapser jp-OutputCollapser jp-Cell-outputCollapser">
</div>


<div class="jp-OutputArea jp-Cell-outputArea">

<div class="jp-OutputArea-child">

    
    <div class="jp-OutputPrompt jp-OutputArea-prompt"></div>




<div class="jp-RenderedImage jp-OutputArea-output">
<img src="javascript://"/>
</div>

</div>

</div>

</div>

</div>
<div class="jp-Cell jp-MarkdownCell jp-Notebook-cell">
<div class="jp-Cell-inputWrapper">
<div class="jp-Collapser jp-InputCollapser jp-Cell-inputCollapser">
</div>
<div class="jp-InputArea jp-Cell-inputArea"><div class="jp-InputPrompt jp-InputArea-prompt">
</div><div class="jp-RenderedHTMLCommon jp-RenderedMarkdown jp-MarkdownOutput">
<ol>
<li>Dynamic Inventory Management: The presence of zeros in the inventory variables (&quot;InvIbm&quot; &amp;. &quot;InvMac&quot;) indicates a strategic decision influenced by the cost analysis. Specifically, it suggests that the cost associated with selling additional items beyond the demand predictions outweighs the cost of holding those items in stock. Consequently, the optimal strategy for the company is to avoid accumulating excess inventory. Implementing a dynamic inventory management approach becomes crucial. In short, instead of stockpiling inventory, the company should focus on maintaining lean inventory levels to minimize holding costs while ensuring adequate supply by the to the safety cushion to meet demand fluctuations. </li>
</ol>

</div>
</div>
</div>
</div><div class="jp-Cell jp-CodeCell jp-Notebook-cell">
<div class="jp-Cell-inputWrapper">
<div class="jp-Collapser jp-InputCollapser jp-Cell-inputCollapser">
</div>
<div class="jp-InputArea jp-Cell-inputArea">
<div class="jp-InputPrompt jp-InputArea-prompt">In&#160;[11]:</div>
<div class="jp-CodeMirrorEditor jp-Editor jp-InputArea-editor">
     <div class="CodeMirror cm-s-jupyter">
<div class="highlight hl-ipython3"><pre><span></span><span class="c1"># original solution output display</span>
<span class="n">status_or</span><span class="p">,</span> <span class="n">variables_df</span><span class="p">,</span> <span class="n">constraints_df</span><span class="p">,</span> <span class="n">var_dict</span> <span class="o">=</span> <span class="n">AOS</span><span class="p">(</span><span class="n">display</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="n">df_original</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">var_dict</span><span class="p">,</span> <span class="n">index</span> <span class="o">=</span> <span class="n">id_lbl</span><span class="p">)[</span><span class="mi">3</span><span class="p">:]</span>
<span class="c1"># display(variables_df[~variables_df[&#39;Variable&#39;].str.contains(&#39;1995&#39;)])</span>
<span class="c1"># display(constraints_df[constraints_df[&#39;Constraint&#39;].str.contains(&#39;Q&#39;)])</span>
</pre></div>

     </div>
</div>
</div>
</div>

<div class="jp-Cell-outputWrapper">
<div class="jp-Collapser jp-OutputCollapser jp-Cell-outputCollapser">
</div>


<div class="jp-OutputArea jp-Cell-outputArea">

<div class="jp-OutputArea-child">

    
    <div class="jp-OutputPrompt jp-OutputArea-prompt"></div>


<div class="jp-RenderedText jp-OutputArea-output">
<pre>Set parameter Username
Academic license - for non-commercial use only - expires 2025-01-03
Gurobi Optimizer version 11.0.0 build v11.0.0rc2 (win64 - Windows 11+.0 (22631.2))

CPU model: AMD Ryzen 7 6800HS with Radeon Graphics, instruction set [SSE2|AVX|AVX2]
Thread count: 8 physical cores, 16 logical processors, using up to 16 threads

Optimize a model with 92 rows, 84 columns and 225 nonzeros
Model fingerprint: 0xfac5ea50
Coefficient statistics:
  Matrix range     [1e-01, 2e+02]
  Objective range  [1e-02, 1e+00]
  Bounds range     [0e+00, 0e+00]
  RHS range        [1e+03, 6e+05]
Presolve removed 57 rows and 50 columns
Presolve time: 0.00s
Presolved: 35 rows, 34 columns, 131 nonzeros

Iteration    Objective       Primal Inf.    Dual Inf.      Time
       0    3.8400000e+30   5.075000e+29   3.840000e+00      0s
      19    9.3112047e+06   0.000000e+00   0.000000e+00      0s

Solved in 19 iterations and 0.01 seconds (0.00 work units)
Optimal objective  9.311204701e+06

Optimal Values for Decision Variables:
1995 Q4 Adv: 0 | 1996 Q1 Adv: 330000 | 1996 Q2 Adv: 168000 | 1996 Q3 Adv: 156000 | 1996 Q4 Adv: 170400 

1995 Q4 AdvIbm: 0 | 1996 Q1 AdvIbm: 226000 | 1996 Q2 AdvIbm: 116000 | 1996 Q3 AdvIbm: 106000 | 1996 Q4 AdvIbm: 115200 

1995 Q4 AdvMac: 0 | 1996 Q1 AdvMac: 104000 | 1996 Q2 AdvMac: 52000 | 1996 Q3 AdvMac: 50000 | 1996 Q4 AdvMac: 55200 

1995 Q4 Ibm: 0 | 1996 Q1 Ibm: 21600 | 1996 Q2 Ibm: 21600 | 1996 Q3 Ibm: 21600 | 1996 Q4 Ibm: 23760 

1995 Q4 Mac: 0 | 1996 Q1 Mac: 7200 | 1996 Q2 Mac: 7200 | 1996 Q3 Mac: 7200 | 1996 Q4 Mac: 7920 

1995 Q4 Prod: 0 | 1996 Q1 Prod: 2.952e+06 | 1996 Q2 Prod: 2.952e+06 | 1996 Q3 Prod: 2.952e+06 | 1996 Q4 Prod: 3.2472e+06 

1995 Q4 Sibm: 8000 | 1996 Q1 Sibm: 31600 | 1996 Q2 Sibm: 21600 | 1996 Q3 Sibm: 21600 | 1996 Q4 Sibm: 23520 

1995 Q4 Smac: 1600 | 1996 Q1 Smac: 12200 | 1996 Q2 Smac: 7200 | 1996 Q3 Smac: 7200 | 1996 Q4 Smac: 7920 

1995 Q4 InvIbm: 10000 | 1996 Q1 InvIbm: 0 | 1996 Q2 InvIbm: 0 | 1996 Q3 InvIbm: 0 | 1996 Q4 InvIbm: 240 

1995 Q4 InvMac: 5000 | 1996 Q1 InvMac: 0 | 1996 Q2 InvMac: 0 | 1996 Q3 InvMac: 0 | 1996 Q4 InvMac: 0 

1995 Q4 Invest: 0 | 1996 Q1 Invest: 3.77062e+06 | 1996 Q2 Invest: 5.96631e+06 | 1996 Q3 Invest: 7.97938e+06 | 1996 Q4 Invest: 1.00612e+07 

1995 Q4 Rev: 0 | 1996 Q1 Rev: 6.48075e+06 | 1996 Q2 Rev: 5.43725e+06 | 1996 Q3 Rev: 5.2097e+06 | 1996 Q4 Rev: 5.5581e+06 

The objective value achieved in profit: 9311204.7 dollars
</pre>
</div>
</div>

</div>

</div>

</div>
<div class="jp-Cell jp-MarkdownCell jp-Notebook-cell">
<div class="jp-Cell-inputWrapper">
<div class="jp-Collapser jp-InputCollapser jp-Cell-inputCollapser">
</div>
<div class="jp-InputArea jp-Cell-inputArea"><div class="jp-InputPrompt jp-InputArea-prompt">
</div><div class="jp-RenderedHTMLCommon jp-RenderedMarkdown jp-MarkdownOutput">
<h2>IV. Sensitivity Analysis Under Different Assumptions<a rel="noopener" class="anchor-link" href="#IV.-Sensitivity-Analysis-Under-Different-Assumptions">&#182;</a></h2>
</div>
</div>
</div>
</div>
<div class="jp-Cell jp-MarkdownCell jp-Notebook-cell">
<div class="jp-Cell-inputWrapper">
<div class="jp-Collapser jp-InputCollapser jp-Cell-inputCollapser">
</div>
<div class="jp-InputArea jp-Cell-inputArea"><div class="jp-InputPrompt jp-InputArea-prompt">
</div><div class="jp-RenderedHTMLCommon jp-RenderedMarkdown jp-MarkdownOutput">
<h3>a. Variability in Price<a rel="noopener" class="anchor-link" href="#a.-Variability-in-Price">&#182;</a></h3>
</div>
</div>
</div>
</div>
<div class="jp-Cell jp-MarkdownCell jp-Notebook-cell">
<div class="jp-Cell-inputWrapper">
<div class="jp-Collapser jp-InputCollapser jp-Cell-inputCollapser">
</div>
<div class="jp-InputArea jp-Cell-inputArea"><div class="jp-InputPrompt jp-InputArea-prompt">
</div><div class="jp-RenderedHTMLCommon jp-RenderedMarkdown jp-MarkdownOutput">
<p>The original solution for the decision variables is solved based on the expectation that market prices for the adapters remain static at 175 and 200 per unit for the IBM and Mac variants, respectively. However, these initial estimations may be inherently biased and consequently decrease the reliability of the model. Therefore, to gain a more comprehensive acknowledgement of the model&#39;s sensitivity to change, variance is manually added by re-running the model under different pricing scenarios:</p>
<ol>
<li><p>a slight decrease in price to (173,198)</p>
</li>
<li><p>a subsequent decrease to (172,197)</p>
</li>
<li><p>a minor increase to (179,204)</p>
</li>
</ol>
<p>The results, as indicated by the following tables, are compared to the original solution by examining the differences in quarterly fund allocations and production decisions.</p>

</div>
</div>
</div>
</div><div class="jp-Cell jp-CodeCell jp-Notebook-cell">
<div class="jp-Cell-inputWrapper">
<div class="jp-Collapser jp-InputCollapser jp-Cell-inputCollapser">
</div>
<div class="jp-InputArea jp-Cell-inputArea">
<div class="jp-InputPrompt jp-InputArea-prompt">In&#160;[12]:</div>
<div class="jp-CodeMirrorEditor jp-Editor jp-InputArea-editor">
     <div class="CodeMirror cm-s-jupyter">
<div class="highlight hl-ipython3"><pre><span></span><span class="c1"># analysis setup</span>
<span class="n">price_q3a_scenario</span> <span class="o">=</span> <span class="p">(</span><span class="mi">173</span><span class="p">,</span><span class="mi">198</span><span class="p">)</span>
<span class="n">price_q3b_scenario</span> <span class="o">=</span> <span class="p">(</span><span class="mi">172</span><span class="p">,</span><span class="mi">197</span><span class="p">)</span>
<span class="n">price_q3c_scenario</span> <span class="o">=</span> <span class="p">(</span><span class="mi">179</span><span class="p">,</span><span class="mi">204</span><span class="p">)</span>

<span class="c1">#df Q3a</span>
<span class="n">status_or_q3a</span><span class="p">,</span> <span class="n">variables_df_q3a</span><span class="p">,</span> <span class="n">constraints_df_q3a</span><span class="p">,</span> <span class="n">var_dict_q3a</span> <span class="o">=</span> <span class="n">AOS</span><span class="p">(</span><span class="n">price</span><span class="o">=</span><span class="p">(</span><span class="n">price_q3a_scenario</span><span class="p">))</span>
<span class="c1">#df Q3b</span>
<span class="n">status_or_q3b</span><span class="p">,</span> <span class="n">variables_df_q3b</span><span class="p">,</span> <span class="n">constraints_df_q3b</span><span class="p">,</span> <span class="n">var_dict_q3b</span> <span class="o">=</span> <span class="n">AOS</span><span class="p">(</span><span class="n">price</span><span class="o">=</span><span class="p">(</span><span class="n">price_q3b_scenario</span><span class="p">))</span>
<span class="c1">#df Q3c</span>
<span class="n">status_or_q3c</span><span class="p">,</span> <span class="n">variables_df_q3c</span><span class="p">,</span> <span class="n">constraints_df_q3c</span><span class="p">,</span> <span class="n">var_dict_q3c</span> <span class="o">=</span> <span class="n">AOS</span><span class="p">(</span><span class="n">price</span><span class="o">=</span><span class="p">(</span><span class="n">price_q3c_scenario</span><span class="p">))</span>
</pre></div>

     </div>
</div>
</div>
</div>

<div class="jp-Cell-outputWrapper">
<div class="jp-Collapser jp-OutputCollapser jp-Cell-outputCollapser">
</div>


<div class="jp-OutputArea jp-Cell-outputArea">

<div class="jp-OutputArea-child">

    
    <div class="jp-OutputPrompt jp-OutputArea-prompt"></div>


<div class="jp-RenderedText jp-OutputArea-output">
<pre>Gurobi Optimizer version 11.0.0 build v11.0.0rc2 (win64 - Windows 11+.0 (22631.2))

CPU model: AMD Ryzen 7 6800HS with Radeon Graphics, instruction set [SSE2|AVX|AVX2]
Thread count: 8 physical cores, 16 logical processors, using up to 16 threads

Optimize a model with 92 rows, 84 columns and 225 nonzeros
Model fingerprint: 0xf2cb0a19
Coefficient statistics:
  Matrix range     [1e-01, 2e+02]
  Objective range  [1e-02, 1e+00]
  Bounds range     [0e+00, 0e+00]
  RHS range        [1e+03, 6e+05]
Presolve removed 57 rows and 50 columns
Presolve time: 0.00s
Presolved: 35 rows, 34 columns, 131 nonzeros

Iteration    Objective       Primal Inf.    Dual Inf.      Time
       0    3.8400000e+30   5.075000e+29   3.840000e+00      0s
      19    9.0551982e+06   0.000000e+00   0.000000e+00      0s

Solved in 19 iterations and 0.01 seconds (0.00 work units)
Optimal objective  9.055198223e+06

Optimal Values for Decision Variables:
The objective value achieved in profit: 9055198.22 dollars
Gurobi Optimizer version 11.0.0 build v11.0.0rc2 (win64 - Windows 11+.0 (22631.2))

CPU model: AMD Ryzen 7 6800HS with Radeon Graphics, instruction set [SSE2|AVX|AVX2]
Thread count: 8 physical cores, 16 logical processors, using up to 16 threads

Optimize a model with 92 rows, 84 columns and 225 nonzeros
Model fingerprint: 0x3c161b1b
Coefficient statistics:
  Matrix range     [1e-01, 2e+02]
  Objective range  [1e-02, 1e+00]
  Bounds range     [0e+00, 0e+00]
  RHS range        [1e+03, 6e+05]
Presolve removed 57 rows and 50 columns
Presolve time: 0.00s
Presolved: 35 rows, 34 columns, 131 nonzeros

Iteration    Objective       Primal Inf.    Dual Inf.      Time
       0    3.8400000e+30   5.075000e+29   3.840000e+00      0s
      19    8.9271950e+06   0.000000e+00   0.000000e+00      0s

Solved in 19 iterations and 0.01 seconds (0.00 work units)
Optimal objective  8.927194983e+06

Optimal Values for Decision Variables:
The objective value achieved in profit: 8927194.98 dollars
Gurobi Optimizer version 11.0.0 build v11.0.0rc2 (win64 - Windows 11+.0 (22631.2))

CPU model: AMD Ryzen 7 6800HS with Radeon Graphics, instruction set [SSE2|AVX|AVX2]
Thread count: 8 physical cores, 16 logical processors, using up to 16 threads

Optimize a model with 92 rows, 84 columns and 225 nonzeros
Model fingerprint: 0x9105723c
Coefficient statistics:
  Matrix range     [1e-01, 2e+02]
  Objective range  [1e-02, 1e+00]
  Bounds range     [0e+00, 0e+00]
  RHS range        [1e+03, 6e+05]
Presolve removed 57 rows and 50 columns
Presolve time: 0.00s
Presolved: 35 rows, 34 columns, 131 nonzeros

Iteration    Objective       Primal Inf.    Dual Inf.      Time
       0    3.8400000e+30   5.075000e+29   3.840000e+00      0s
      19    9.8232177e+06   0.000000e+00   0.000000e+00      0s

Solved in 19 iterations and 0.01 seconds (0.00 work units)
Optimal objective  9.823217657e+06

Optimal Values for Decision Variables:
The objective value achieved in profit: 9823217.66 dollars
</pre>
</div>
</div>

</div>

</div>

</div>
<div class="jp-Cell jp-MarkdownCell jp-Notebook-cell">
<div class="jp-Cell-inputWrapper">
<div class="jp-Collapser jp-InputCollapser jp-Cell-inputCollapser">
</div>
<div class="jp-InputArea jp-Cell-inputArea"><div class="jp-InputPrompt jp-InputArea-prompt">
</div><div class="jp-RenderedHTMLCommon jp-RenderedMarkdown jp-MarkdownOutput">
<p><strong>1. Slight Decrease in Price to (173,198)</strong></p>
<p>A slight decrease in adapter pricing (IBM: 173, Mac: 198) has no impact on the amount of funds allocated to advertizing nor the quantity of the two adapters produced. Expected sales and inventory are also unaffected. As expected, a decline in revenues and excess funds allocated for investment in short-term securities is observed.</p>

</div>
</div>
</div>
</div><div class="jp-Cell jp-CodeCell jp-Notebook-cell">
<div class="jp-Cell-inputWrapper">
<div class="jp-Collapser jp-InputCollapser jp-Cell-inputCollapser">
</div>
<div class="jp-InputArea jp-Cell-inputArea">
<div class="jp-InputPrompt jp-InputArea-prompt">In&#160;[13]:</div>
<div class="jp-CodeMirrorEditor jp-Editor jp-InputArea-editor">
     <div class="CodeMirror cm-s-jupyter">
<div class="highlight hl-ipython3"><pre><span></span><span class="c1">#Slight decrease in adapter prices (ibm: $173 and mac: $198).</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Forecasted FY 1996 profits under a slight market price decrease scenario:&#39;</span><span class="p">,</span> <span class="s1">&#39;$</span><span class="si">{:,.2f}</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="mf">9055198.22</span><span class="p">))</span>
<span class="n">df_p_q3a</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">var_dict_q3a</span><span class="p">,</span> <span class="n">index</span> <span class="o">=</span> <span class="n">id_lbl</span><span class="p">)[</span><span class="mi">3</span><span class="p">:]</span>
<span class="n">df_p_q3a</span><span class="o">-</span><span class="n">df_original</span>
</pre></div>

     </div>
</div>
</div>
</div>

<div class="jp-Cell-outputWrapper">
<div class="jp-Collapser jp-OutputCollapser jp-Cell-outputCollapser">
</div>


<div class="jp-OutputArea jp-Cell-outputArea">

<div class="jp-OutputArea-child">

    
    <div class="jp-OutputPrompt jp-OutputArea-prompt"></div>


<div class="jp-RenderedText jp-OutputArea-output">
<pre>Forecasted FY 1996 profits under a slight market price decrease scenario: $9,055,198.22
</pre>
</div>
</div>

<div class="jp-OutputArea-child">

    
    <div class="jp-OutputPrompt jp-OutputArea-prompt">Out[13]:</div>



<div class="jp-RenderedHTMLCommon jp-RenderedHTML jp-OutputArea-output jp-OutputArea-executeResult">
<div>

<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>ADV</th>
      <th>ADV_IBM</th>
      <th>ADV_MAC</th>
      <th>IBM</th>
      <th>MAC</th>
      <th>PROD</th>
      <th>SIBM</th>
      <th>SMAC</th>
      <th>INVIBM</th>
      <th>INVMAC</th>
      <th>INVEST</th>
      <th>REV</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>1996 Q1</th>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>-71200.0000</td>
      <td>-71200.0</td>
    </tr>
    <tr>
      <th>1996 Q2</th>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>-132348.0000</td>
      <td>-60080.0</td>
    </tr>
    <tr>
      <th>1996 Q3</th>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>-191817.2200</td>
      <td>-57484.0</td>
    </tr>
    <tr>
      <th>1996 Q4</th>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>-256006.4783</td>
      <td>-61312.0</td>
    </tr>
  </tbody>
</table>
</div>
</div>

</div>

</div>

</div>

</div>
<div class="jp-Cell jp-MarkdownCell jp-Notebook-cell">
<div class="jp-Cell-inputWrapper">
<div class="jp-Collapser jp-InputCollapser jp-Cell-inputCollapser">
</div>
<div class="jp-InputArea jp-Cell-inputArea"><div class="jp-InputPrompt jp-InputArea-prompt">
</div><div class="jp-RenderedHTMLCommon jp-RenderedMarkdown jp-MarkdownOutput">
<p><strong>2. Subsequent Decrease to (172,197)</strong></p>
<p>A further pricing decrease (IBM: 172, Mac: 197) still fails to affect the optimal decisions for advertisement and production across all quarters. However, quarterly revenues continue to decline as the drop in price reduces AOS&#39; room for value generation. Further decreases in excess funds are also observed as less revenue is earned on per unit sale of both adpaters.</p>

</div>
</div>
</div>
</div><div class="jp-Cell jp-CodeCell jp-Notebook-cell">
<div class="jp-Cell-inputWrapper">
<div class="jp-Collapser jp-InputCollapser jp-Cell-inputCollapser">
</div>
<div class="jp-InputArea jp-Cell-inputArea">
<div class="jp-InputPrompt jp-InputArea-prompt">In&#160;[14]:</div>
<div class="jp-CodeMirrorEditor jp-Editor jp-InputArea-editor">
     <div class="CodeMirror cm-s-jupyter">
<div class="highlight hl-ipython3"><pre><span></span><span class="c1">#Minor decrease in adapter prices (ibm: $172 and mac: $197).</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Forecasted FY 1996 profits under a moderate market price decrease scenario:&#39;</span><span class="p">,</span> <span class="s1">&#39;$</span><span class="si">{:,.2f}</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="mf">8927194.98</span><span class="p">))</span>
<span class="n">df_p_q3b</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">var_dict_q3b</span><span class="p">,</span> <span class="n">index</span> <span class="o">=</span> <span class="n">id_lbl</span><span class="p">)[</span><span class="mi">3</span><span class="p">:]</span>
<span class="n">df_p_q3b</span><span class="o">-</span><span class="n">df_original</span>
</pre></div>

     </div>
</div>
</div>
</div>

<div class="jp-Cell-outputWrapper">
<div class="jp-Collapser jp-OutputCollapser jp-Cell-outputCollapser">
</div>


<div class="jp-OutputArea jp-Cell-outputArea">

<div class="jp-OutputArea-child">

    
    <div class="jp-OutputPrompt jp-OutputArea-prompt"></div>


<div class="jp-RenderedText jp-OutputArea-output">
<pre>Forecasted FY 1996 profits under a moderate market price decrease scenario: $8,927,194.98
</pre>
</div>
</div>

<div class="jp-OutputArea-child">

    
    <div class="jp-OutputPrompt jp-OutputArea-prompt">Out[14]:</div>



<div class="jp-RenderedHTMLCommon jp-RenderedHTML jp-OutputArea-output jp-OutputArea-executeResult">
<div>

<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>ADV</th>
      <th>ADV_IBM</th>
      <th>ADV_MAC</th>
      <th>IBM</th>
      <th>MAC</th>
      <th>PROD</th>
      <th>SIBM</th>
      <th>SMAC</th>
      <th>INVIBM</th>
      <th>INVMAC</th>
      <th>INVEST</th>
      <th>REV</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>1996 Q1</th>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>-106800.00000</td>
      <td>-106800.0</td>
    </tr>
    <tr>
      <th>1996 Q2</th>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>-198522.00000</td>
      <td>-90120.0</td>
    </tr>
    <tr>
      <th>1996 Q3</th>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>-287725.83000</td>
      <td>-86226.0</td>
    </tr>
    <tr>
      <th>1996 Q4</th>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>-384009.71745</td>
      <td>-91968.0</td>
    </tr>
  </tbody>
</table>
</div>
</div>

</div>

</div>

</div>

</div>
<div class="jp-Cell jp-MarkdownCell jp-Notebook-cell">
<div class="jp-Cell-inputWrapper">
<div class="jp-Collapser jp-InputCollapser jp-Cell-inputCollapser">
</div>
<div class="jp-InputArea jp-Cell-inputArea"><div class="jp-InputPrompt jp-InputArea-prompt">
</div><div class="jp-RenderedHTMLCommon jp-RenderedMarkdown jp-MarkdownOutput">
<p><strong>3. Minor increase in price to (179,204)</strong></p>
<p>A moderate increase in price (IBM: 179, Mac: 197) also does not pose a strong enough shock to the model&#39;s output. As expected, the amount of excess funds and cash collected in each quarter grow in reversed pattern when there is a price reduction.</p>

</div>
</div>
</div>
</div><div class="jp-Cell jp-CodeCell jp-Notebook-cell">
<div class="jp-Cell-inputWrapper">
<div class="jp-Collapser jp-InputCollapser jp-Cell-inputCollapser">
</div>
<div class="jp-InputArea jp-Cell-inputArea">
<div class="jp-InputPrompt jp-InputArea-prompt">In&#160;[15]:</div>
<div class="jp-CodeMirrorEditor jp-Editor jp-InputArea-editor">
     <div class="CodeMirror cm-s-jupyter">
<div class="highlight hl-ipython3"><pre><span></span><span class="c1">#Minor increase in adapter prices (ibm: $179 and mac: $204).</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Forecasted FY 1996 profits under a moderate market price increase scenario:&#39;</span><span class="p">,</span> <span class="s1">&#39;$</span><span class="si">{:,.2f}</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="mf">9.823217657e+06</span><span class="p">))</span>
<span class="n">df_p_q3c</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">var_dict_q3c</span><span class="p">,</span> <span class="n">index</span> <span class="o">=</span> <span class="n">id_lbl</span><span class="p">)[</span><span class="mi">3</span><span class="p">:]</span>
<span class="n">df_p_q3c</span><span class="o">-</span><span class="n">df_original</span>
</pre></div>

     </div>
</div>
</div>
</div>

<div class="jp-Cell-outputWrapper">
<div class="jp-Collapser jp-OutputCollapser jp-Cell-outputCollapser">
</div>


<div class="jp-OutputArea jp-Cell-outputArea">

<div class="jp-OutputArea-child">

    
    <div class="jp-OutputPrompt jp-OutputArea-prompt"></div>


<div class="jp-RenderedText jp-OutputArea-output">
<pre>Forecasted FY 1996 profits under a moderate market price increase scenario: $9,823,217.66
</pre>
</div>
</div>

<div class="jp-OutputArea-child">

    
    <div class="jp-OutputPrompt jp-OutputArea-prompt">Out[15]:</div>



<div class="jp-RenderedHTMLCommon jp-RenderedHTML jp-OutputArea-output jp-OutputArea-executeResult">
<div>

<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>ADV</th>
      <th>ADV_IBM</th>
      <th>ADV_MAC</th>
      <th>IBM</th>
      <th>MAC</th>
      <th>PROD</th>
      <th>SIBM</th>
      <th>SMAC</th>
      <th>INVIBM</th>
      <th>INVMAC</th>
      <th>INVEST</th>
      <th>REV</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>1996 Q1</th>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>142400.0000</td>
      <td>142400.0</td>
    </tr>
    <tr>
      <th>1996 Q2</th>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>264696.0000</td>
      <td>120160.0</td>
    </tr>
    <tr>
      <th>1996 Q3</th>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>383634.4400</td>
      <td>114968.0</td>
    </tr>
    <tr>
      <th>1996 Q4</th>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>512012.9566</td>
      <td>122624.0</td>
    </tr>
  </tbody>
</table>
</div>
</div>

</div>

</div>

</div>

</div>
<div class="jp-Cell jp-MarkdownCell jp-Notebook-cell">
<div class="jp-Cell-inputWrapper">
<div class="jp-Collapser jp-InputCollapser jp-Cell-inputCollapser">
</div>
<div class="jp-InputArea jp-Cell-inputArea"><div class="jp-InputPrompt jp-InputArea-prompt">
</div><div class="jp-RenderedHTMLCommon jp-RenderedMarkdown jp-MarkdownOutput">
<p><strong>Conclusion</strong></p>
<p>Across all 3 simulated scenarios, there is, as expected, overall revenues change in the same direction prices for adapters change. This in turn affects the amount of excess cash flow that can be re-invested into short-term government securities.</p>
<p>Notably, the solution of the decision variables remains static. In particular, core managerial decisions regarding advertisement and production are unaffected, indicating the model is resilient to minor changes in adapter market pricing. This strength most likely lies in AOS&#39; ability to sell beyond the demand prediction ceiling and its existing cost structure.</p>
<p>The presence of advertisement allows the firm to generate addtional revenues by utilizing all of its production capacity. In addition, the per unit cost of the adpaters at the status quo leaves plenty buffers to absorb the variance coming from market price fluctuations. Therefore, as long as prices do not fall below the threshold at which selling beyond expected demand becomes unprofitable, it is very likely that the optimal solution will remain unchanged.</p>

</div>
</div>
</div>
</div><div class="jp-Cell jp-CodeCell jp-Notebook-cell">
<div class="jp-Cell-inputWrapper">
<div class="jp-Collapser jp-InputCollapser jp-Cell-inputCollapser">
</div>
<div class="jp-InputArea jp-Cell-inputArea">
<div class="jp-InputPrompt jp-InputArea-prompt">In&#160;[16]:</div>
<div class="jp-CodeMirrorEditor jp-Editor jp-InputArea-editor">
     <div class="CodeMirror cm-s-jupyter">
<div class="highlight hl-ipython3"><pre><span></span><span class="c1"># Table showing forecasted profits under various market price scenarios.</span>
<span class="n">profits</span> <span class="o">=</span> <span class="n">make_array</span><span class="p">(</span><span class="s1">&#39;$</span><span class="si">{:,.2f}</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="mf">9.311204701e+06</span><span class="p">),</span><span class="s1">&#39;$</span><span class="si">{:,.2f}</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="mf">9055198.22</span><span class="p">),</span><span class="s1">&#39;$</span><span class="si">{:,.2f}</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="mf">8927194.98</span><span class="p">),</span><span class="s1">&#39;$</span><span class="si">{:,.2f}</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="mf">9.823217657e+06</span><span class="p">))</span>

<span class="c1"># scenario_profit_table</span>
<span class="n">Table</span><span class="p">()</span><span class="o">.</span><span class="n">with_columns</span><span class="p">(</span><span class="s1">&#39;Scenario&#39;</span><span class="p">,[</span><span class="s1">&#39;Baseline&#39;</span><span class="p">,</span><span class="s1">&#39;Slight Decrease&#39;</span><span class="p">,</span><span class="s1">&#39;Moderate Decrease&#39;</span><span class="p">,</span><span class="s1">&#39;Moderate Increase&#39;</span><span class="p">],</span><span class="s1">&#39;Maximum Profit&#39;</span><span class="p">,</span><span class="n">profits</span><span class="p">,</span><span class="s1">&#39;Change in ADV &amp;.PROD&#39;</span><span class="p">,</span><span class="n">make_array</span><span class="p">(</span><span class="s1">&#39;-&#39;</span><span class="p">,</span><span class="s1">&#39;F&#39;</span><span class="p">,</span><span class="s1">&#39;F&#39;</span><span class="p">,</span><span class="s1">&#39;F&#39;</span><span class="p">))</span>
</pre></div>

     </div>
</div>
</div>
</div>

<div class="jp-Cell-outputWrapper">
<div class="jp-Collapser jp-OutputCollapser jp-Cell-outputCollapser">
</div>


<div class="jp-OutputArea jp-Cell-outputArea">

<div class="jp-OutputArea-child">

    
    <div class="jp-OutputPrompt jp-OutputArea-prompt">Out[16]:</div>



<div class="jp-RenderedHTMLCommon jp-RenderedHTML jp-OutputArea-output jp-OutputArea-executeResult">
<table border="1" class="dataframe">
    <thead>
        <tr>
            <th>Scenario</th> <th>Maximum Profit</th> <th>Change in ADV &amp;.PROD</th>
        </tr>
    </thead>
    <tbody>
        <tr>
            <td>Baseline         </td> <td>$9,311,204.70 </td> <td>-                   </td>
        </tr>
        <tr>
            <td>Slight Decrease  </td> <td>$9,055,198.22 </td> <td>F                   </td>
        </tr>
        <tr>
            <td>Moderate Decrease</td> <td>$8,927,194.98 </td> <td>F                   </td>
        </tr>
        <tr>
            <td>Moderate Increase</td> <td>$9,823,217.66 </td> <td>F                   </td>
        </tr>
    </tbody>
</table>
</div>

</div>

</div>

</div>

</div>
<div class="jp-Cell jp-MarkdownCell jp-Notebook-cell">
<div class="jp-Cell-inputWrapper">
<div class="jp-Collapser jp-InputCollapser jp-Cell-inputCollapser">
</div>
<div class="jp-InputArea jp-Cell-inputArea"><div class="jp-InputPrompt jp-InputArea-prompt">
</div><div class="jp-RenderedHTMLCommon jp-RenderedMarkdown jp-MarkdownOutput">
<h3>b. Variability in Production Cost<a rel="noopener" class="anchor-link" href="#b.-Variability-in-Production-Cost">&#182;</a></h3>
</div>
</div>
</div>
</div>
<div class="jp-Cell jp-MarkdownCell jp-Notebook-cell">
<div class="jp-Cell-inputWrapper">
<div class="jp-Collapser jp-InputCollapser jp-Cell-inputCollapser">
</div>
<div class="jp-InputArea jp-Cell-inputArea"><div class="jp-InputPrompt jp-InputArea-prompt">
</div><div class="jp-RenderedHTMLCommon jp-RenderedMarkdown jp-MarkdownOutput">
<p>The effects of cost inflation on adapter variable costs is another important factor to consider. The cost of production, similar to market prices, are prone to variance under real-world conditions. Two scenarios examining the effects of this change on the model are reflected in tables below.</p>

</div>
</div>
</div>
</div><div class="jp-Cell jp-CodeCell jp-Notebook-cell">
<div class="jp-Cell-inputWrapper">
<div class="jp-Collapser jp-InputCollapser jp-Cell-inputCollapser">
</div>
<div class="jp-InputArea jp-Cell-inputArea">
<div class="jp-InputPrompt jp-InputArea-prompt">In&#160;[17]:</div>
<div class="jp-CodeMirrorEditor jp-Editor jp-InputArea-editor">
     <div class="CodeMirror cm-s-jupyter">
<div class="highlight hl-ipython3"><pre><span></span><span class="c1">#Setup for Q4.</span>
<span class="n">cost_q4a_scenario</span> <span class="o">=</span> <span class="p">(</span><span class="mi">101</span><span class="p">,</span><span class="mi">111</span><span class="p">)</span>
<span class="n">cost_q4b_scenario</span> <span class="o">=</span> <span class="p">(</span><span class="mi">103</span><span class="p">,</span><span class="mi">115</span><span class="p">)</span>

<span class="c1">#df Q4a</span>
<span class="n">status_or_q4a</span><span class="p">,</span> <span class="n">variables_df_q4a</span><span class="p">,</span> <span class="n">constraints_df_q4a</span><span class="p">,</span> <span class="n">var_dict_q4a</span> <span class="o">=</span> <span class="n">AOS</span><span class="p">(</span><span class="n">cost</span><span class="o">=</span><span class="p">(</span><span class="n">cost_q4a_scenario</span><span class="p">))</span>
<span class="c1">#df Q4b</span>
<span class="n">status_or_q4b</span><span class="p">,</span> <span class="n">variables_df_q4b</span><span class="p">,</span> <span class="n">constraints_df_q4b</span><span class="p">,</span> <span class="n">var_dict_q4b</span> <span class="o">=</span> <span class="n">AOS</span><span class="p">(</span><span class="n">cost</span><span class="o">=</span><span class="p">(</span><span class="n">cost_q4b_scenario</span><span class="p">))</span>
</pre></div>

     </div>
</div>
</div>
</div>

<div class="jp-Cell-outputWrapper">
<div class="jp-Collapser jp-OutputCollapser jp-Cell-outputCollapser">
</div>


<div class="jp-OutputArea jp-Cell-outputArea">

<div class="jp-OutputArea-child">

    
    <div class="jp-OutputPrompt jp-OutputArea-prompt"></div>


<div class="jp-RenderedText jp-OutputArea-output">
<pre>Gurobi Optimizer version 11.0.0 build v11.0.0rc2 (win64 - Windows 11+.0 (22631.2))

CPU model: AMD Ryzen 7 6800HS with Radeon Graphics, instruction set [SSE2|AVX|AVX2]
Thread count: 8 physical cores, 16 logical processors, using up to 16 threads

Optimize a model with 92 rows, 84 columns and 225 nonzeros
Model fingerprint: 0x1d912e1c
Coefficient statistics:
  Matrix range     [1e-01, 2e+02]
  Objective range  [1e-02, 1e+00]
  Bounds range     [0e+00, 0e+00]
  RHS range        [1e+03, 6e+05]
Presolve removed 57 rows and 50 columns
Presolve time: 0.00s
Presolved: 35 rows, 34 columns, 131 nonzeros

Iteration    Objective       Primal Inf.    Dual Inf.      Time
       0    3.8400000e+30   5.075000e+29   3.840000e+00      0s
      19    9.1905043e+06   0.000000e+00   0.000000e+00      0s

Solved in 19 iterations and 0.01 seconds (0.00 work units)
Optimal objective  9.190504284e+06

Optimal Values for Decision Variables:
The objective value achieved in profit: 9190504.28 dollars
Gurobi Optimizer version 11.0.0 build v11.0.0rc2 (win64 - Windows 11+.0 (22631.2))

CPU model: AMD Ryzen 7 6800HS with Radeon Graphics, instruction set [SSE2|AVX|AVX2]
Thread count: 8 physical cores, 16 logical processors, using up to 16 threads

Optimize a model with 92 rows, 84 columns and 225 nonzeros
Model fingerprint: 0x125f9ddb
Coefficient statistics:
  Matrix range     [1e-01, 2e+02]
  Objective range  [1e-02, 1e+00]
  Bounds range     [0e+00, 0e+00]
  RHS range        [1e+03, 6e+05]
Presolve removed 57 rows and 50 columns
Presolve time: 0.00s
Presolved: 35 rows, 34 columns, 131 nonzeros

Iteration    Objective       Primal Inf.    Dual Inf.      Time
       0    3.8400000e+30   5.075000e+29   3.840000e+00      0s
      19    8.8887544e+06   0.000000e+00   0.000000e+00      0s

Solved in 19 iterations and 0.01 seconds (0.00 work units)
Optimal objective  8.888754441e+06

Optimal Values for Decision Variables:
The objective value achieved in profit: 8888754.44 dollars
</pre>
</div>
</div>

</div>

</div>

</div>
<div class="jp-Cell jp-MarkdownCell jp-Notebook-cell">
<div class="jp-Cell-inputWrapper">
<div class="jp-Collapser jp-InputCollapser jp-Cell-inputCollapser">
</div>
<div class="jp-InputArea jp-Cell-inputArea"><div class="jp-InputPrompt jp-InputArea-prompt">
</div><div class="jp-RenderedHTMLCommon jp-RenderedMarkdown jp-MarkdownOutput">
<p><strong>1. Rise in Variable Cost to (101,111)</strong></p>
<p>As adapter variable costs increase slightly, an increase in funds allocated to production is observed. Due to this need, a portion of the excess funds at the end of each quarter is directed towards production. This is necessary to maintain the same production level that fully utilizes the company&#39;s assets in order to maximize revenues and profits. Despite this change, all of the other decision variables remain the same.</p>

</div>
</div>
</div>
</div><div class="jp-Cell jp-CodeCell jp-Notebook-cell">
<div class="jp-Cell-inputWrapper">
<div class="jp-Collapser jp-InputCollapser jp-Cell-inputCollapser">
</div>
<div class="jp-InputArea jp-Cell-inputArea">
<div class="jp-InputPrompt jp-InputArea-prompt">In&#160;[18]:</div>
<div class="jp-CodeMirrorEditor jp-Editor jp-InputArea-editor">
     <div class="CodeMirror cm-s-jupyter">
<div class="highlight hl-ipython3"><pre><span></span><span class="c1">#Q4. a) change in cost to 101 and 111.</span>
<span class="n">df_q4a</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">var_dict_q4a</span><span class="p">,</span> <span class="n">index</span> <span class="o">=</span> <span class="n">id_lbl</span><span class="p">)[</span><span class="mi">3</span><span class="p">:]</span>
<span class="n">df_q4a</span><span class="o">-</span><span class="n">df_original</span>
</pre></div>

     </div>
</div>
</div>
</div>

<div class="jp-Cell-outputWrapper">
<div class="jp-Collapser jp-OutputCollapser jp-Cell-outputCollapser">
</div>


<div class="jp-OutputArea jp-Cell-outputArea">

<div class="jp-OutputArea-child">

    
    <div class="jp-OutputPrompt jp-OutputArea-prompt">Out[18]:</div>



<div class="jp-RenderedHTMLCommon jp-RenderedHTML jp-OutputArea-output jp-OutputArea-executeResult">
<div>

<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>ADV</th>
      <th>ADV_IBM</th>
      <th>ADV_MAC</th>
      <th>IBM</th>
      <th>MAC</th>
      <th>PROD</th>
      <th>SIBM</th>
      <th>SMAC</th>
      <th>INVIBM</th>
      <th>INVMAC</th>
      <th>INVEST</th>
      <th>REV</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>1996 Q1</th>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>28800.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>-28800.0000</td>
      <td>0.0</td>
    </tr>
    <tr>
      <th>1996 Q2</th>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>28800.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>-58032.0000</td>
      <td>0.0</td>
    </tr>
    <tr>
      <th>1996 Q3</th>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>28800.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>-87702.4800</td>
      <td>0.0</td>
    </tr>
    <tr>
      <th>1996 Q4</th>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>31680.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>-120700.4172</td>
      <td>0.0</td>
    </tr>
  </tbody>
</table>
</div>
</div>

</div>

</div>

</div>

</div>
<div class="jp-Cell jp-MarkdownCell jp-Notebook-cell">
<div class="jp-Cell-inputWrapper">
<div class="jp-Collapser jp-InputCollapser jp-Cell-inputCollapser">
</div>
<div class="jp-InputArea jp-Cell-inputArea"><div class="jp-InputPrompt jp-InputArea-prompt">
</div><div class="jp-RenderedHTMLCommon jp-RenderedMarkdown jp-MarkdownOutput">
<p><strong>2. Rise in Variable Cost to (103,115)</strong></p>
<p>Further increases in variable costs put additional pressure on cashflows as even more of it must be redirected to production. The achieved profit fall below 9 million (8888754.44). The decrease in excess funds over subsequent quarters is a linear combination of the interest no longer received from the funds that would have been re-invested into short-term securities, the correponding increase in carrying costs, and the amount directed towards production to cover the raise. However, the model still geneates the same set of insights about operational decisions.</p>

</div>
</div>
</div>
</div><div class="jp-Cell jp-CodeCell jp-Notebook-cell">
<div class="jp-Cell-inputWrapper">
<div class="jp-Collapser jp-InputCollapser jp-Cell-inputCollapser">
</div>
<div class="jp-InputArea jp-Cell-inputArea">
<div class="jp-InputPrompt jp-InputArea-prompt">In&#160;[19]:</div>
<div class="jp-CodeMirrorEditor jp-Editor jp-InputArea-editor">
     <div class="CodeMirror cm-s-jupyter">
<div class="highlight hl-ipython3"><pre><span></span><span class="c1">#Q4. b) change in cost to 103,115</span>
<span class="n">df_q4b</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">var_dict_q4b</span><span class="p">,</span> <span class="n">index</span> <span class="o">=</span> <span class="n">id_lbl</span><span class="p">)[</span><span class="mi">3</span><span class="p">:]</span>
<span class="n">df_q4b</span><span class="o">-</span><span class="n">df_original</span>
</pre></div>

     </div>
</div>
</div>
</div>

<div class="jp-Cell-outputWrapper">
<div class="jp-Collapser jp-OutputCollapser jp-Cell-outputCollapser">
</div>


<div class="jp-OutputArea jp-Cell-outputArea">

<div class="jp-OutputArea-child">

    
    <div class="jp-OutputPrompt jp-OutputArea-prompt">Out[19]:</div>



<div class="jp-RenderedHTMLCommon jp-RenderedHTML jp-OutputArea-output jp-OutputArea-executeResult">
<div>

<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>ADV</th>
      <th>ADV_IBM</th>
      <th>ADV_MAC</th>
      <th>IBM</th>
      <th>MAC</th>
      <th>PROD</th>
      <th>SIBM</th>
      <th>SMAC</th>
      <th>INVIBM</th>
      <th>INVMAC</th>
      <th>INVEST</th>
      <th>REV</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>1996 Q1</th>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>100800.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>-100800.0000</td>
      <td>0.0</td>
    </tr>
    <tr>
      <th>1996 Q2</th>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>100800.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>-203112.0000</td>
      <td>0.0</td>
    </tr>
    <tr>
      <th>1996 Q3</th>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>100800.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>-306958.6800</td>
      <td>0.0</td>
    </tr>
    <tr>
      <th>1996 Q4</th>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>110880.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>-422450.2602</td>
      <td>0.0</td>
    </tr>
  </tbody>
</table>
</div>
</div>

</div>

</div>

</div>

</div>
<div class="jp-Cell jp-MarkdownCell jp-Notebook-cell">
<div class="jp-Cell-inputWrapper">
<div class="jp-Collapser jp-InputCollapser jp-Cell-inputCollapser">
</div>
<div class="jp-InputArea jp-Cell-inputArea"><div class="jp-InputPrompt jp-InputArea-prompt">
</div><div class="jp-RenderedHTMLCommon jp-RenderedMarkdown jp-MarkdownOutput">
<p><strong>Conclusion</strong></p>
<p>Increases to adapter input costs reduces the amount of excess funds that can be re-invested. Rising costs also decreases the total achieved profits as the profit margin for each unit sold is reduced. Below is an illustration of the profit margin of sales beyond the predicted demand in absence of the change in costs. The green area represents the profit that AOS can potentially gain from each unit of sale. An increase in production costs, denoted by the blue region, will engulf a portion of the green area and change them to blue, reducing AOS&#39; revenue generation ability. The model, as previously discussed, will produce the same set of optimal operational decisionsas long as the profit margin is not altered by great amount. It can be said that as long as the profit margins illustrated below remain positive, the model will not alter the solution by great amounts: it is resistent to minor fluctuations. This stability suggests that even if AOS encounters changes in cost structures in similar magnitutde during actual operations, continuing executing the optimal solution provided by the model still maximizes profit.</p>

</div>
</div>
</div>
</div><div class="jp-Cell jp-CodeCell jp-Notebook-cell">
<div class="jp-Cell-inputWrapper">
<div class="jp-Collapser jp-InputCollapser jp-Cell-inputCollapser">
</div>
<div class="jp-InputArea jp-Cell-inputArea">
<div class="jp-InputPrompt jp-InputArea-prompt">In&#160;[20]:</div>
<div class="jp-CodeMirrorEditor jp-Editor jp-InputArea-editor">
     <div class="CodeMirror cm-s-jupyter">
<div class="highlight hl-ipython3"><pre><span></span><span class="c1"># profit margin graph</span>
<span class="n">products</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;IBM&#39;</span><span class="p">,</span> <span class="s1">&#39;Mac&#39;</span><span class="p">]</span>
<span class="n">costs</span> <span class="o">=</span> <span class="p">[</span><span class="mi">100</span><span class="p">,</span> <span class="mi">110</span><span class="p">]</span>  
<span class="n">prices</span> <span class="o">=</span> <span class="p">[</span><span class="mi">175</span><span class="p">,</span> <span class="mi">200</span><span class="p">]</span>  

<span class="n">additional_value</span> <span class="o">=</span> <span class="mi">10</span>

<span class="c1"># Create the figure and axis</span>
<span class="n">fig</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">()</span>

<span class="n">bar1</span> <span class="o">=</span> <span class="n">ax</span><span class="o">.</span><span class="n">bar</span><span class="p">(</span><span class="n">products</span><span class="p">,</span> <span class="n">costs</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;Cost&#39;</span><span class="p">)</span>
<span class="n">bar3</span> <span class="o">=</span> <span class="n">ax</span><span class="o">.</span><span class="n">bar</span><span class="p">(</span><span class="n">products</span><span class="p">,</span> <span class="p">[</span><span class="n">additional_value</span><span class="p">]</span> <span class="o">*</span> <span class="nb">len</span><span class="p">(</span><span class="n">products</span><span class="p">),</span> <span class="n">bottom</span><span class="o">=</span><span class="n">costs</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;Adv Cost&#39;</span><span class="p">)</span>
<span class="n">bar2</span> <span class="o">=</span> <span class="n">ax</span><span class="o">.</span><span class="n">bar</span><span class="p">(</span><span class="n">products</span><span class="p">,</span> <span class="p">[</span><span class="n">price</span> <span class="o">-</span> <span class="n">cost</span> <span class="o">-</span> <span class="n">additional_value</span> <span class="k">for</span> <span class="n">price</span><span class="p">,</span> <span class="n">cost</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span><span class="n">prices</span><span class="p">,</span> <span class="n">costs</span><span class="p">)],</span> <span class="n">bottom</span><span class="o">=</span><span class="p">[</span><span class="n">cost</span> <span class="o">+</span> <span class="n">additional_value</span> <span class="k">for</span> <span class="n">cost</span> <span class="ow">in</span> <span class="n">costs</span><span class="p">],</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;Profit Margin&#39;</span><span class="p">)</span>

<span class="c1"># Add labels and title</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s1">&#39;value ($)&#39;</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s1">&#39;Profit Margin of Products&#39;</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">legend</span><span class="p">()</span>

<span class="c1"># Show plot</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xticks</span><span class="p">(</span><span class="n">rotation</span><span class="o">=</span><span class="mi">45</span><span class="p">,</span> <span class="n">ha</span><span class="o">=</span><span class="s1">&#39;right&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">tight_layout</span><span class="p">()</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>

     </div>
</div>
</div>
</div>

<div class="jp-Cell-outputWrapper">
<div class="jp-Collapser jp-OutputCollapser jp-Cell-outputCollapser">
</div>


<div class="jp-OutputArea jp-Cell-outputArea">

<div class="jp-OutputArea-child">

    
    <div class="jp-OutputPrompt jp-OutputArea-prompt"></div>




<div class="jp-RenderedImage jp-OutputArea-output">
<img src="javascript://"/>
</div>

</div>

</div>

</div>

</div>
<div class="jp-Cell jp-MarkdownCell jp-Notebook-cell">
<div class="jp-Cell-inputWrapper">
<div class="jp-Collapser jp-InputCollapser jp-Cell-inputCollapser">
</div>
<div class="jp-InputArea jp-Cell-inputArea"><div class="jp-InputPrompt jp-InputArea-prompt">
</div><div class="jp-RenderedHTMLCommon jp-RenderedMarkdown jp-MarkdownOutput">
<h3>c. Plans with Rates of Account Receivables<a rel="noopener" class="anchor-link" href="#c.-Plans-with-Rates-of-Account-Receivables">&#182;</a></h3><p>The structure of accounts receivable is crucial for a company as it directly impacts its cash flow and financial health. A well-managed accounts receivable structure ensures timely collection of payments from customers, reducing the risk of bad debts and improving liquidity. Conversely, a disorganized or inefficient accounts receivable structure may lead to delayed payments, cash flow shortages, and increased borrowing costs. In the case of AOS, an improved lines of receivables is encourage instant collection of revenue and therefore increase the amount of excess fundsthat can be directed towards investments, generating addtional revenues while securing finacial health. However, whether plans to renovate the entire system is worthwhile to pursue still requires further discussion.</p>

</div>
</div>
</div>
</div>
<div class="jp-Cell jp-MarkdownCell jp-Notebook-cell">
<div class="jp-Cell-inputWrapper">
<div class="jp-Collapser jp-InputCollapser jp-Cell-inputCollapser">
</div>
<div class="jp-InputArea jp-Cell-inputArea"><div class="jp-InputPrompt jp-InputArea-prompt">
</div><div class="jp-RenderedHTMLCommon jp-RenderedMarkdown jp-MarkdownOutput">
<p><strong>1. A New Collection Procedure</strong></p>
<p>The new procedure shifts most of the second-level cash collections occurring in Q2 to Q1, resulting in immediate collection. This transformation streamlines the collection process, accelerating the conversion of accounts receivable into cash. The table of changes in decision variables mimics this result. In the first quarter, the revenue increase in the first quarter is accompanied by a simultaneous decrease in the second quarter.</p>
<p>The alteration in account receivables rates also leads to a decline in revenue from Q3. This decrease might stem from the challenge of adjusting production plans to align with the new rates. Additionally, the surplus revenue generated from inventories at the year&#39;s outset could have artificially inflated income in subsequent quarters.</p>
<p>Despite these parochial patterns that are specific to a quarterly basis, the increase in achieved profit 689104.89 (10000309.59-9311204.7) is significantly higher than the cost associated for renovation. Therefore, it is a worthwhile plan to pursue.</p>
<p>As a special note, the reversal in account receivables rates could impact the numerical valuation of outstanding collectibles from the preceding year, notably in 1995. Currently, the model is designed in a way that past collectibles will share the same rates as it is defined today. Given the reversal in account receivables rates, the model may no longer accurately calculate past receivables based on the previous rates, potentially introducing bias into the results.</p>

</div>
</div>
</div>
</div><div class="jp-Cell jp-CodeCell jp-Notebook-cell">
<div class="jp-Cell-inputWrapper">
<div class="jp-Collapser jp-InputCollapser jp-Cell-inputCollapser">
</div>
<div class="jp-InputArea jp-Cell-inputArea">
<div class="jp-InputPrompt jp-InputArea-prompt">In&#160;[21]:</div>
<div class="jp-CodeMirrorEditor jp-Editor jp-InputArea-editor">
     <div class="CodeMirror cm-s-jupyter">
<div class="highlight hl-ipython3"><pre><span></span><span class="c1"># q5a</span>
<span class="n">new_R</span> <span class="o">=</span> <span class="p">{</span>
    <span class="s1">&#39;ibm&#39;</span><span class="p">:</span><span class="n">make_array</span><span class="p">(</span><span class="mf">0.9</span><span class="p">,</span><span class="mf">0.07</span><span class="p">,</span><span class="mf">0.01</span><span class="p">,</span><span class="mi">1</span><span class="o">-</span><span class="nb">sum</span><span class="p">((</span><span class="mf">0.9</span><span class="p">,</span><span class="mf">0.07</span><span class="p">,</span><span class="mf">0.01</span><span class="p">))),</span>
    <span class="s1">&#39;mac&#39;</span><span class="p">:</span><span class="n">make_array</span><span class="p">(</span><span class="mf">0.92</span><span class="p">,</span><span class="mf">0.03</span><span class="p">,</span><span class="mf">0.01</span><span class="p">,</span><span class="mi">1</span><span class="o">-</span><span class="nb">sum</span><span class="p">((</span><span class="mf">0.92</span><span class="p">,</span><span class="mf">0.03</span><span class="p">,</span><span class="mf">0.01</span><span class="p">)))</span>
<span class="p">}</span>

<span class="n">status_or_q5a</span><span class="p">,</span> <span class="n">variables_df_q5a</span><span class="p">,</span> <span class="n">constraints_df_q5a</span><span class="p">,</span> <span class="n">var_dict_q5a</span> <span class="o">=</span> <span class="n">AOS</span><span class="p">(</span><span class="n">collect_rate</span><span class="o">=</span><span class="n">new_R</span><span class="p">)</span>
<span class="n">df_q5a</span><span class="o">=</span><span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">var_dict_q5a</span><span class="p">,</span> <span class="n">index</span> <span class="o">=</span> <span class="n">id_lbl</span><span class="p">)[</span><span class="mi">3</span><span class="p">:]</span>
<span class="n">df_q5a</span><span class="o">-</span><span class="n">df_original</span>
</pre></div>

     </div>
</div>
</div>
</div>

<div class="jp-Cell-outputWrapper">
<div class="jp-Collapser jp-OutputCollapser jp-Cell-outputCollapser">
</div>


<div class="jp-OutputArea jp-Cell-outputArea">

<div class="jp-OutputArea-child">

    
    <div class="jp-OutputPrompt jp-OutputArea-prompt"></div>


<div class="jp-RenderedText jp-OutputArea-output">
<pre>Gurobi Optimizer version 11.0.0 build v11.0.0rc2 (win64 - Windows 11+.0 (22631.2))

CPU model: AMD Ryzen 7 6800HS with Radeon Graphics, instruction set [SSE2|AVX|AVX2]
Thread count: 8 physical cores, 16 logical processors, using up to 16 threads

Optimize a model with 92 rows, 84 columns and 225 nonzeros
Model fingerprint: 0xdfdfe2f3
Coefficient statistics:
  Matrix range     [1e-01, 2e+02]
  Objective range  [1e-02, 1e+00]
  Bounds range     [0e+00, 0e+00]
  RHS range        [1e+03, 6e+05]
Presolve removed 57 rows and 50 columns
Presolve time: 0.00s
Presolved: 35 rows, 34 columns, 131 nonzeros

Iteration    Objective       Primal Inf.    Dual Inf.      Time
       0    3.8400000e+30   5.075000e+29   3.840000e+00      0s
      19    1.0000310e+07   0.000000e+00   0.000000e+00      0s

Solved in 19 iterations and 0.01 seconds (0.00 work units)
Optimal objective  1.000030959e+07

Optimal Values for Decision Variables:
The objective value achieved in profit: 10000309.59 dollars
</pre>
</div>
</div>

<div class="jp-OutputArea-child">

    
    <div class="jp-OutputPrompt jp-OutputArea-prompt">Out[21]:</div>



<div class="jp-RenderedHTMLCommon jp-RenderedHTML jp-OutputArea-output jp-OutputArea-executeResult">
<div>

<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>ADV</th>
      <th>ADV_IBM</th>
      <th>ADV_MAC</th>
      <th>IBM</th>
      <th>MAC</th>
      <th>PROD</th>
      <th>SIBM</th>
      <th>SMAC</th>
      <th>INVIBM</th>
      <th>INVMAC</th>
      <th>INVEST</th>
      <th>REV</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>1996 Q1</th>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>879000.000000</td>
      <td>879000.0</td>
    </tr>
    <tr>
      <th>1996 Q2</th>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>677085.000000</td>
      <td>-215100.0</td>
    </tr>
    <tr>
      <th>1996 Q3</th>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>612241.275000</td>
      <td>-75000.0</td>
    </tr>
    <tr>
      <th>1996 Q4</th>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>689104.894125</td>
      <td>67680.0</td>
    </tr>
  </tbody>
</table>
</div>
</div>

</div>

</div>

</div>

</div>
<div class="jp-Cell jp-MarkdownCell jp-Notebook-cell">
<div class="jp-Cell-inputWrapper">
<div class="jp-Collapser jp-InputCollapser jp-Cell-inputCollapser">
</div>
<div class="jp-InputArea jp-Cell-inputArea"><div class="jp-InputPrompt jp-InputArea-prompt">
</div><div class="jp-RenderedHTMLCommon jp-RenderedMarkdown jp-MarkdownOutput">
<p><strong>2. All Cash Collection</strong></p>
<p>Implementation of the all-cash strategy is assumed to cost $190k in total.</p>
<p>The forecasted effects on revenues are especially staggering within the first quarter of 1996 as it increases by nearly 1.5 million. In Q2 1996, a decline is observed. This can be attributed to the fact that the revenue that would have been received from the previous year is no longer included in the books of 1996. In addition, 20 percent of the sales from quarter 1 has completely shifted away from the cash collection in quarter 2. Q3 and Q4 are not so sensitive to this change as their amount of previous collections were comparably low under the original system.</p>
<p>The all-cash strategy improves AOS&#39; financial health, as presented in the positive changes in the excess funds at the end of each quarter. This all-cash flow strategy may be especially lucrative in managing cashflow liquidity and reducing the use of or reliance on lines of credit. Overall profitability is also significantly affected on the upside, an increase of about 1.5 million. This change significantly out-competes its implementation cost.</p>
<p>However, a note of caution is required about the customers&#39; aversed nature. Switching to an all-cash collection method may deter some customers and consequently decrease sales. While this strategy enhances the liquidity of the company, it may be seen as unacceptable to customers, as it could disrupt their financial planning. Customers accustomed to other payment methods may find the sudden shift inconvenient or impractical, potentially leading them to seek alternative suppliers or refrain from making purchases altogether.</p>
<p>Therefore, although it is a recommended to pursue to pursue the plan, such a strategy requires careful consideration of its potential impact on customer satisfaction and long-term relationships. Balancing the need for liquidity with maintaining positive customer experiences is crucial for sustainable business growth.</p>

</div>
</div>
</div>
</div><div class="jp-Cell jp-CodeCell jp-Notebook-cell">
<div class="jp-Cell-inputWrapper">
<div class="jp-Collapser jp-InputCollapser jp-Cell-inputCollapser">
</div>
<div class="jp-InputArea jp-Cell-inputArea">
<div class="jp-InputPrompt jp-InputArea-prompt">In&#160;[22]:</div>
<div class="jp-CodeMirrorEditor jp-Editor jp-InputArea-editor">
     <div class="CodeMirror cm-s-jupyter">
<div class="highlight hl-ipython3"><pre><span></span><span class="c1"># q5b</span>
<span class="n">all_cash</span> <span class="o">=</span> <span class="p">{</span>
    <span class="s1">&#39;ibm&#39;</span><span class="p">:</span><span class="n">make_array</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">),</span>
    <span class="s1">&#39;mac&#39;</span><span class="p">:</span><span class="n">make_array</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">)</span>
<span class="p">}</span>

<span class="n">status_or_q5b</span><span class="p">,</span> <span class="n">variables_df_q5b</span><span class="p">,</span> <span class="n">constraints_df_q5b</span><span class="p">,</span> <span class="n">var_dict_q5b</span> <span class="o">=</span> <span class="n">AOS</span><span class="p">(</span><span class="n">collect_rate</span><span class="o">=</span><span class="n">all_cash</span><span class="p">)</span>
<span class="n">df_q5b</span><span class="o">=</span><span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">var_dict_q5b</span><span class="p">,</span> <span class="n">index</span> <span class="o">=</span> <span class="n">id_lbl</span><span class="p">)[</span><span class="mi">3</span><span class="p">:]</span>
<span class="n">df_q5b</span><span class="o">-</span><span class="n">df_original</span>
</pre></div>

     </div>
</div>
</div>
</div>

<div class="jp-Cell-outputWrapper">
<div class="jp-Collapser jp-OutputCollapser jp-Cell-outputCollapser">
</div>


<div class="jp-OutputArea jp-Cell-outputArea">

<div class="jp-OutputArea-child">

    
    <div class="jp-OutputPrompt jp-OutputArea-prompt"></div>


<div class="jp-RenderedText jp-OutputArea-output">
<pre>Gurobi Optimizer version 11.0.0 build v11.0.0rc2 (win64 - Windows 11+.0 (22631.2))

CPU model: AMD Ryzen 7 6800HS with Radeon Graphics, instruction set [SSE2|AVX|AVX2]
Thread count: 8 physical cores, 16 logical processors, using up to 16 threads

Optimize a model with 92 rows, 84 columns and 201 nonzeros
Model fingerprint: 0xf898537e
Coefficient statistics:
  Matrix range     [1e-01, 2e+02]
  Objective range  [1e-02, 1e+00]
  Bounds range     [0e+00, 0e+00]
  RHS range        [1e+03, 6e+05]
Presolve removed 57 rows and 50 columns
Presolve time: 0.01s
Presolved: 35 rows, 34 columns, 119 nonzeros

Iteration    Objective       Primal Inf.    Dual Inf.      Time
       0    3.8400000e+30   5.075000e+29   3.840000e+00      0s
      19    1.0797019e+07   0.000000e+00   0.000000e+00      0s

Solved in 19 iterations and 0.01 seconds (0.00 work units)
Optimal objective  1.079701934e+07

Optimal Values for Decision Variables:
The objective value achieved in profit: 10797019.34 dollars
</pre>
</div>
</div>

<div class="jp-OutputArea-child">

    
    <div class="jp-OutputPrompt jp-OutputArea-prompt">Out[22]:</div>



<div class="jp-RenderedHTMLCommon jp-RenderedHTML jp-OutputArea-output jp-OutputArea-executeResult">
<div>

<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>ADV</th>
      <th>ADV_IBM</th>
      <th>ADV_MAC</th>
      <th>IBM</th>
      <th>MAC</th>
      <th>PROD</th>
      <th>SIBM</th>
      <th>SMAC</th>
      <th>INVIBM</th>
      <th>INVMAC</th>
      <th>INVEST</th>
      <th>REV</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>1996 Q1</th>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>1.489250e+06</td>
      <td>1489250.0</td>
    </tr>
    <tr>
      <th>1996 Q2</th>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>1.294339e+06</td>
      <td>-217250.0</td>
    </tr>
    <tr>
      <th>1996 Q3</th>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>1.324054e+06</td>
      <td>10300.0</td>
    </tr>
    <tr>
      <th>1996 Q4</th>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>1.485815e+06</td>
      <td>141900.0</td>
    </tr>
  </tbody>
</table>
</div>
</div>

</div>

</div>

</div>

</div>
<div class="jp-Cell jp-MarkdownCell jp-Notebook-cell">
<div class="jp-Cell-inputWrapper">
<div class="jp-Collapser jp-InputCollapser jp-Cell-inputCollapser">
</div>
<div class="jp-InputArea jp-Cell-inputArea"><div class="jp-InputPrompt jp-InputArea-prompt">
</div><div class="jp-RenderedHTMLCommon jp-RenderedMarkdown jp-MarkdownOutput">
<h3>d. Change in Advertisement Effectiveness<a rel="noopener" class="anchor-link" href="#d.-Change-in-Advertisement-Effectiveness">&#182;</a></h3>
</div>
</div>
</div>
</div>
<div class="jp-Cell jp-MarkdownCell jp-Notebook-cell">
<div class="jp-Cell-inputWrapper">
<div class="jp-Collapser jp-InputCollapser jp-Cell-inputCollapser">
</div>
<div class="jp-InputArea jp-Cell-inputArea"><div class="jp-InputPrompt jp-InputArea-prompt">
</div><div class="jp-RenderedHTMLCommon jp-RenderedMarkdown jp-MarkdownOutput">
<p><strong>1. Significant Change in Advertising Effectiveness (100)</strong></p>
<p>Change in advertising effect from 10 to 100 has huge impacts on the original solution. The new profit significantly shrinks from 9311204.7 to 3563775.34. As advertisement becomes more costly, the profit margin for selling beyond the predicted demand drops siginifcantly. Consequently, the numbers of IBM and Macintosh adapters sold across the quarters significantly decrease.</p>

</div>
</div>
</div>
</div><div class="jp-Cell jp-CodeCell jp-Notebook-cell">
<div class="jp-Cell-inputWrapper">
<div class="jp-Collapser jp-InputCollapser jp-Cell-inputCollapser">
</div>
<div class="jp-InputArea jp-Cell-inputArea">
<div class="jp-InputPrompt jp-InputArea-prompt">In&#160;[23]:</div>
<div class="jp-CodeMirrorEditor jp-Editor jp-InputArea-editor">
     <div class="CodeMirror cm-s-jupyter">
<div class="highlight hl-ipython3"><pre><span></span><span class="n">status_q6a</span><span class="p">,</span> <span class="n">variables_q6a_df</span><span class="p">,</span> <span class="n">constraints_q6a_df</span><span class="p">,</span> <span class="n">var_dict_q6a</span> <span class="o">=</span> <span class="n">AOS</span><span class="p">(</span><span class="n">adv_eff</span><span class="o">=</span><span class="mi">100</span><span class="p">)</span>
<span class="n">df_q6a</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">var_dict_q6a</span><span class="p">,</span> <span class="n">index</span> <span class="o">=</span> <span class="n">id_lbl</span><span class="p">)[</span><span class="mi">3</span><span class="p">:]</span>
<span class="n">df_q6a</span><span class="o">-</span><span class="n">df_original</span>
</pre></div>

     </div>
</div>
</div>
</div>

<div class="jp-Cell-outputWrapper">
<div class="jp-Collapser jp-OutputCollapser jp-Cell-outputCollapser">
</div>


<div class="jp-OutputArea jp-Cell-outputArea">

<div class="jp-OutputArea-child">

    
    <div class="jp-OutputPrompt jp-OutputArea-prompt"></div>


<div class="jp-RenderedText jp-OutputArea-output">
<pre>Gurobi Optimizer version 11.0.0 build v11.0.0rc2 (win64 - Windows 11+.0 (22631.2))

CPU model: AMD Ryzen 7 6800HS with Radeon Graphics, instruction set [SSE2|AVX|AVX2]
Thread count: 8 physical cores, 16 logical processors, using up to 16 threads

Optimize a model with 92 rows, 84 columns and 225 nonzeros
Model fingerprint: 0x05d376c1
Coefficient statistics:
  Matrix range     [1e-02, 2e+02]
  Objective range  [1e-02, 1e+00]
  Bounds range     [0e+00, 0e+00]
  RHS range        [1e+03, 6e+05]
Presolve removed 57 rows and 50 columns
Presolve time: 0.00s
Presolved: 35 rows, 34 columns, 131 nonzeros

Iteration    Objective       Primal Inf.    Dual Inf.      Time
       0    1.9200000e+30   5.075000e+29   1.920000e+00      0s
      28    3.5637753e+06   0.000000e+00   0.000000e+00      0s

Solved in 28 iterations and 0.01 seconds (0.00 work units)
Optimal objective  3.563775342e+06

Optimal Values for Decision Variables:
The objective value achieved in profit: 3563775.34 dollars
</pre>
</div>
</div>

<div class="jp-OutputArea-child">

    
    <div class="jp-OutputPrompt jp-OutputArea-prompt">Out[23]:</div>



<div class="jp-RenderedHTMLCommon jp-RenderedHTML jp-OutputArea-output jp-OutputArea-executeResult">
<div>

<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>ADV</th>
      <th>ADV_IBM</th>
      <th>ADV_MAC</th>
      <th>IBM</th>
      <th>MAC</th>
      <th>PROD</th>
      <th>SIBM</th>
      <th>SMAC</th>
      <th>INVIBM</th>
      <th>INVMAC</th>
      <th>INVEST</th>
      <th>REV</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>1996 Q1</th>
      <td>-230000.0</td>
      <td>-226000.0</td>
      <td>-4000.0</td>
      <td>-16600.0</td>
      <td>-7200.0</td>
      <td>-2452000.0</td>
      <td>-22600.0</td>
      <td>-9400.0</td>
      <td>6000.0</td>
      <td>2200.0</td>
      <td>-1.796670e+06</td>
      <td>-4470250.0</td>
    </tr>
    <tr>
      <th>1996 Q2</th>
      <td>-168000.0</td>
      <td>-116000.0</td>
      <td>-52000.0</td>
      <td>-13550.0</td>
      <td>-6090.0</td>
      <td>-2024900.0</td>
      <td>-11600.0</td>
      <td>-5200.0</td>
      <td>4050.0</td>
      <td>1310.0</td>
      <td>-2.988511e+06</td>
      <td>-3352300.0</td>
    </tr>
    <tr>
      <th>1996 Q3</th>
      <td>-156000.0</td>
      <td>-106000.0</td>
      <td>-50000.0</td>
      <td>-11525.0</td>
      <td>-5435.0</td>
      <td>-1750350.0</td>
      <td>-10600.0</td>
      <td>-5000.0</td>
      <td>3125.0</td>
      <td>875.0</td>
      <td>-4.055376e+06</td>
      <td>-2924300.0</td>
    </tr>
    <tr>
      <th>1996 Q4</th>
      <td>157100.0</td>
      <td>-115200.0</td>
      <td>272300.0</td>
      <td>-7322.5</td>
      <td>-3120.0</td>
      <td>-1075450.0</td>
      <td>-11520.0</td>
      <td>-2245.0</td>
      <td>7322.5</td>
      <td>0.0</td>
      <td>-5.747429e+06</td>
      <td>-2542250.0</td>
    </tr>
  </tbody>
</table>
</div>
</div>

</div>

</div>

</div>

</div>
<div class="jp-Cell jp-MarkdownCell jp-Notebook-cell">
<div class="jp-Cell-inputWrapper">
<div class="jp-Collapser jp-InputCollapser jp-Cell-inputCollapser">
</div>
<div class="jp-InputArea jp-Cell-inputArea"><div class="jp-InputPrompt jp-InputArea-prompt">
</div><div class="jp-RenderedHTMLCommon jp-RenderedMarkdown jp-MarkdownOutput">
<p>The below bar graph displays the proportion of sales resulted from advertisement of the total sales in the original solution. It is evident that sales volume from advertisement constitutes a significant portion of the total sales. This dependency is even more apparent in the sales of Mac adapters. Therefore, an unprecedented decrease in advertisement effectiveness, as expected, upends the central managerial decisions completely as it directly destablized the foundations of AOS&#39; revenue generation.</p>

</div>
</div>
</div>
</div><div class="jp-Cell jp-CodeCell jp-Notebook-cell">
<div class="jp-Cell-inputWrapper">
<div class="jp-Collapser jp-InputCollapser jp-Cell-inputCollapser">
</div>
<div class="jp-InputArea jp-Cell-inputArea">
<div class="jp-InputPrompt jp-InputArea-prompt">In&#160;[24]:</div>
<div class="jp-CodeMirrorEditor jp-Editor jp-InputArea-editor">
     <div class="CodeMirror cm-s-jupyter">
<div class="highlight hl-ipython3"><pre><span></span><span class="c1"># demand comparison tbl</span>
<span class="n">df_q6</span><span class="o">=</span><span class="n">df_q6a</span><span class="p">[[</span><span class="s1">&#39;SIBM&#39;</span><span class="p">,</span><span class="s1">&#39;SMAC&#39;</span><span class="p">]]</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>
<span class="n">df_q6</span><span class="p">[</span><span class="s1">&#39;IBM&#39;</span><span class="p">]</span><span class="o">=</span><span class="n">ibm</span><span class="p">[</span><span class="mi">3</span><span class="p">:]</span>
<span class="n">df_q6</span><span class="p">[</span><span class="s1">&#39;Mac&#39;</span><span class="p">]</span><span class="o">=</span><span class="n">mac</span><span class="p">[</span><span class="mi">3</span><span class="p">:]</span>
<span class="n">df_q6</span><span class="p">[</span><span class="s1">&#39;Rev&#39;</span><span class="p">]</span><span class="o">=</span><span class="p">(</span><span class="n">df_q6a</span><span class="o">-</span><span class="n">df_original</span><span class="p">)[</span><span class="s1">&#39;REV&#39;</span><span class="p">]</span>

<span class="c1"># sales proportion bar chaer</span>
<span class="n">fig</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">()</span>
<span class="n">positions_ibm</span> <span class="o">=</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">((</span><span class="n">df_q6</span><span class="p">[</span><span class="s1">&#39;Mac&#39;</span><span class="p">]</span><span class="o">/</span><span class="n">df_original</span><span class="p">[</span><span class="s1">&#39;SMAC&#39;</span><span class="p">])</span><span class="o">.</span><span class="n">index</span><span class="p">))</span>
<span class="n">positions_mac</span> <span class="o">=</span> <span class="p">[</span><span class="n">pos</span> <span class="o">+</span> <span class="mf">0.35</span> <span class="k">for</span> <span class="n">pos</span> <span class="ow">in</span> <span class="n">positions_ibm</span><span class="p">]</span>

<span class="n">bar1</span> <span class="o">=</span> <span class="n">ax</span><span class="o">.</span><span class="n">bar</span><span class="p">(</span><span class="n">positions_ibm</span><span class="p">,</span> <span class="mi">1</span><span class="o">-</span><span class="n">df_q6</span><span class="p">[</span><span class="s1">&#39;IBM&#39;</span><span class="p">]</span><span class="o">/</span><span class="n">df_original</span><span class="p">[</span><span class="s1">&#39;SIBM&#39;</span><span class="p">],</span><span class="n">width</span><span class="o">=</span><span class="mf">0.35</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;IBM&#39;</span><span class="p">)</span>
<span class="n">bar2</span> <span class="o">=</span> <span class="n">ax</span><span class="o">.</span><span class="n">bar</span><span class="p">(</span><span class="n">positions_mac</span><span class="p">,</span> <span class="mi">1</span><span class="o">-</span><span class="n">df_q6</span><span class="p">[</span><span class="s1">&#39;Mac&#39;</span><span class="p">]</span><span class="o">/</span><span class="n">df_original</span><span class="p">[</span><span class="s1">&#39;SMAC&#39;</span><span class="p">],</span><span class="n">width</span><span class="o">=</span><span class="mf">0.35</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;Mac&#39;</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s1">&#39;Percentage%&#39;</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s1">&#39;Proportion of Sales From Advertisement&#39;</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_xticks</span><span class="p">(</span><span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">((</span><span class="n">df_q6</span><span class="p">[</span><span class="s1">&#39;Mac&#39;</span><span class="p">]</span><span class="o">/</span><span class="n">df_original</span><span class="p">[</span><span class="s1">&#39;SMAC&#39;</span><span class="p">])</span><span class="o">.</span><span class="n">index</span><span class="p">)))</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_xticklabels</span><span class="p">((</span><span class="n">df_q6</span><span class="p">[</span><span class="s1">&#39;Mac&#39;</span><span class="p">]</span><span class="o">/</span><span class="n">df_original</span><span class="p">[</span><span class="s1">&#39;SMAC&#39;</span><span class="p">])</span><span class="o">.</span><span class="n">index</span><span class="p">)</span>

<span class="k">for</span> <span class="n">bar</span> <span class="ow">in</span> <span class="n">bar1</span> <span class="o">+</span> <span class="n">bar2</span><span class="p">:</span>
    <span class="n">height</span> <span class="o">=</span> <span class="n">bar</span><span class="o">.</span><span class="n">get_height</span><span class="p">()</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">annotate</span><span class="p">(</span><span class="s1">&#39;</span><span class="si">{}</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="nb">round</span><span class="p">(</span><span class="n">height</span><span class="p">,</span> <span class="mi">2</span><span class="p">)),</span>
                <span class="n">xy</span><span class="o">=</span><span class="p">(</span><span class="n">bar</span><span class="o">.</span><span class="n">get_x</span><span class="p">()</span> <span class="o">+</span> <span class="n">bar</span><span class="o">.</span><span class="n">get_width</span><span class="p">()</span> <span class="o">/</span> <span class="mi">2</span><span class="p">,</span> <span class="n">height</span><span class="p">),</span>
                <span class="n">xytext</span><span class="o">=</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">),</span>
                <span class="n">textcoords</span><span class="o">=</span><span class="s2">&quot;offset points&quot;</span><span class="p">,</span>
                <span class="n">ha</span><span class="o">=</span><span class="s1">&#39;center&#39;</span><span class="p">,</span> <span class="n">va</span><span class="o">=</span><span class="s1">&#39;bottom&#39;</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">legend</span><span class="p">()</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>

     </div>
</div>
</div>
</div>

<div class="jp-Cell-outputWrapper">
<div class="jp-Collapser jp-OutputCollapser jp-Cell-outputCollapser">
</div>


<div class="jp-OutputArea jp-Cell-outputArea">

<div class="jp-OutputArea-child">

    
    <div class="jp-OutputPrompt jp-OutputArea-prompt"></div>




<div class="jp-RenderedImage jp-OutputArea-output">
<img src="javascript://"/>
</div>

</div>

</div>

</div>

</div>
<div class="jp-Cell jp-MarkdownCell jp-Notebook-cell">
<div class="jp-Cell-inputWrapper">
<div class="jp-Collapser jp-InputCollapser jp-Cell-inputCollapser">
</div>
<div class="jp-InputArea jp-Cell-inputArea"><div class="jp-InputPrompt jp-InputArea-prompt">
</div><div class="jp-RenderedHTMLCommon jp-RenderedMarkdown jp-MarkdownOutput">
<p>The comparison table below presents that the actual sales determined by the model are almost in line with the demand forecasts. As selling beyond predicted demands becomes too costly, the model adjusts accordingly and reduces advertisement spending throughout the year by 48.14%. This change triggers a spontaneous drop in production levels and builds up in inventories. In the original solution, by the rule of thumb, production level was pushed to the ceiling to satisfy the safety cushion. The decrease in production level, as illustrated in the table below, forces the AOS to stock more items in order to continue meeting this requirement.</p>

</div>
</div>
</div>
</div><div class="jp-Cell jp-CodeCell jp-Notebook-cell">
<div class="jp-Cell-inputWrapper">
<div class="jp-Collapser jp-InputCollapser jp-Cell-inputCollapser">
</div>
<div class="jp-InputArea jp-Cell-inputArea">
<div class="jp-InputPrompt jp-InputArea-prompt">In&#160;[25]:</div>
<div class="jp-CodeMirrorEditor jp-Editor jp-InputArea-editor">
     <div class="CodeMirror cm-s-jupyter">
<div class="highlight hl-ipython3"><pre><span></span><span class="c1"># tbl for sales and forecast</span>
<span class="n">display</span><span class="p">(</span><span class="n">df_q6</span><span class="p">)</span>
<span class="n">display</span><span class="p">((</span><span class="n">df_q6a</span><span class="o">-</span><span class="n">df_original</span><span class="p">)[[</span><span class="s1">&#39;PROD&#39;</span><span class="p">,</span><span class="s1">&#39;INVIBM&#39;</span><span class="p">,</span><span class="s1">&#39;INVMAC&#39;</span><span class="p">]])</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;%Change in advertisement throughout the year:&#39;</span><span class="p">,</span><span class="nb">sum</span><span class="p">((</span><span class="n">df_q6a</span><span class="o">-</span><span class="n">df_original</span><span class="p">)[</span><span class="s1">&#39;ADV&#39;</span><span class="p">])</span><span class="o">/</span><span class="nb">sum</span><span class="p">(</span><span class="n">df_original</span><span class="p">[</span><span class="s1">&#39;ADV&#39;</span><span class="p">]))</span>
</pre></div>

     </div>
</div>
</div>
</div>

<div class="jp-Cell-outputWrapper">
<div class="jp-Collapser jp-OutputCollapser jp-Cell-outputCollapser">
</div>


<div class="jp-OutputArea jp-Cell-outputArea">

<div class="jp-OutputArea-child">

    
    <div class="jp-OutputPrompt jp-OutputArea-prompt"></div>



<div class="jp-RenderedHTMLCommon jp-RenderedHTML jp-OutputArea-output">
<div>

<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>SIBM</th>
      <th>SMAC</th>
      <th>IBM</th>
      <th>Mac</th>
      <th>Rev</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>1996 Q1</th>
      <td>9000.0</td>
      <td>2800.0</td>
      <td>9000</td>
      <td>1800</td>
      <td>-4470250.0</td>
    </tr>
    <tr>
      <th>1996 Q2</th>
      <td>10000.0</td>
      <td>2000.0</td>
      <td>10000</td>
      <td>2000</td>
      <td>-3352300.0</td>
    </tr>
    <tr>
      <th>1996 Q3</th>
      <td>11000.0</td>
      <td>2200.0</td>
      <td>11000</td>
      <td>2200</td>
      <td>-2924300.0</td>
    </tr>
    <tr>
      <th>1996 Q4</th>
      <td>12000.0</td>
      <td>5675.0</td>
      <td>12000</td>
      <td>2400</td>
      <td>-2542250.0</td>
    </tr>
  </tbody>
</table>
</div>
</div>

</div>

<div class="jp-OutputArea-child">

    
    <div class="jp-OutputPrompt jp-OutputArea-prompt"></div>



<div class="jp-RenderedHTMLCommon jp-RenderedHTML jp-OutputArea-output">
<div>

<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>PROD</th>
      <th>INVIBM</th>
      <th>INVMAC</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>1996 Q1</th>
      <td>-2452000.0</td>
      <td>6000.0</td>
      <td>2200.0</td>
    </tr>
    <tr>
      <th>1996 Q2</th>
      <td>-2024900.0</td>
      <td>4050.0</td>
      <td>1310.0</td>
    </tr>
    <tr>
      <th>1996 Q3</th>
      <td>-1750350.0</td>
      <td>3125.0</td>
      <td>875.0</td>
    </tr>
    <tr>
      <th>1996 Q4</th>
      <td>-1075450.0</td>
      <td>7322.5</td>
      <td>0.0</td>
    </tr>
  </tbody>
</table>
</div>
</div>

</div>

<div class="jp-OutputArea-child">

    
    <div class="jp-OutputPrompt jp-OutputArea-prompt"></div>


<div class="jp-RenderedText jp-OutputArea-output">
<pre>%Change in advertisement throughout the year: -0.4814410480349345
</pre>
</div>
</div>

</div>

</div>

</div>
<div class="jp-Cell jp-MarkdownCell jp-Notebook-cell">
<div class="jp-Cell-inputWrapper">
<div class="jp-Collapser jp-InputCollapser jp-Cell-inputCollapser">
</div>
<div class="jp-InputArea jp-Cell-inputArea"><div class="jp-InputPrompt jp-InputArea-prompt">
</div><div class="jp-RenderedHTMLCommon jp-RenderedMarkdown jp-MarkdownOutput">
<p>This pattern prevails in the decision for both product lines with an exception in Quarter 4. Surprisingly, the model chooses to allocate even more funds to boost the sales of Mac adapters to the extent that results in a positive change in Q4&#39;s total advertisement cost. As discussed earlier, the sales of Mac adpaters depends significantly on the additional customers acquired by the advertisement effect. The original prediction for the demand of Mac adapters is much lower than that of IBM&#39;s. This could be attributed to its relatively high pricing and a potentially limited customer base. However, with the assumption that advertisement works in the same degree for both adapters, advertisement efforts towards Mac adapters are, in general, more profitable than to be directed towards IBM adapters. Consequently, when AOS faces a slump in all perspectives with a sudden decrease in advertisement effectiveness, boosting sales for Mac adapters emerges as one of the few possible salvation plans. By strategically allocating resources to ramp up advertising for Mac adapters, AOS can capitalize on the potential for increased sales and profitability within this niche market segment, offering a pathway to mitigate the challenges posed by the broader downturn in advertising effectiveness.</p>

</div>
</div>
</div>
</div><div class="jp-Cell jp-CodeCell jp-Notebook-cell">
<div class="jp-Cell-inputWrapper">
<div class="jp-Collapser jp-InputCollapser jp-Cell-inputCollapser">
</div>
<div class="jp-InputArea jp-Cell-inputArea">
<div class="jp-InputPrompt jp-InputArea-prompt">In&#160;[26]:</div>
<div class="jp-CodeMirrorEditor jp-Editor jp-InputArea-editor">
     <div class="CodeMirror cm-s-jupyter">
<div class="highlight hl-ipython3"><pre><span></span><span class="n">display</span><span class="p">((</span><span class="n">df_q6a</span><span class="o">-</span><span class="n">df_original</span><span class="p">)[[</span><span class="s1">&#39;ADV&#39;</span><span class="p">,</span><span class="s1">&#39;ADV_IBM&#39;</span><span class="p">,</span><span class="s1">&#39;ADV_MAC&#39;</span><span class="p">]])</span>
</pre></div>

     </div>
</div>
</div>
</div>

<div class="jp-Cell-outputWrapper">
<div class="jp-Collapser jp-OutputCollapser jp-Cell-outputCollapser">
</div>


<div class="jp-OutputArea jp-Cell-outputArea">

<div class="jp-OutputArea-child">

    
    <div class="jp-OutputPrompt jp-OutputArea-prompt"></div>



<div class="jp-RenderedHTMLCommon jp-RenderedHTML jp-OutputArea-output">
<div>

<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>ADV</th>
      <th>ADV_IBM</th>
      <th>ADV_MAC</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>1996 Q1</th>
      <td>-230000.0</td>
      <td>-226000.0</td>
      <td>-4000.0</td>
    </tr>
    <tr>
      <th>1996 Q2</th>
      <td>-168000.0</td>
      <td>-116000.0</td>
      <td>-52000.0</td>
    </tr>
    <tr>
      <th>1996 Q3</th>
      <td>-156000.0</td>
      <td>-106000.0</td>
      <td>-50000.0</td>
    </tr>
    <tr>
      <th>1996 Q4</th>
      <td>157100.0</td>
      <td>-115200.0</td>
      <td>272300.0</td>
    </tr>
  </tbody>
</table>
</div>
</div>

</div>

</div>

</div>

</div>
<div class="jp-Cell jp-MarkdownCell jp-Notebook-cell">
<div class="jp-Cell-inputWrapper">
<div class="jp-Collapser jp-InputCollapser jp-Cell-inputCollapser">
</div>
<div class="jp-InputArea jp-Cell-inputArea"><div class="jp-InputPrompt jp-InputArea-prompt">
</div><div class="jp-RenderedHTMLCommon jp-RenderedMarkdown jp-MarkdownOutput">
<p><strong>2. Slight Change in Advertising Effectiveness (12.50)</strong></p>
<p>This change does not have much impact on the original solution. Particularly, AOS’s profit slightly declines slightly from 9311204.7 to 9099481.78. The money allocated to advertising increases as its cost increases. In the meantime, the money allocated to production and number of adapters sold remain unchanged throughout the year. Excess money allocated to short-term government securities across the quarters declines as the cost for the per unit sales beyond the predicted demand rises while the same number of sales were made.</p>

</div>
</div>
</div>
</div><div class="jp-Cell jp-CodeCell jp-Notebook-cell">
<div class="jp-Cell-inputWrapper">
<div class="jp-Collapser jp-InputCollapser jp-Cell-inputCollapser">
</div>
<div class="jp-InputArea jp-Cell-inputArea">
<div class="jp-InputPrompt jp-InputArea-prompt">In&#160;[27]:</div>
<div class="jp-CodeMirrorEditor jp-Editor jp-InputArea-editor">
     <div class="CodeMirror cm-s-jupyter">
<div class="highlight hl-ipython3"><pre><span></span><span class="n">status_q6b</span><span class="p">,</span> <span class="n">variables_q6b_df</span><span class="p">,</span> <span class="n">constraints_q6b_df</span><span class="p">,</span> <span class="n">var_dict_q6b</span> <span class="o">=</span> <span class="n">AOS</span><span class="p">(</span><span class="n">adv_eff</span><span class="o">=</span><span class="mf">12.5</span><span class="p">)</span>
<span class="n">df_q6b</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">var_dict_q6b</span><span class="p">,</span> <span class="n">index</span> <span class="o">=</span> <span class="n">id_lbl</span><span class="p">)[</span><span class="mi">3</span><span class="p">:]</span>
<span class="n">df_q6b</span><span class="o">-</span><span class="n">df_original</span>
</pre></div>

     </div>
</div>
</div>
</div>

<div class="jp-Cell-outputWrapper">
<div class="jp-Collapser jp-OutputCollapser jp-Cell-outputCollapser">
</div>


<div class="jp-OutputArea jp-Cell-outputArea">

<div class="jp-OutputArea-child">

    
    <div class="jp-OutputPrompt jp-OutputArea-prompt"></div>


<div class="jp-RenderedText jp-OutputArea-output">
<pre>Gurobi Optimizer version 11.0.0 build v11.0.0rc2 (win64 - Windows 11+.0 (22631.2))

CPU model: AMD Ryzen 7 6800HS with Radeon Graphics, instruction set [SSE2|AVX|AVX2]
Thread count: 8 physical cores, 16 logical processors, using up to 16 threads

Optimize a model with 92 rows, 84 columns and 225 nonzeros
Model fingerprint: 0xec822a52
Coefficient statistics:
  Matrix range     [8e-02, 2e+02]
  Objective range  [1e-02, 1e+00]
  Bounds range     [0e+00, 0e+00]
  RHS range        [1e+03, 6e+05]
Presolve removed 57 rows and 50 columns
Presolve time: 0.00s
Presolved: 35 rows, 34 columns, 131 nonzeros

Iteration    Objective       Primal Inf.    Dual Inf.      Time
       0    3.8400000e+30   5.075000e+29   3.840000e+00      0s
      19    9.0994818e+06   0.000000e+00   0.000000e+00      0s

Solved in 19 iterations and 0.01 seconds (0.00 work units)
Optimal objective  9.099481785e+06

Optimal Values for Decision Variables:
The objective value achieved in profit: 9099481.78 dollars
</pre>
</div>
</div>

<div class="jp-OutputArea-child">

    
    <div class="jp-OutputPrompt jp-OutputArea-prompt">Out[27]:</div>



<div class="jp-RenderedHTMLCommon jp-RenderedHTML jp-OutputArea-output jp-OutputArea-executeResult">
<div>

<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>ADV</th>
      <th>ADV_IBM</th>
      <th>ADV_MAC</th>
      <th>IBM</th>
      <th>MAC</th>
      <th>PROD</th>
      <th>SIBM</th>
      <th>SMAC</th>
      <th>INVIBM</th>
      <th>INVMAC</th>
      <th>INVEST</th>
      <th>REV</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>1996 Q1</th>
      <td>82500.0</td>
      <td>56500.0</td>
      <td>26000.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>-82500.000000</td>
      <td>0.0</td>
    </tr>
    <tr>
      <th>1996 Q2</th>
      <td>42000.0</td>
      <td>29000.0</td>
      <td>13000.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>-125737.500000</td>
      <td>0.0</td>
    </tr>
    <tr>
      <th>1996 Q3</th>
      <td>39000.0</td>
      <td>26500.0</td>
      <td>12500.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>-166623.562500</td>
      <td>0.0</td>
    </tr>
    <tr>
      <th>1996 Q4</th>
      <td>42600.0</td>
      <td>28800.0</td>
      <td>13800.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>-211722.915938</td>
      <td>0.0</td>
    </tr>
  </tbody>
</table>
</div>
</div>

</div>

</div>

</div>

</div>
<div class="jp-Cell jp-MarkdownCell jp-Notebook-cell">
<div class="jp-Cell-inputWrapper">
<div class="jp-Collapser jp-InputCollapser jp-Cell-inputCollapser">
</div>
<div class="jp-InputArea jp-Cell-inputArea"><div class="jp-InputPrompt jp-InputArea-prompt">
</div><div class="jp-RenderedHTMLCommon jp-RenderedMarkdown jp-MarkdownOutput">
<p><strong>Conclusion</strong></p>
<p>Advertising effectiveness is a key factor in optimizing the objective of AOS. As the advertising cost highly goes up, core managerial decisions regarding advertising, production, revenue and short-term securities are affected. The solution of decision variables are negatively correlated to the advertising cost, indicating the model is very sensitive to major changes in advertising cost. However, on the contray, if the change does not absorb all of the profit margins that advertisement can bring to the firm, the model remains resilient. Therefore, a sounding estimation of advertisement effectiveness is crucial for AOS to accomplish its plan. Otherwise, the production plan will become obsolete, and AOS will be incur a huge loss in profit as in the first scenario.</p>

</div>
</div>
</div>
</div>
<div class="jp-Cell jp-MarkdownCell jp-Notebook-cell">
<div class="jp-Cell-inputWrapper">
<div class="jp-Collapser jp-InputCollapser jp-Cell-inputCollapser">
</div>
<div class="jp-InputArea jp-Cell-inputArea"><div class="jp-InputPrompt jp-InputArea-prompt">
</div><div class="jp-RenderedHTMLCommon jp-RenderedMarkdown jp-MarkdownOutput">
<h3>e. Uncertainty with Credit Line<a rel="noopener" class="anchor-link" href="#e.-Uncertainty-with-Credit-Line">&#182;</a></h3>
</div>
</div>
</div>
</div>
<div class="jp-Cell jp-MarkdownCell jp-Notebook-cell">
<div class="jp-Cell-inputWrapper">
<div class="jp-Collapser jp-InputCollapser jp-Cell-inputCollapser">
</div>
<div class="jp-InputArea jp-Cell-inputArea"><div class="jp-InputPrompt jp-InputArea-prompt">
</div><div class="jp-RenderedHTMLCommon jp-RenderedMarkdown jp-MarkdownOutput">
<p>As mentioned in the introduction, poor financial situation of the company may impede it from obtaining the inital credit line for opening operations. An alternative would be to one for the same amount from a small local bank but subjecting to a much higher interest rate of 24%. However, contrary to one may expect, the results are not in particular troublesome.</p>
<p>Higher interest rate on the line of credit directly influences the cost of borrowing for AOS since the companies have to bear a higher interest pay-off throughout the year. Under this circumstance, the elevated interest rate reduces the available cash flow for reinvestment. Despite this change, all the other production and advertisement decisions remain unchanged.</p>
<p>Nevertheless, even if a 9% increase in the interest rate does not have a dramatic impact on AOS, the reduction in profits is undeniable. In other words, the financial situation of the AOS could be significantly altered if the rate is subjecting to a more noticeable change. With less excess funds at hand, AOS becomes more vulnerable to unexpected shocks in the market (i.e. market crash). All in all, addressing the higher interest rate challenge requires a multifaceted strategy that goes beyond seeking additional credit lines. For instance, AOS can better position itself by having a more diversified productlines to enhance its revenue generation ability. Investing in new market opportunities and product innovation can provide the necessary leverage to enhance profitability and ensure long-term financial stability, which is a possible path for future planning.</p>

</div>
</div>
</div>
</div><div class="jp-Cell jp-CodeCell jp-Notebook-cell">
<div class="jp-Cell-inputWrapper">
<div class="jp-Collapser jp-InputCollapser jp-Cell-inputCollapser">
</div>
<div class="jp-InputArea jp-Cell-inputArea">
<div class="jp-InputPrompt jp-InputArea-prompt">In&#160;[28]:</div>
<div class="jp-CodeMirrorEditor jp-Editor jp-InputArea-editor">
     <div class="CodeMirror cm-s-jupyter">
<div class="highlight hl-ipython3"><pre><span></span><span class="n">status_q7</span><span class="p">,</span> <span class="n">variables_q7_df</span><span class="p">,</span> <span class="n">constraints_q7_df</span><span class="p">,</span> <span class="n">var_dict_q7</span> <span class="o">=</span> <span class="n">AOS</span><span class="p">(</span><span class="n">rate_loan</span><span class="o">=</span><span class="mf">0.24</span><span class="p">)</span>
<span class="n">df_q7</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">var_dict_q7</span><span class="p">,</span> <span class="n">index</span> <span class="o">=</span> <span class="n">id_lbl</span><span class="p">)[</span><span class="mi">3</span><span class="p">:]</span>
<span class="n">df_q7</span><span class="o">-</span><span class="n">df_original</span>
</pre></div>

     </div>
</div>
</div>
</div>

<div class="jp-Cell-outputWrapper">
<div class="jp-Collapser jp-OutputCollapser jp-Cell-outputCollapser">
</div>


<div class="jp-OutputArea jp-Cell-outputArea">

<div class="jp-OutputArea-child">

    
    <div class="jp-OutputPrompt jp-OutputArea-prompt"></div>


<div class="jp-RenderedText jp-OutputArea-output">
<pre>Gurobi Optimizer version 11.0.0 build v11.0.0rc2 (win64 - Windows 11+.0 (22631.2))

CPU model: AMD Ryzen 7 6800HS with Radeon Graphics, instruction set [SSE2|AVX|AVX2]
Thread count: 8 physical cores, 16 logical processors, using up to 16 threads

Optimize a model with 92 rows, 84 columns and 225 nonzeros
Model fingerprint: 0x9aa5fe4c
Coefficient statistics:
  Matrix range     [1e-01, 2e+02]
  Objective range  [1e-02, 1e+00]
  Bounds range     [0e+00, 0e+00]
  RHS range        [1e+03, 6e+05]
Presolve removed 57 rows and 50 columns
Presolve time: 0.00s
Presolved: 35 rows, 34 columns, 131 nonzeros

Iteration    Objective       Primal Inf.    Dual Inf.      Time
       0    3.8400000e+30   5.075000e+29   3.840000e+00      0s
      19    9.2421707e+06   0.000000e+00   0.000000e+00      0s

Solved in 19 iterations and 0.01 seconds (0.00 work units)
Optimal objective  9.242170706e+06

Optimal Values for Decision Variables:
The objective value achieved in profit: 9242170.71 dollars
</pre>
</div>
</div>

<div class="jp-OutputArea-child">

    
    <div class="jp-OutputPrompt jp-OutputArea-prompt">Out[28]:</div>



<div class="jp-RenderedHTMLCommon jp-RenderedHTML jp-OutputArea-output jp-OutputArea-executeResult">
<div>

<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>ADV</th>
      <th>ADV_IBM</th>
      <th>ADV_MAC</th>
      <th>IBM</th>
      <th>MAC</th>
      <th>PROD</th>
      <th>SIBM</th>
      <th>SMAC</th>
      <th>INVIBM</th>
      <th>INVMAC</th>
      <th>INVEST</th>
      <th>REV</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>1996 Q1</th>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>-16875.000000</td>
      <td>0.0</td>
    </tr>
    <tr>
      <th>1996 Q2</th>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>-34003.125000</td>
      <td>0.0</td>
    </tr>
    <tr>
      <th>1996 Q3</th>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>-51388.171875</td>
      <td>0.0</td>
    </tr>
    <tr>
      <th>1996 Q4</th>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>-69033.994453</td>
      <td>0.0</td>
    </tr>
  </tbody>
</table>
</div>
</div>

</div>

</div>

</div>

</div>
<div class="jp-Cell jp-MarkdownCell jp-Notebook-cell">
<div class="jp-Cell-inputWrapper">
<div class="jp-Collapser jp-InputCollapser jp-Cell-inputCollapser">
</div>
<div class="jp-InputArea jp-Cell-inputArea"><div class="jp-InputPrompt jp-InputArea-prompt">
</div><div class="jp-RenderedHTMLCommon jp-RenderedMarkdown jp-MarkdownOutput">
<h3>f. Revision in Safety Cushion<a rel="noopener" class="anchor-link" href="#f.-Revision-in-Safety-Cushion">&#182;</a></h3><p>The purpose of having an inventory cushion is to provide a safety net against unexpected fluctuations in demand, supply chain disruptions, or production delays. By maintaining an inventory buffer, a company can fulfill customer orders promptly, avoid stockouts, and prevent potential loss of sales due to inventory shortages. While a raise in this threshold may imply stability, a larger inventory cushion may result in increased carrying costs and additional fund allocated to production to meet the quotas, reducing the availability of funds for other investments or operational needs. With this picture in mind, the following analysis will investigate whether the model&#39;s behavior adhere to this general rule of thumb.</p>

</div>
</div>
</div>
</div>
<div class="jp-Cell jp-MarkdownCell jp-Notebook-cell">
<div class="jp-Cell-inputWrapper">
<div class="jp-Collapser jp-InputCollapser jp-Cell-inputCollapser">
</div>
<div class="jp-InputArea jp-Cell-inputArea"><div class="jp-InputPrompt jp-InputArea-prompt">
</div><div class="jp-RenderedHTMLCommon jp-RenderedMarkdown jp-MarkdownOutput">
<p><strong>1. A Safety Cushion Raise to 15%</strong></p>
<p>As this change is well within the allowable increase threshold of the sensitivity table below, shadow prices can be directly used to analyze the possible impacts on the solution. Shadow prices of zero implies that the adjustment of the safety cushion to 15% does not impact AOS&#39;s operational or financial decisions at all. This is because the production decisions, as determined by the optimization model, already pushed production to its maximum capacity, far exceeding the requirements set by both the original and the adjusted safety cushions. Therefore, the increase to 15% does not necessitate a change in production quantities or financial allocations. This indicates that the production strategy is robust against minor fluctuations in inventory safety levels, focusing on maximizing revenue generation while minimizing excess inventory costs. In short, this highered threshold is not significant.</p>

</div>
</div>
</div>
</div><div class="jp-Cell jp-CodeCell jp-Notebook-cell">
<div class="jp-Cell-inputWrapper">
<div class="jp-Collapser jp-InputCollapser jp-Cell-inputCollapser">
</div>
<div class="jp-InputArea jp-Cell-inputArea">
<div class="jp-InputPrompt jp-InputArea-prompt">In&#160;[29]:</div>
<div class="jp-CodeMirrorEditor jp-Editor jp-InputArea-editor">
     <div class="CodeMirror cm-s-jupyter">
<div class="highlight hl-ipython3"><pre><span></span><span class="n">display</span><span class="p">(</span><span class="n">constraints_df</span><span class="p">[</span><span class="n">constraints_df</span><span class="p">[</span><span class="s1">&#39;Constraint&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">str</span><span class="o">.</span><span class="n">contains</span><span class="p">(</span><span class="s1">&#39;prod&#39;</span><span class="p">)][:</span><span class="mi">5</span><span class="p">])</span>
<span class="c1"># display for change</span>
<span class="n">display</span><span class="p">(</span><span class="n">demand</span><span class="o">.</span><span class="n">select</span><span class="p">(</span><span class="s1">&#39;IBM&#39;</span><span class="p">,</span><span class="s1">&#39;Mac&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">to_df</span><span class="p">()[</span><span class="mi">3</span><span class="p">:]</span><span class="o">*</span><span class="mf">0.15</span><span class="p">)</span>
</pre></div>

     </div>
</div>
</div>
</div>

<div class="jp-Cell-outputWrapper">
<div class="jp-Collapser jp-OutputCollapser jp-Cell-outputCollapser">
</div>


<div class="jp-OutputArea jp-Cell-outputArea">

<div class="jp-OutputArea-child">

    
    <div class="jp-OutputPrompt jp-OutputArea-prompt"></div>



<div class="jp-RenderedHTMLCommon jp-RenderedHTML jp-OutputArea-output">
<div>

<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Constraint</th>
      <th>Shadow Price</th>
      <th>Allowable Increase (RHS)</th>
      <th>Allowable Decrease (RHS)</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>76</th>
      <td>prod_IBM 1996 Q1</td>
      <td>0.0</td>
      <td>21600.0</td>
      <td>-inf</td>
    </tr>
    <tr>
      <th>77</th>
      <td>prod_Mac 1996 Q1</td>
      <td>0.0</td>
      <td>7200.0</td>
      <td>-inf</td>
    </tr>
    <tr>
      <th>78</th>
      <td>prod_IBM 1996 Q2</td>
      <td>0.0</td>
      <td>21600.0</td>
      <td>-inf</td>
    </tr>
    <tr>
      <th>79</th>
      <td>prod_Mac 1996 Q2</td>
      <td>0.0</td>
      <td>7200.0</td>
      <td>-inf</td>
    </tr>
    <tr>
      <th>80</th>
      <td>prod_IBM 1996 Q3</td>
      <td>0.0</td>
      <td>21600.0</td>
      <td>-inf</td>
    </tr>
  </tbody>
</table>
</div>
</div>

</div>

<div class="jp-OutputArea-child">

    
    <div class="jp-OutputPrompt jp-OutputArea-prompt"></div>



<div class="jp-RenderedHTMLCommon jp-RenderedHTML jp-OutputArea-output">
<div>

<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>IBM</th>
      <th>Mac</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>3</th>
      <td>1350.0</td>
      <td>270.0</td>
    </tr>
    <tr>
      <th>4</th>
      <td>1500.0</td>
      <td>300.0</td>
    </tr>
    <tr>
      <th>5</th>
      <td>1650.0</td>
      <td>330.0</td>
    </tr>
    <tr>
      <th>6</th>
      <td>1800.0</td>
      <td>360.0</td>
    </tr>
  </tbody>
</table>
</div>
</div>

</div>

</div>

</div>

</div>
<div class="jp-Cell jp-MarkdownCell jp-Notebook-cell">
<div class="jp-Cell-inputWrapper">
<div class="jp-Collapser jp-InputCollapser jp-Cell-inputCollapser">
</div>
<div class="jp-InputArea jp-Cell-inputArea"><div class="jp-InputPrompt jp-InputArea-prompt">
</div><div class="jp-RenderedHTMLCommon jp-RenderedMarkdown jp-MarkdownOutput">
<p><strong>2.A Safety Cushion Raise to 20%</strong></p>
<p>Based on the tables listed below, shadow prices are still valid for analysis. Although the inventory cushion doubled for the new solution, the optimal solution is not affected because the constraints for safety cushion were not binded under the original condition. The initial production plan puts the factory operating at its highest level, exceeding the buffer or safety margin by a large amount. Therefore, the impact on AOS is not siginifant.</p>
<p>However, it is unwise to turn a blind eye at the impacts of increasing of safety cushions. If a change in inventory cushion is accompanied by a change in production capacity and advertisement effectivess, the overall impact on AOS will be devastating.</p>

</div>
</div>
</div>
</div><div class="jp-Cell jp-CodeCell jp-Notebook-cell">
<div class="jp-Cell-inputWrapper">
<div class="jp-Collapser jp-InputCollapser jp-Cell-inputCollapser">
</div>
<div class="jp-InputArea jp-Cell-inputArea">
<div class="jp-InputPrompt jp-InputArea-prompt">In&#160;[30]:</div>
<div class="jp-CodeMirrorEditor jp-Editor jp-InputArea-editor">
     <div class="CodeMirror cm-s-jupyter">
<div class="highlight hl-ipython3"><pre><span></span><span class="n">display</span><span class="p">(</span><span class="n">constraints_df</span><span class="p">[</span><span class="n">constraints_df</span><span class="p">[</span><span class="s1">&#39;Constraint&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">str</span><span class="o">.</span><span class="n">contains</span><span class="p">(</span><span class="s1">&#39;prod&#39;</span><span class="p">)][:</span><span class="mi">5</span><span class="p">])</span>
<span class="c1"># display for change</span>
<span class="n">display</span><span class="p">(</span><span class="n">demand</span><span class="o">.</span><span class="n">select</span><span class="p">(</span><span class="s1">&#39;IBM&#39;</span><span class="p">,</span><span class="s1">&#39;Mac&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">to_df</span><span class="p">()[</span><span class="mi">3</span><span class="p">:]</span><span class="o">*</span><span class="mf">0.2</span><span class="p">)</span>
</pre></div>

     </div>
</div>
</div>
</div>

<div class="jp-Cell-outputWrapper">
<div class="jp-Collapser jp-OutputCollapser jp-Cell-outputCollapser">
</div>


<div class="jp-OutputArea jp-Cell-outputArea">

<div class="jp-OutputArea-child">

    
    <div class="jp-OutputPrompt jp-OutputArea-prompt"></div>



<div class="jp-RenderedHTMLCommon jp-RenderedHTML jp-OutputArea-output">
<div>

<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Constraint</th>
      <th>Shadow Price</th>
      <th>Allowable Increase (RHS)</th>
      <th>Allowable Decrease (RHS)</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>76</th>
      <td>prod_IBM 1996 Q1</td>
      <td>0.0</td>
      <td>21600.0</td>
      <td>-inf</td>
    </tr>
    <tr>
      <th>77</th>
      <td>prod_Mac 1996 Q1</td>
      <td>0.0</td>
      <td>7200.0</td>
      <td>-inf</td>
    </tr>
    <tr>
      <th>78</th>
      <td>prod_IBM 1996 Q2</td>
      <td>0.0</td>
      <td>21600.0</td>
      <td>-inf</td>
    </tr>
    <tr>
      <th>79</th>
      <td>prod_Mac 1996 Q2</td>
      <td>0.0</td>
      <td>7200.0</td>
      <td>-inf</td>
    </tr>
    <tr>
      <th>80</th>
      <td>prod_IBM 1996 Q3</td>
      <td>0.0</td>
      <td>21600.0</td>
      <td>-inf</td>
    </tr>
  </tbody>
</table>
</div>
</div>

</div>

<div class="jp-OutputArea-child">

    
    <div class="jp-OutputPrompt jp-OutputArea-prompt"></div>



<div class="jp-RenderedHTMLCommon jp-RenderedHTML jp-OutputArea-output">
<div>

<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>IBM</th>
      <th>Mac</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>3</th>
      <td>1800.0</td>
      <td>360.0</td>
    </tr>
    <tr>
      <th>4</th>
      <td>2000.0</td>
      <td>400.0</td>
    </tr>
    <tr>
      <th>5</th>
      <td>2200.0</td>
      <td>440.0</td>
    </tr>
    <tr>
      <th>6</th>
      <td>2400.0</td>
      <td>480.0</td>
    </tr>
  </tbody>
</table>
</div>
</div>

</div>

</div>

</div>

</div>
<div class="jp-Cell jp-MarkdownCell jp-Notebook-cell">
<div class="jp-Cell-inputWrapper">
<div class="jp-Collapser jp-InputCollapser jp-Cell-inputCollapser">
</div>
<div class="jp-InputArea jp-Cell-inputArea"><div class="jp-InputPrompt jp-InputArea-prompt">
</div><div class="jp-RenderedHTMLCommon jp-RenderedMarkdown jp-MarkdownOutput">
<p><strong>Conclusion</strong></p>
<p>Implications that are decoupled from quantitative results as shown above, the pros and cons of a higher inventory cushion is listed as follows:</p>
<ul>
<li>PROS:</li>
</ul>
<p>Enhanced Service Level: By raising the safety stock, AOS greatly lowers the chance of running out of items, helping it fulfill customer orders more dependably. This boost in reliability can maintain customer loyalty, which is vital in a competitive environment.</p>
<p>Risk Mitigation: A larger safety stock serves as a protective barrier against problems with getting supplies or sudden increases in demand. During periods when suppliers are unreliable or market conditions change quickly, this can shield AOS from major operational and financial troubles.</p>
<ul>
<li>CONS:</li>
</ul>
<p>Increased Holding Cost: Keeping more inventory means AOS faces higher expenses for storage, insurance, and the risk of products becoming outdated, which can reduce the company&#39;s profit margins. The company must assess if the benefits of improved service justify these extra costs.</p>
<p>Capital Allocation: The money spent on additional inventory could have been used for other purposes, like investing in new opportunities or paying off debt. AOS needs to think about the opportunity cost of having a larger safety stock.</p>
<p>In summary, AOS may revisit its inventory strategy to balance the advantages of a safety stock against its costs. While increase in safety cushion alone may not have any impacts in the short term, it is essential for AOS to remain flexible, keeping an eye on market changes and adapting its inventory accordingly.</p>

</div>
</div>
</div>
</div>
<div class="jp-Cell jp-MarkdownCell jp-Notebook-cell">
<div class="jp-Cell-inputWrapper">
<div class="jp-Collapser jp-InputCollapser jp-Cell-inputCollapser">
</div>
<div class="jp-InputArea jp-Cell-inputArea"><div class="jp-InputPrompt jp-InputArea-prompt">
</div><div class="jp-RenderedHTMLCommon jp-RenderedMarkdown jp-MarkdownOutput">
<h3>g. Unfortuante Crash in Production Capacity<a rel="noopener" class="anchor-link" href="#g.-Unfortuante-Crash-in-Production-Capacity">&#182;</a></h3>
</div>
</div>
</div>
</div>
<div class="jp-Cell jp-MarkdownCell jp-Notebook-cell">
<div class="jp-Cell-inputWrapper">
<div class="jp-Collapser jp-InputCollapser jp-Cell-inputCollapser">
</div>
<div class="jp-InputArea jp-Cell-inputArea"><div class="jp-InputPrompt jp-InputArea-prompt">
</div><div class="jp-RenderedHTMLCommon jp-RenderedMarkdown jp-MarkdownOutput">
<p><strong>1. Delay in Renovation</strong></p>
<p>A delay in renovation plan will decrease the production capacity in Q4 by 2160 and 720 for IBM and Mac, respectively (0.1⋅[30,10]⋅12⋅20⋅3). This is within the allowable change of the shadow prices. Therefore, this change is expected decrease the achieved profit of the objective function by 338760(720⋅40+143.5⋅2160). The resulting achived profit shrinks to 8972444.7 due to the impacts on sales in the fourth quarter. The production plan is focred to reduce as ceilings of production capacity is pushed down. The new model also shows the reduction in money for advertisement compared to the original solution. This happens because AOS does not have the capacity to supply for the additional sales yielded by advertising. This model optimizes revenue by increasing inventory for safety stock as the company experiences a loss in the number of adapters produced.</p>

</div>
</div>
</div>
</div><div class="jp-Cell jp-CodeCell jp-Notebook-cell">
<div class="jp-Cell-inputWrapper">
<div class="jp-Collapser jp-InputCollapser jp-Cell-inputCollapser">
</div>
<div class="jp-InputArea jp-Cell-inputArea">
<div class="jp-InputPrompt jp-InputArea-prompt">In&#160;[31]:</div>
<div class="jp-CodeMirrorEditor jp-Editor jp-InputArea-editor">
     <div class="CodeMirror cm-s-jupyter">
<div class="highlight hl-ipython3"><pre><span></span><span class="n">constraints_df</span><span class="p">[</span><span class="n">constraints_df</span><span class="p">[</span><span class="s1">&#39;Constraint&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">str</span><span class="o">.</span><span class="n">contains</span><span class="p">(</span><span class="s1">&#39;capacity&#39;</span><span class="p">)][</span><span class="mi">6</span><span class="p">:]</span>
</pre></div>

     </div>
</div>
</div>
</div>

<div class="jp-Cell-outputWrapper">
<div class="jp-Collapser jp-OutputCollapser jp-Cell-outputCollapser">
</div>


<div class="jp-OutputArea jp-Cell-outputArea">

<div class="jp-OutputArea-child">

    
    <div class="jp-OutputPrompt jp-OutputArea-prompt">Out[31]:</div>



<div class="jp-RenderedHTMLCommon jp-RenderedHTML jp-OutputArea-output jp-OutputArea-executeResult">
<div>

<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Constraint</th>
      <th>Shadow Price</th>
      <th>Allowable Increase (RHS)</th>
      <th>Allowable Decrease (RHS)</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>90</th>
      <td>capacity_IBM 1996 Q4</td>
      <td>143.5</td>
      <td>24000.0</td>
      <td>18000.0</td>
    </tr>
    <tr>
      <th>91</th>
      <td>capacity_Mac 1996 Q4</td>
      <td>40.0</td>
      <td>inf</td>
      <td>4800.0</td>
    </tr>
  </tbody>
</table>
</div>
</div>

</div>

</div>

</div>

</div><div class="jp-Cell jp-CodeCell jp-Notebook-cell">
<div class="jp-Cell-inputWrapper">
<div class="jp-Collapser jp-InputCollapser jp-Cell-inputCollapser">
</div>
<div class="jp-InputArea jp-Cell-inputArea">
<div class="jp-InputPrompt jp-InputArea-prompt">In&#160;[32]:</div>
<div class="jp-CodeMirrorEditor jp-Editor jp-InputArea-editor">
     <div class="CodeMirror cm-s-jupyter">
<div class="highlight hl-ipython3"><pre><span></span><span class="n">status_q9a</span><span class="p">,</span> <span class="n">variables_q9a_df</span><span class="p">,</span> <span class="n">constraints_q9a_df</span><span class="p">,</span> <span class="n">var_dict_q9a</span> <span class="o">=</span> <span class="n">AOS</span><span class="p">(</span><span class="n">prodCap_Q4</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
<span class="n">df_q9a</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">var_dict_q9a</span><span class="p">,</span> <span class="n">index</span> <span class="o">=</span> <span class="n">id_lbl</span><span class="p">)[</span><span class="mi">3</span><span class="p">:]</span>
<span class="n">df_q9a</span><span class="o">-</span><span class="n">df_original</span>
</pre></div>

     </div>
</div>
</div>
</div>

<div class="jp-Cell-outputWrapper">
<div class="jp-Collapser jp-OutputCollapser jp-Cell-outputCollapser">
</div>


<div class="jp-OutputArea jp-Cell-outputArea">

<div class="jp-OutputArea-child">

    
    <div class="jp-OutputPrompt jp-OutputArea-prompt"></div>


<div class="jp-RenderedText jp-OutputArea-output">
<pre>Gurobi Optimizer version 11.0.0 build v11.0.0rc2 (win64 - Windows 11+.0 (22631.2))

CPU model: AMD Ryzen 7 6800HS with Radeon Graphics, instruction set [SSE2|AVX|AVX2]
Thread count: 8 physical cores, 16 logical processors, using up to 16 threads

Optimize a model with 92 rows, 84 columns and 225 nonzeros
Model fingerprint: 0x2402ee64
Coefficient statistics:
  Matrix range     [1e-01, 2e+02]
  Objective range  [1e-02, 1e+00]
  Bounds range     [0e+00, 0e+00]
  RHS range        [1e+03, 6e+05]
Presolve removed 57 rows and 50 columns
Presolve time: 0.00s
Presolved: 35 rows, 34 columns, 131 nonzeros

Iteration    Objective       Primal Inf.    Dual Inf.      Time
       0    3.8400000e+30   5.075000e+29   3.840000e+00      0s
      19    8.9724447e+06   0.000000e+00   0.000000e+00      0s

Solved in 19 iterations and 0.00 seconds (0.00 work units)
Optimal objective  8.972444701e+06

Optimal Values for Decision Variables:
The objective value achieved in profit: 8972444.7 dollars
</pre>
</div>
</div>

<div class="jp-OutputArea-child">

    
    <div class="jp-OutputPrompt jp-OutputArea-prompt">Out[32]:</div>



<div class="jp-RenderedHTMLCommon jp-RenderedHTML jp-OutputArea-output jp-OutputArea-executeResult">
<div>

<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>ADV</th>
      <th>ADV_IBM</th>
      <th>ADV_MAC</th>
      <th>IBM</th>
      <th>MAC</th>
      <th>PROD</th>
      <th>SIBM</th>
      <th>SMAC</th>
      <th>INVIBM</th>
      <th>INVMAC</th>
      <th>INVEST</th>
      <th>REV</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>1996 Q1</th>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
    </tr>
    <tr>
      <th>1996 Q2</th>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
    </tr>
    <tr>
      <th>1996 Q3</th>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
    </tr>
    <tr>
      <th>1996 Q4</th>
      <td>-50400.0</td>
      <td>-43200.0</td>
      <td>-7200.0</td>
      <td>-2160.0</td>
      <td>-720.0</td>
      <td>-295200.0</td>
      <td>-4320.0</td>
      <td>-720.0</td>
      <td>2160.0</td>
      <td>0.0</td>
      <td>-338760.0</td>
      <td>-682200.0</td>
    </tr>
  </tbody>
</table>
</div>
</div>

</div>

</div>

</div>

</div>
<div class="jp-Cell jp-MarkdownCell jp-Notebook-cell">
<div class="jp-Cell-inputWrapper">
<div class="jp-Collapser jp-InputCollapser jp-Cell-inputCollapser">
</div>
<div class="jp-InputArea jp-Cell-inputArea"><div class="jp-InputPrompt jp-InputArea-prompt">
</div><div class="jp-RenderedHTMLCommon jp-RenderedMarkdown jp-MarkdownOutput">
<p><strong>2. Production Capacity drops by 10%</strong></p>
<p>The capacity rate decreases by 10% in the fourth quarter, leading to a decrease of 4320 and 1440 for IBM&#39;s and Mac&#39;s production capacity, respectively. Seeing that the magnitude of change is still contained by the sensitivity table below, it is still valid to use the shadow prices to make implications.</p>
<p>The decreasing production capacity in the fourth quarter results in the profit decline from 9311204.7 to 8633684.7, a total reduction of 677520 (1440⋅40+143.5⋅4320). Indeed, the last quarter of 1996 is very important for AOS to reach its objective, as demand in this quarter is the highest across all quarters. Greater potentials also imply greater variability, so a minor drop in production capacity results in relatively huge drop in sales and revenues. Consequently, the allocation of money on advertising and production also decreases. The model aims to optimize AOS&#39; profit by boosting sales in the fourth quarter, but limited production capacity restrains that from happening.</p>

</div>
</div>
</div>
</div><div class="jp-Cell jp-CodeCell jp-Notebook-cell">
<div class="jp-Cell-inputWrapper">
<div class="jp-Collapser jp-InputCollapser jp-Cell-inputCollapser">
</div>
<div class="jp-InputArea jp-Cell-inputArea">
<div class="jp-InputPrompt jp-InputArea-prompt">In&#160;[33]:</div>
<div class="jp-CodeMirrorEditor jp-Editor jp-InputArea-editor">
     <div class="CodeMirror cm-s-jupyter">
<div class="highlight hl-ipython3"><pre><span></span><span class="n">constraints_df</span><span class="p">[</span><span class="n">constraints_df</span><span class="p">[</span><span class="s1">&#39;Constraint&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">str</span><span class="o">.</span><span class="n">contains</span><span class="p">(</span><span class="s1">&#39;capacity&#39;</span><span class="p">)][</span><span class="mi">6</span><span class="p">:]</span>
</pre></div>

     </div>
</div>
</div>
</div>

<div class="jp-Cell-outputWrapper">
<div class="jp-Collapser jp-OutputCollapser jp-Cell-outputCollapser">
</div>


<div class="jp-OutputArea jp-Cell-outputArea">

<div class="jp-OutputArea-child">

    
    <div class="jp-OutputPrompt jp-OutputArea-prompt">Out[33]:</div>



<div class="jp-RenderedHTMLCommon jp-RenderedHTML jp-OutputArea-output jp-OutputArea-executeResult">
<div>

<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Constraint</th>
      <th>Shadow Price</th>
      <th>Allowable Increase (RHS)</th>
      <th>Allowable Decrease (RHS)</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>90</th>
      <td>capacity_IBM 1996 Q4</td>
      <td>143.5</td>
      <td>24000.0</td>
      <td>18000.0</td>
    </tr>
    <tr>
      <th>91</th>
      <td>capacity_Mac 1996 Q4</td>
      <td>40.0</td>
      <td>inf</td>
      <td>4800.0</td>
    </tr>
  </tbody>
</table>
</div>
</div>

</div>

</div>

</div>

</div><div class="jp-Cell jp-CodeCell jp-Notebook-cell">
<div class="jp-Cell-inputWrapper">
<div class="jp-Collapser jp-InputCollapser jp-Cell-inputCollapser">
</div>
<div class="jp-InputArea jp-Cell-inputArea">
<div class="jp-InputPrompt jp-InputArea-prompt">In&#160;[34]:</div>
<div class="jp-CodeMirrorEditor jp-Editor jp-InputArea-editor">
     <div class="CodeMirror cm-s-jupyter">
<div class="highlight hl-ipython3"><pre><span></span><span class="n">status_q9b</span><span class="p">,</span> <span class="n">variables_q9b_df</span><span class="p">,</span> <span class="n">constraints_q9b_df</span><span class="p">,</span> <span class="n">var_dict_q9b</span> <span class="o">=</span> <span class="n">AOS</span><span class="p">(</span><span class="n">prodCap_Q4</span><span class="o">=-</span><span class="mf">0.1</span><span class="p">)</span>
<span class="n">df_q9b</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">var_dict_q9b</span><span class="p">,</span> <span class="n">index</span> <span class="o">=</span> <span class="n">id_lbl</span><span class="p">)[</span><span class="mi">3</span><span class="p">:]</span>
<span class="n">df_q9b</span><span class="o">-</span><span class="n">df_original</span>
</pre></div>

     </div>
</div>
</div>
</div>

<div class="jp-Cell-outputWrapper">
<div class="jp-Collapser jp-OutputCollapser jp-Cell-outputCollapser">
</div>


<div class="jp-OutputArea jp-Cell-outputArea">

<div class="jp-OutputArea-child">

    
    <div class="jp-OutputPrompt jp-OutputArea-prompt"></div>


<div class="jp-RenderedText jp-OutputArea-output">
<pre>Gurobi Optimizer version 11.0.0 build v11.0.0rc2 (win64 - Windows 11+.0 (22631.2))

CPU model: AMD Ryzen 7 6800HS with Radeon Graphics, instruction set [SSE2|AVX|AVX2]
Thread count: 8 physical cores, 16 logical processors, using up to 16 threads

Optimize a model with 92 rows, 84 columns and 225 nonzeros
Model fingerprint: 0x0b30f65b
Coefficient statistics:
  Matrix range     [1e-01, 2e+02]
  Objective range  [1e-02, 1e+00]
  Bounds range     [0e+00, 0e+00]
  RHS range        [1e+03, 6e+05]
Presolve removed 57 rows and 50 columns
Presolve time: 0.00s
Presolved: 35 rows, 34 columns, 131 nonzeros

Iteration    Objective       Primal Inf.    Dual Inf.      Time
       0    3.8400000e+30   5.075000e+29   3.840000e+00      0s
      18    8.6336847e+06   0.000000e+00   0.000000e+00      0s

Solved in 18 iterations and 0.01 seconds (0.00 work units)
Optimal objective  8.633684701e+06

Optimal Values for Decision Variables:
The objective value achieved in profit: 8633684.7 dollars
</pre>
</div>
</div>

<div class="jp-OutputArea-child">

    
    <div class="jp-OutputPrompt jp-OutputArea-prompt">Out[34]:</div>



<div class="jp-RenderedHTMLCommon jp-RenderedHTML jp-OutputArea-output jp-OutputArea-executeResult">
<div>

<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>ADV</th>
      <th>ADV_IBM</th>
      <th>ADV_MAC</th>
      <th>IBM</th>
      <th>MAC</th>
      <th>PROD</th>
      <th>SIBM</th>
      <th>SMAC</th>
      <th>INVIBM</th>
      <th>INVMAC</th>
      <th>INVEST</th>
      <th>REV</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>1996 Q1</th>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
    </tr>
    <tr>
      <th>1996 Q2</th>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
    </tr>
    <tr>
      <th>1996 Q3</th>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
    </tr>
    <tr>
      <th>1996 Q4</th>
      <td>-100800.0</td>
      <td>-86400.0</td>
      <td>-14400.0</td>
      <td>-4320.0</td>
      <td>-1440.0</td>
      <td>-590400.0</td>
      <td>-8640.0</td>
      <td>-1440.0</td>
      <td>4320.0</td>
      <td>0.0</td>
      <td>-677520.0</td>
      <td>-1364400.0</td>
    </tr>
  </tbody>
</table>
</div>
</div>

</div>

</div>

</div>

</div>
<div class="jp-Cell jp-MarkdownCell jp-Notebook-cell">
<div class="jp-Cell-inputWrapper">
<div class="jp-Collapser jp-InputCollapser jp-Cell-inputCollapser">
</div>
<div class="jp-InputArea jp-Cell-inputArea"><div class="jp-InputPrompt jp-InputArea-prompt">
</div><div class="jp-RenderedHTMLCommon jp-RenderedMarkdown jp-MarkdownOutput">
<p><strong>Conclusion</strong></p>
<p>In overall, revenues are positively correlated to change in capacity rate change. Throughout all scenarios, the production capacity constraints remain binded. Inevitably, a change in the RHS will impact the profit achieved by the objective function. In both scenarios, sales dropped suddenly in the fourth quarter. Thus, two scenarios show the model is not resilient to minor changes in production capacity. Luckily, the reduction in production capacity is assumed to only happen in Q4, which explains why the numbers in the first three quarters of the year remain unaffected. In other words, if AOS experiences a drastic supply shock that has a long-lasting reduction on the capacity of the factory across all quarters, the model will not produce sanguine results.</p>

</div>
</div>
</div>
</div><div class="jp-Cell jp-CodeCell jp-Notebook-cell">
<div class="jp-Cell-inputWrapper">
<div class="jp-Collapser jp-InputCollapser jp-Cell-inputCollapser">
</div>
<div class="jp-InputArea jp-Cell-inputArea">
<div class="jp-InputPrompt jp-InputArea-prompt">In&#160;[35]:</div>
<div class="jp-CodeMirrorEditor jp-Editor jp-InputArea-editor">
     <div class="CodeMirror cm-s-jupyter">
<div class="highlight hl-ipython3"><pre><span></span><span class="c1"># line chart </span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">df_q9a</span><span class="p">[</span><span class="s1">&#39;SIBM&#39;</span><span class="p">]</span><span class="o">+</span><span class="n">df_q9a</span><span class="p">[</span><span class="s1">&#39;SMAC&#39;</span><span class="p">],</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;S1(0%)&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">df_q9b</span><span class="p">[</span><span class="s1">&#39;SIBM&#39;</span><span class="p">]</span><span class="o">+</span><span class="n">df_q9b</span><span class="p">[</span><span class="s1">&#39;SMAC&#39;</span><span class="p">],</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;S2(-10%)&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">df_original</span><span class="p">[</span><span class="s1">&#39;SIBM&#39;</span><span class="p">]</span><span class="o">+</span><span class="n">df_original</span><span class="p">[</span><span class="s1">&#39;SMAC&#39;</span><span class="p">],</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;Original&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">legend</span><span class="p">()</span> 
<span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s1">&#39;Sales Data&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s1">&#39;Sales&#39;</span><span class="p">)</span> 
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>

     </div>
</div>
</div>
</div>

<div class="jp-Cell-outputWrapper">
<div class="jp-Collapser jp-OutputCollapser jp-Cell-outputCollapser">
</div>


<div class="jp-OutputArea jp-Cell-outputArea">

<div class="jp-OutputArea-child">

    
    <div class="jp-OutputPrompt jp-OutputArea-prompt"></div>




<div class="jp-RenderedImage jp-OutputArea-output">
<img src="javascript://"/>
</div>

</div>

</div>

</div>

</div>
<div class="jp-Cell jp-MarkdownCell jp-Notebook-cell">
<div class="jp-Cell-inputWrapper">
<div class="jp-Collapser jp-InputCollapser jp-Cell-inputCollapser">
</div>
<div class="jp-InputArea jp-Cell-inputArea"><div class="jp-InputPrompt jp-InputArea-prompt">
</div><div class="jp-RenderedHTMLCommon jp-RenderedMarkdown jp-MarkdownOutput">
<h3>h. Forcast Erros in Maximum Estimated Demand<a rel="noopener" class="anchor-link" href="#h.-Forcast-Erros-in-Maximum-Estimated-Demand">&#182;</a></h3><p>Regardless of the problem at hand, demand forcasting remains to be one of the fundamental steps for model building. Inaccurate demand forcasts can add undersirable noise to the model that ultimately obscure the accuracy and reliability of the optimized solution. However, whether to refine the forcast is still a managerial question in essence. Provided with the concerns about Lu&#39;s 1996 maximum expected sales forecasts, the company should hire an the marketing company if and only if the impact on the total profit from the refined numbers can outweigh the cost of doing so. From the description, Lu&#39;s prediction can be off by 1,000 for IBM adapters and 200 for Macintosh adapters each quarter. Since range is well within the allowable change range of the constraint table, the shadow prices are valid to use. From the constraint table in which only the demand constraint is extracted, the total expected impact on 1996&#39;s profit is approximately 49090.84, computed from the sum of the products between the shadow prices and their respective change, which is lower than 50,000, the cost for conducting a more detailed report. Therefore, even if the new forcast will bring an additional demand of 1,000 IBM and 200 Mac adapters, the incremental change in profit is lower than the cost of the report itself, making the effort unremunerative. In short, she should not hire the marketing research firm.</p>

</div>
</div>
</div>
</div><div class="jp-Cell jp-CodeCell jp-Notebook-cell">
<div class="jp-Cell-inputWrapper">
<div class="jp-Collapser jp-InputCollapser jp-Cell-inputCollapser">
</div>
<div class="jp-InputArea jp-Cell-inputArea">
<div class="jp-InputPrompt jp-InputArea-prompt">In&#160;[36]:</div>
<div class="jp-CodeMirrorEditor jp-Editor jp-InputArea-editor">
     <div class="CodeMirror cm-s-jupyter">
<div class="highlight hl-ipython3"><pre><span></span><span class="n">constraints_df</span><span class="p">[</span><span class="n">constraints_df</span><span class="p">[</span><span class="s1">&#39;Constraint&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">str</span><span class="o">.</span><span class="n">contains</span><span class="p">(</span><span class="s1">&#39;demand&#39;</span><span class="p">)]</span>
</pre></div>

     </div>
</div>
</div>
</div>

<div class="jp-Cell-outputWrapper">
<div class="jp-Collapser jp-OutputCollapser jp-Cell-outputCollapser">
</div>


<div class="jp-OutputArea jp-Cell-outputArea">

<div class="jp-OutputArea-child">

    
    <div class="jp-OutputPrompt jp-OutputArea-prompt">Out[36]:</div>



<div class="jp-RenderedHTMLCommon jp-RenderedHTML jp-OutputArea-output jp-OutputArea-executeResult">
<div>

<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Constraint</th>
      <th>Shadow Price</th>
      <th>Allowable Increase (RHS)</th>
      <th>Allowable Decrease (RHS)</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>49</th>
      <td>demand_IBM 1996 Q1</td>
      <td>10.456784</td>
      <td>31600.0</td>
      <td>-3.680625e+05</td>
    </tr>
    <tr>
      <th>50</th>
      <td>demand_Mac 1996 Q1</td>
      <td>10.456784</td>
      <td>12200.0</td>
      <td>-3.752625e+05</td>
    </tr>
    <tr>
      <th>51</th>
      <td>demand_IBM 1996 Q2</td>
      <td>10.302250</td>
      <td>21600.0</td>
      <td>-5.866309e+05</td>
    </tr>
    <tr>
      <th>52</th>
      <td>demand_Mac 1996 Q2</td>
      <td>10.302250</td>
      <td>7200.0</td>
      <td>-5.946309e+05</td>
    </tr>
    <tr>
      <th>53</th>
      <td>demand_IBM 1996 Q3</td>
      <td>10.150000</td>
      <td>21600.0</td>
      <td>-7.869379e+05</td>
    </tr>
    <tr>
      <th>54</th>
      <td>demand_Mac 1996 Q3</td>
      <td>10.150000</td>
      <td>7200.0</td>
      <td>-7.957379e+05</td>
    </tr>
    <tr>
      <th>55</th>
      <td>demand_IBM 1996 Q4</td>
      <td>10.000000</td>
      <td>23520.0</td>
      <td>-9.941205e+05</td>
    </tr>
    <tr>
      <th>56</th>
      <td>demand_Mac 1996 Q4</td>
      <td>10.000000</td>
      <td>7920.0</td>
      <td>-1.003720e+06</td>
    </tr>
  </tbody>
</table>
</div>
</div>

</div>

</div>

</div>

</div><div class="jp-Cell jp-CodeCell jp-Notebook-cell">
<div class="jp-Cell-inputWrapper">
<div class="jp-Collapser jp-InputCollapser jp-Cell-inputCollapser">
</div>
<div class="jp-InputArea jp-Cell-inputArea">
<div class="jp-InputPrompt jp-InputArea-prompt">In&#160;[37]:</div>
<div class="jp-CodeMirrorEditor jp-Editor jp-InputArea-editor">
     <div class="CodeMirror cm-s-jupyter">
<div class="highlight hl-ipython3"><pre><span></span><span class="nb">print</span><span class="p">(</span><span class="s1">&#39;The expected change on the objective function is $&#39;</span><span class="p">,</span><span class="nb">sum</span><span class="p">(</span><span class="n">constraints_df</span><span class="p">[</span><span class="n">constraints_df</span><span class="p">[</span><span class="s1">&#39;Constraint&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">str</span><span class="o">.</span><span class="n">contains</span><span class="p">(</span><span class="s1">&#39;demand_IBM&#39;</span><span class="p">)][</span><span class="s1">&#39;Shadow Price&#39;</span><span class="p">]</span><span class="o">*</span><span class="mi">1000</span><span class="p">)</span><span class="o">+</span><span class="nb">sum</span><span class="p">(</span><span class="n">constraints_df</span><span class="p">[</span><span class="n">constraints_df</span><span class="p">[</span><span class="s1">&#39;Constraint&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">str</span><span class="o">.</span><span class="n">contains</span><span class="p">(</span><span class="s1">&#39;demand_Mac&#39;</span><span class="p">)][</span><span class="s1">&#39;Shadow Price&#39;</span><span class="p">]</span><span class="o">*</span><span class="mi">200</span><span class="p">))</span>
</pre></div>

     </div>
</div>
</div>
</div>

<div class="jp-Cell-outputWrapper">
<div class="jp-Collapser jp-OutputCollapser jp-Cell-outputCollapser">
</div>


<div class="jp-OutputArea jp-Cell-outputArea">

<div class="jp-OutputArea-child">

    
    <div class="jp-OutputPrompt jp-OutputArea-prompt"></div>


<div class="jp-RenderedText jp-OutputArea-output">
<pre>The expected change on the objective function is $ 49090.84049999999
</pre>
</div>
</div>

</div>

</div>

</div>
<div class="jp-Cell jp-MarkdownCell jp-Notebook-cell">
<div class="jp-Cell-inputWrapper">
<div class="jp-Collapser jp-InputCollapser jp-Cell-inputCollapser">
</div>
<div class="jp-InputArea jp-Cell-inputArea"><div class="jp-InputPrompt jp-InputArea-prompt">
</div><div class="jp-RenderedHTMLCommon jp-RenderedMarkdown jp-MarkdownOutput">
<h3>i. Need for Additional Loans<a rel="noopener" class="anchor-link" href="#i.-Need-for-Additional-Loans">&#182;</a></h3><p>The AOS is also considering whether a new credit line of 1 million is needed to boost profits. Intuitively, it is generally believed that an additional credit line can be beneficial to a company. Beyond providing financial flexibility and acting as a safety net during unexpected expenses or economic downturns, it offers capital for seizing growth opportunities without delay. For rising businesses that are struggling to open brand reputations like AOS, an extra credit line helps smooth out cash flow gaps. Moreover, it serves as a vital resource during emergencies, enabling swift responses to unforeseen situations like equipment breakdowns or supply chain disruptions. However, whether this general belief applies to AOS&#39; current standing is questionable. To have a thorough examination of the decision, it is nessecary to investigate its effects on the company&#39;s profit under various scenarios.</p>
<p><strong>1. Ceteris Paribus</strong></p>
<p>Assuming the new credit line shares the same interest cost as the 750,000 and all the other conditions remain unchanged, a new optimization solution was computed. Contrary to the conventional wisdom that more funds generate more profit, the new solution yields an even lower achieved profits (9203474.2) than the original one (9311204.7). The table documenting the change in the optimal solution shows that almost all portions of the additional 1 million are allocated to short-term investments as excess funds while all the other decisions remain static. This is likely due to the fact that the production constaints for all quarters are binded, as provided in the sensitiviy table of the original solution. The initial 750,000 credit line already utilized all of the production capcity to its maximum. Since the quarterly interest on short-term investment is lower than the interest payable (0.06/4 &lt; 0.15/4), the new line of credit is not only incapable of generating profits but is also adding extra burdens on the credit cost. Thus, if all the other conditions remain constant, a reduction in achieved profit is inevitable.</p>

</div>
</div>
</div>
</div><div class="jp-Cell jp-CodeCell jp-Notebook-cell">
<div class="jp-Cell-inputWrapper">
<div class="jp-Collapser jp-InputCollapser jp-Cell-inputCollapser">
</div>
<div class="jp-InputArea jp-Cell-inputArea">
<div class="jp-InputPrompt jp-InputArea-prompt">In&#160;[38]:</div>
<div class="jp-CodeMirrorEditor jp-Editor jp-InputArea-editor">
     <div class="CodeMirror cm-s-jupyter">
<div class="highlight hl-ipython3"><pre><span></span><span class="c1"># solution with the new credit line</span>
<span class="n">status_cre</span><span class="p">,</span> <span class="n">variables_cre_df</span><span class="p">,</span> <span class="n">constraints_cre_df</span><span class="p">,</span> <span class="n">var_dict_cre</span> <span class="o">=</span> <span class="n">AOS</span><span class="p">(</span><span class="n">creditLine</span> <span class="o">=</span> <span class="mi">1750000</span><span class="p">)</span>
</pre></div>

     </div>
</div>
</div>
</div>

<div class="jp-Cell-outputWrapper">
<div class="jp-Collapser jp-OutputCollapser jp-Cell-outputCollapser">
</div>


<div class="jp-OutputArea jp-Cell-outputArea">

<div class="jp-OutputArea-child">

    
    <div class="jp-OutputPrompt jp-OutputArea-prompt"></div>


<div class="jp-RenderedText jp-OutputArea-output">
<pre>Gurobi Optimizer version 11.0.0 build v11.0.0rc2 (win64 - Windows 11+.0 (22631.2))

CPU model: AMD Ryzen 7 6800HS with Radeon Graphics, instruction set [SSE2|AVX|AVX2]
Thread count: 8 physical cores, 16 logical processors, using up to 16 threads

Optimize a model with 92 rows, 84 columns and 225 nonzeros
Model fingerprint: 0x01ba1d54
Coefficient statistics:
  Matrix range     [1e-01, 2e+02]
  Objective range  [1e-02, 1e+00]
  Bounds range     [0e+00, 0e+00]
  RHS range        [1e+03, 2e+06]
Presolve removed 57 rows and 50 columns
Presolve time: 0.00s
Presolved: 35 rows, 34 columns, 131 nonzeros

Iteration    Objective       Primal Inf.    Dual Inf.      Time
       0    3.8400000e+30   5.075000e+29   3.840000e+00      0s
      19    9.2034742e+06   0.000000e+00   0.000000e+00      0s

Solved in 19 iterations and 0.01 seconds (0.00 work units)
Optimal objective  9.203474199e+06

Optimal Values for Decision Variables:
The objective value achieved in profit: 9203474.2 dollars
</pre>
</div>
</div>

</div>

</div>

</div><div class="jp-Cell jp-CodeCell jp-Notebook-cell">
<div class="jp-Cell-inputWrapper">
<div class="jp-Collapser jp-InputCollapser jp-Cell-inputCollapser">
</div>
<div class="jp-InputArea jp-Cell-inputArea">
<div class="jp-InputPrompt jp-InputArea-prompt">In&#160;[39]:</div>
<div class="jp-CodeMirrorEditor jp-Editor jp-InputArea-editor">
     <div class="CodeMirror cm-s-jupyter">
<div class="highlight hl-ipython3"><pre><span></span><span class="n">df_cl</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">var_dict_cre</span><span class="p">,</span> <span class="n">index</span> <span class="o">=</span> <span class="n">id_lbl</span><span class="p">)[</span><span class="mi">3</span><span class="p">:]</span>
<span class="n">df_cl</span><span class="o">-</span><span class="n">df_original</span>
</pre></div>

     </div>
</div>
</div>
</div>

<div class="jp-Cell-outputWrapper">
<div class="jp-Collapser jp-OutputCollapser jp-Cell-outputCollapser">
</div>


<div class="jp-OutputArea jp-Cell-outputArea">

<div class="jp-OutputArea-child">

    
    <div class="jp-OutputPrompt jp-OutputArea-prompt">Out[39]:</div>



<div class="jp-RenderedHTMLCommon jp-RenderedHTML jp-OutputArea-output jp-OutputArea-executeResult">
<div>

<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>ADV</th>
      <th>ADV_IBM</th>
      <th>ADV_MAC</th>
      <th>IBM</th>
      <th>MAC</th>
      <th>PROD</th>
      <th>SIBM</th>
      <th>SMAC</th>
      <th>INVIBM</th>
      <th>INVMAC</th>
      <th>INVEST</th>
      <th>REV</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>1996 Q1</th>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>962500.000000</td>
      <td>0.0</td>
    </tr>
    <tr>
      <th>1996 Q2</th>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>939437.500000</td>
      <td>0.0</td>
    </tr>
    <tr>
      <th>1996 Q3</th>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>916029.062500</td>
      <td>0.0</td>
    </tr>
    <tr>
      <th>1996 Q4</th>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>892269.498438</td>
      <td>0.0</td>
    </tr>
  </tbody>
</table>
</div>
</div>

</div>

</div>

</div>

</div><div class="jp-Cell jp-CodeCell jp-Notebook-cell">
<div class="jp-Cell-inputWrapper">
<div class="jp-Collapser jp-InputCollapser jp-Cell-inputCollapser">
</div>
<div class="jp-InputArea jp-Cell-inputArea">
<div class="jp-InputPrompt jp-InputArea-prompt">In&#160;[40]:</div>
<div class="jp-CodeMirrorEditor jp-Editor jp-InputArea-editor">
     <div class="CodeMirror cm-s-jupyter">
<div class="highlight hl-ipython3"><pre><span></span><span class="n">constraints_df</span><span class="p">[</span><span class="n">constraints_df</span><span class="p">[</span><span class="s1">&#39;Constraint&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">str</span><span class="o">.</span><span class="n">contains</span><span class="p">(</span><span class="s1">&#39;capacity&#39;</span><span class="p">)]</span>
</pre></div>

     </div>
</div>
</div>
</div>

<div class="jp-Cell-outputWrapper">
<div class="jp-Collapser jp-OutputCollapser jp-Cell-outputCollapser">
</div>


<div class="jp-OutputArea jp-Cell-outputArea">

<div class="jp-OutputArea-child">

    
    <div class="jp-OutputPrompt jp-OutputArea-prompt">Out[40]:</div>



<div class="jp-RenderedHTMLCommon jp-RenderedHTML jp-OutputArea-output jp-OutputArea-executeResult">
<div>

<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Constraint</th>
      <th>Shadow Price</th>
      <th>Allowable Increase (RHS)</th>
      <th>Allowable Decrease (RHS)</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>82</th>
      <td>capacity_IBM 1996 Q1</td>
      <td>65.357290</td>
      <td>inf</td>
      <td>11000.0</td>
    </tr>
    <tr>
      <th>83</th>
      <td>capacity_Mac 1996 Q1</td>
      <td>78.642085</td>
      <td>inf</td>
      <td>2200.0</td>
    </tr>
    <tr>
      <th>84</th>
      <td>capacity_IBM 1996 Q2</td>
      <td>62.667281</td>
      <td>inf</td>
      <td>12100.0</td>
    </tr>
    <tr>
      <th>85</th>
      <td>capacity_Mac 1996 Q2</td>
      <td>73.539000</td>
      <td>inf</td>
      <td>2420.0</td>
    </tr>
    <tr>
      <th>86</th>
      <td>capacity_IBM 1996 Q3</td>
      <td>56.568750</td>
      <td>inf</td>
      <td>13200.0</td>
    </tr>
    <tr>
      <th>87</th>
      <td>capacity_Mac 1996 Q3</td>
      <td>62.600000</td>
      <td>inf</td>
      <td>2640.0</td>
    </tr>
    <tr>
      <th>90</th>
      <td>capacity_IBM 1996 Q4</td>
      <td>143.500000</td>
      <td>24000.0</td>
      <td>18000.0</td>
    </tr>
    <tr>
      <th>91</th>
      <td>capacity_Mac 1996 Q4</td>
      <td>40.000000</td>
      <td>inf</td>
      <td>4800.0</td>
    </tr>
  </tbody>
</table>
</div>
</div>

</div>

</div>

</div>

</div>
<div class="jp-Cell jp-MarkdownCell jp-Notebook-cell">
<div class="jp-Cell-inputWrapper">
<div class="jp-Collapser jp-InputCollapser jp-Cell-inputCollapser">
</div>
<div class="jp-InputArea jp-Cell-inputArea"><div class="jp-InputPrompt jp-InputArea-prompt">
</div><div class="jp-RenderedHTMLCommon jp-RenderedMarkdown jp-MarkdownOutput">
<p><strong>2. Fluctuation in Price of Sales</strong></p>
<p>Similar observation is extended to the scenario in which the prices for the adapters decrease to 172 and 197 for the IBM and Macintosh versions, respectively. The achieved profit experiences a drop of 491740.22 (9311204.7-8819464.48) while all of the other decisions remain fixed. The wretched drop in prices reduces the AOS&#39; ability in revenue generation. In the meantime, the additional 1 million credit line cannot be allocated to operations due to limited production capacity. The company will have no choice but to put them in short-term investments to minimize losses from the extra credit costs, hindering profits even further.</p>

</div>
</div>
</div>
</div><div class="jp-Cell jp-CodeCell jp-Notebook-cell">
<div class="jp-Cell-inputWrapper">
<div class="jp-Collapser jp-InputCollapser jp-Cell-inputCollapser">
</div>
<div class="jp-InputArea jp-Cell-inputArea">
<div class="jp-InputPrompt jp-InputArea-prompt">In&#160;[41]:</div>
<div class="jp-CodeMirrorEditor jp-Editor jp-InputArea-editor">
     <div class="CodeMirror cm-s-jupyter">
<div class="highlight hl-ipython3"><pre><span></span><span class="c1"># solution with the new credit line</span>
<span class="n">status_cp</span><span class="p">,</span> <span class="n">variables_cp_df</span><span class="p">,</span> <span class="n">constraints_cp_df</span><span class="p">,</span> <span class="n">var_dict_cp</span> <span class="o">=</span> <span class="n">AOS</span><span class="p">(</span><span class="n">price</span><span class="o">=</span><span class="p">(</span><span class="mi">172</span><span class="p">,</span><span class="mi">197</span><span class="p">),</span><span class="n">creditLine</span> <span class="o">=</span> <span class="mi">1750000</span><span class="p">)</span>
<span class="n">df_cp</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">var_dict_cp</span><span class="p">,</span> <span class="n">index</span> <span class="o">=</span> <span class="n">id_lbl</span><span class="p">)[</span><span class="mi">3</span><span class="p">:]</span>
<span class="n">df_cp</span><span class="o">-</span><span class="n">df_original</span>
</pre></div>

     </div>
</div>
</div>
</div>

<div class="jp-Cell-outputWrapper">
<div class="jp-Collapser jp-OutputCollapser jp-Cell-outputCollapser">
</div>


<div class="jp-OutputArea jp-Cell-outputArea">

<div class="jp-OutputArea-child">

    
    <div class="jp-OutputPrompt jp-OutputArea-prompt"></div>


<div class="jp-RenderedText jp-OutputArea-output">
<pre>Gurobi Optimizer version 11.0.0 build v11.0.0rc2 (win64 - Windows 11+.0 (22631.2))

CPU model: AMD Ryzen 7 6800HS with Radeon Graphics, instruction set [SSE2|AVX|AVX2]
Thread count: 8 physical cores, 16 logical processors, using up to 16 threads

Optimize a model with 92 rows, 84 columns and 225 nonzeros
Model fingerprint: 0x633c8d54
Coefficient statistics:
  Matrix range     [1e-01, 2e+02]
  Objective range  [1e-02, 1e+00]
  Bounds range     [0e+00, 0e+00]
  RHS range        [1e+03, 2e+06]
Presolve removed 57 rows and 50 columns
Presolve time: 0.00s
Presolved: 35 rows, 34 columns, 131 nonzeros

Iteration    Objective       Primal Inf.    Dual Inf.      Time
       0    3.8400000e+30   5.075000e+29   3.840000e+00      0s
      19    8.8194645e+06   0.000000e+00   0.000000e+00      0s

Solved in 19 iterations and 0.01 seconds (0.00 work units)
Optimal objective  8.819464482e+06

Optimal Values for Decision Variables:
The objective value achieved in profit: 8819464.48 dollars
</pre>
</div>
</div>

<div class="jp-OutputArea-child">

    
    <div class="jp-OutputPrompt jp-OutputArea-prompt">Out[41]:</div>



<div class="jp-RenderedHTMLCommon jp-RenderedHTML jp-OutputArea-output jp-OutputArea-executeResult">
<div>

<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>ADV</th>
      <th>ADV_IBM</th>
      <th>ADV_MAC</th>
      <th>IBM</th>
      <th>MAC</th>
      <th>PROD</th>
      <th>SIBM</th>
      <th>SMAC</th>
      <th>INVIBM</th>
      <th>INVMAC</th>
      <th>INVEST</th>
      <th>REV</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>1996 Q1</th>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>855700.000000</td>
      <td>-106800.0</td>
    </tr>
    <tr>
      <th>1996 Q2</th>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>740915.500000</td>
      <td>-90120.0</td>
    </tr>
    <tr>
      <th>1996 Q3</th>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>628303.232500</td>
      <td>-86226.0</td>
    </tr>
    <tr>
      <th>1996 Q4</th>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>508259.780987</td>
      <td>-91968.0</td>
    </tr>
  </tbody>
</table>
</div>
</div>

</div>

</div>

</div>

</div>
<div class="jp-Cell jp-MarkdownCell jp-Notebook-cell">
<div class="jp-Cell-inputWrapper">
<div class="jp-Collapser jp-InputCollapser jp-Cell-inputCollapser">
</div>
<div class="jp-InputArea jp-Cell-inputArea"><div class="jp-InputPrompt jp-InputArea-prompt">
</div><div class="jp-RenderedHTMLCommon jp-RenderedMarkdown jp-MarkdownOutput">
<p><strong>3. Increase in Production Variable Costs</strong></p>
<p>The achieved profit experiences another decline of 530180.76 (9311204.7-8781023.94). The increase in variable costs exacerbates the detrimental impact of the additional line of credit on the company. The change table illustrates that money allocated to production rises while the total number of items produced remain constant. Lacking the ability to expand production and consequently continue along the curve of economies of scales to decrease ATC, the rise in production costs diminishes the company&#39;s cash collection capability and impairs its ability to mitigate the negative consequences of the extra credit line.</p>
<p>As variable costs escalate, more cash are required to finance the heightened expenses. This, in turn, restricts the funds available for short-term investments. Consequently, the losses incurred from credit costs are magnified, further compounded by a decline in revenue.</p>
<p>In essence, the company finds itself in a precarious position where the increased burden of financing elevated production costs erodes its financial flexibility and exacerbates the adverse effects of the additional credit line.</p>

</div>
</div>
</div>
</div><div class="jp-Cell jp-CodeCell jp-Notebook-cell">
<div class="jp-Cell-inputWrapper">
<div class="jp-Collapser jp-InputCollapser jp-Cell-inputCollapser">
</div>
<div class="jp-InputArea jp-Cell-inputArea">
<div class="jp-InputPrompt jp-InputArea-prompt">In&#160;[42]:</div>
<div class="jp-CodeMirrorEditor jp-Editor jp-InputArea-editor">
     <div class="CodeMirror cm-s-jupyter">
<div class="highlight hl-ipython3"><pre><span></span><span class="c1"># solution with the new credit line</span>
<span class="n">status_co</span><span class="p">,</span> <span class="n">variables_co_df</span><span class="p">,</span> <span class="n">constraints_co_df</span><span class="p">,</span> <span class="n">var_dict_co</span> <span class="o">=</span> <span class="n">AOS</span><span class="p">(</span><span class="n">cost</span><span class="o">=</span><span class="p">(</span><span class="mi">103</span><span class="p">,</span><span class="mi">115</span><span class="p">),</span><span class="n">creditLine</span> <span class="o">=</span> <span class="mi">1750000</span><span class="p">)</span>
<span class="n">df_co</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">var_dict_co</span><span class="p">,</span> <span class="n">index</span> <span class="o">=</span> <span class="n">id_lbl</span><span class="p">)[</span><span class="mi">3</span><span class="p">:]</span>
<span class="n">df_co</span><span class="o">-</span><span class="n">df_original</span>
</pre></div>

     </div>
</div>
</div>
</div>

<div class="jp-Cell-outputWrapper">
<div class="jp-Collapser jp-OutputCollapser jp-Cell-outputCollapser">
</div>


<div class="jp-OutputArea jp-Cell-outputArea">

<div class="jp-OutputArea-child">

    
    <div class="jp-OutputPrompt jp-OutputArea-prompt"></div>


<div class="jp-RenderedText jp-OutputArea-output">
<pre>Gurobi Optimizer version 11.0.0 build v11.0.0rc2 (win64 - Windows 11+.0 (22631.2))

CPU model: AMD Ryzen 7 6800HS with Radeon Graphics, instruction set [SSE2|AVX|AVX2]
Thread count: 8 physical cores, 16 logical processors, using up to 16 threads

Optimize a model with 92 rows, 84 columns and 225 nonzeros
Model fingerprint: 0x2bd1145b
Coefficient statistics:
  Matrix range     [1e-01, 2e+02]
  Objective range  [1e-02, 1e+00]
  Bounds range     [0e+00, 0e+00]
  RHS range        [1e+03, 2e+06]
Presolve removed 57 rows and 50 columns
Presolve time: 0.00s
Presolved: 35 rows, 34 columns, 131 nonzeros

Iteration    Objective       Primal Inf.    Dual Inf.      Time
       0    3.8400000e+30   5.075000e+29   3.840000e+00      0s
      19    8.7810239e+06   0.000000e+00   0.000000e+00      0s

Solved in 19 iterations and 0.01 seconds (0.00 work units)
Optimal objective  8.781023939e+06

Optimal Values for Decision Variables:
The objective value achieved in profit: 8781023.94 dollars
</pre>
</div>
</div>

<div class="jp-OutputArea-child">

    
    <div class="jp-OutputPrompt jp-OutputArea-prompt">Out[42]:</div>



<div class="jp-RenderedHTMLCommon jp-RenderedHTML jp-OutputArea-output jp-OutputArea-executeResult">
<div>

<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>ADV</th>
      <th>ADV_IBM</th>
      <th>ADV_MAC</th>
      <th>IBM</th>
      <th>MAC</th>
      <th>PROD</th>
      <th>SIBM</th>
      <th>SMAC</th>
      <th>INVIBM</th>
      <th>INVMAC</th>
      <th>INVEST</th>
      <th>REV</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>1996 Q1</th>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>100800.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>861700.000000</td>
      <td>0.0</td>
    </tr>
    <tr>
      <th>1996 Q2</th>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>100800.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>736325.500000</td>
      <td>0.0</td>
    </tr>
    <tr>
      <th>1996 Q3</th>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>100800.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>609070.382500</td>
      <td>0.0</td>
    </tr>
    <tr>
      <th>1996 Q4</th>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>110880.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>469819.238238</td>
      <td>0.0</td>
    </tr>
  </tbody>
</table>
</div>
</div>

</div>

</div>

</div>

</div>
<div class="jp-Cell jp-MarkdownCell jp-Notebook-cell">
<div class="jp-Cell-inputWrapper">
<div class="jp-Collapser jp-InputCollapser jp-Cell-inputCollapser">
</div>
<div class="jp-InputArea jp-Cell-inputArea"><div class="jp-InputPrompt jp-InputArea-prompt">
</div><div class="jp-RenderedHTMLCommon jp-RenderedMarkdown jp-MarkdownOutput">
<p><strong>4. Change in Advertisement Effectiveness</strong></p>
<p>Under the simulated scenario in which the advertisement effectiveness is reduced by 90% (10 to 100 $/sale), the damage caused by the extra credit line becomes more fatal to AOS (9311204.7 to 3456044.84).</p>
<p>The higher threshold for advertising effectiveness translates to reduced sales volume. AOS experiences a notable decline in revenue across all quarters. In addition, the amount of money allocated to advertisement also decreases significantly. As the cost of advertising for pushing one unit of sales beyond the predicted demand rises, the inventory carry-on cost becomes negligible, making it more profitable to store the items instead. Facing lower demands, the company also have to adjust its production levels to align with the revised demand projections, resulting in decreased production costs and excess production capacity, as evident in the zero shadow prices of the capacity constraint. Lastly, the reduced cash collection negatively affects the company&#39;s ability to allocate funds towards investments. As seen in the table, the decrease in revenue is accompanied by a decrease in investments even with the additional credit line.</p>
<p>It becomes too costly to beat the demand forecast to the point that keeping the money on the book becomes more desirable than spending the money on advertisements, which restricts the firm&#39;s operation while impeding the transformation of the extra line of credit into revenue.</p>

</div>
</div>
</div>
</div><div class="jp-Cell jp-CodeCell jp-Notebook-cell">
<div class="jp-Cell-inputWrapper">
<div class="jp-Collapser jp-InputCollapser jp-Cell-inputCollapser">
</div>
<div class="jp-InputArea jp-Cell-inputArea">
<div class="jp-InputPrompt jp-InputArea-prompt">In&#160;[43]:</div>
<div class="jp-CodeMirrorEditor jp-Editor jp-InputArea-editor">
     <div class="CodeMirror cm-s-jupyter">
<div class="highlight hl-ipython3"><pre><span></span><span class="c1"># solution with the new credit line</span>
<span class="n">status_adv</span><span class="p">,</span> <span class="n">variables_adv_df</span><span class="p">,</span> <span class="n">constraints_adv_df</span><span class="p">,</span> <span class="n">var_dict_adv</span> <span class="o">=</span> <span class="n">AOS</span><span class="p">(</span><span class="n">adv_eff</span><span class="o">=</span><span class="mi">100</span><span class="p">,</span><span class="n">creditLine</span> <span class="o">=</span> <span class="mi">1750000</span><span class="p">)</span>
<span class="n">df_adv</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">var_dict_adv</span><span class="p">,</span> <span class="n">index</span> <span class="o">=</span> <span class="n">id_lbl</span><span class="p">)[</span><span class="mi">3</span><span class="p">:]</span>
<span class="n">display</span><span class="p">(</span><span class="n">df_adv</span><span class="o">-</span><span class="n">df_original</span><span class="p">)</span>
<span class="n">display</span><span class="p">(</span><span class="n">constraints_adv_df</span><span class="p">[</span><span class="n">constraints_adv_df</span><span class="p">[</span><span class="s1">&#39;Constraint&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">str</span><span class="o">.</span><span class="n">contains</span><span class="p">(</span><span class="s1">&#39;capacity&#39;</span><span class="p">)])</span>
</pre></div>

     </div>
</div>
</div>
</div>

<div class="jp-Cell-outputWrapper">
<div class="jp-Collapser jp-OutputCollapser jp-Cell-outputCollapser">
</div>


<div class="jp-OutputArea jp-Cell-outputArea">

<div class="jp-OutputArea-child">

    
    <div class="jp-OutputPrompt jp-OutputArea-prompt"></div>


<div class="jp-RenderedText jp-OutputArea-output">
<pre>Gurobi Optimizer version 11.0.0 build v11.0.0rc2 (win64 - Windows 11+.0 (22631.2))

CPU model: AMD Ryzen 7 6800HS with Radeon Graphics, instruction set [SSE2|AVX|AVX2]
Thread count: 8 physical cores, 16 logical processors, using up to 16 threads

Optimize a model with 92 rows, 84 columns and 225 nonzeros
Model fingerprint: 0xf8dbf132
Coefficient statistics:
  Matrix range     [1e-02, 2e+02]
  Objective range  [1e-02, 1e+00]
  Bounds range     [0e+00, 0e+00]
  RHS range        [1e+03, 2e+06]
Presolve removed 57 rows and 50 columns
Presolve time: 0.00s
Presolved: 35 rows, 34 columns, 131 nonzeros

Iteration    Objective       Primal Inf.    Dual Inf.      Time
       0    1.9200000e+30   5.075000e+29   1.920000e+00      0s
      28    3.4560448e+06   0.000000e+00   0.000000e+00      0s

Solved in 28 iterations and 0.01 seconds (0.00 work units)
Optimal objective  3.456044840e+06

Optimal Values for Decision Variables:
The objective value achieved in profit: 3456044.84 dollars
</pre>
</div>
</div>

<div class="jp-OutputArea-child">

    
    <div class="jp-OutputPrompt jp-OutputArea-prompt"></div>



<div class="jp-RenderedHTMLCommon jp-RenderedHTML jp-OutputArea-output">
<div>

<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>ADV</th>
      <th>ADV_IBM</th>
      <th>ADV_MAC</th>
      <th>IBM</th>
      <th>MAC</th>
      <th>PROD</th>
      <th>SIBM</th>
      <th>SMAC</th>
      <th>INVIBM</th>
      <th>INVMAC</th>
      <th>INVEST</th>
      <th>REV</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>1996 Q1</th>
      <td>-230000.0</td>
      <td>-226000.0</td>
      <td>-4000.0</td>
      <td>-16600.0</td>
      <td>-7200.0</td>
      <td>-2452000.0</td>
      <td>-22600.0</td>
      <td>-9400.0</td>
      <td>6000.0</td>
      <td>2200.0</td>
      <td>-8.341700e+05</td>
      <td>-4470250.0</td>
    </tr>
    <tr>
      <th>1996 Q2</th>
      <td>-168000.0</td>
      <td>-116000.0</td>
      <td>-52000.0</td>
      <td>-13550.0</td>
      <td>-6090.0</td>
      <td>-2024900.0</td>
      <td>-11600.0</td>
      <td>-5200.0</td>
      <td>4050.0</td>
      <td>1310.0</td>
      <td>-2.049074e+06</td>
      <td>-3352300.0</td>
    </tr>
    <tr>
      <th>1996 Q3</th>
      <td>-156000.0</td>
      <td>-106000.0</td>
      <td>-50000.0</td>
      <td>-11525.0</td>
      <td>-5435.0</td>
      <td>-1750350.0</td>
      <td>-10600.0</td>
      <td>-5000.0</td>
      <td>3125.0</td>
      <td>875.0</td>
      <td>-3.139347e+06</td>
      <td>-2924300.0</td>
    </tr>
    <tr>
      <th>1996 Q4</th>
      <td>157100.0</td>
      <td>-115200.0</td>
      <td>272300.0</td>
      <td>-7322.5</td>
      <td>-3120.0</td>
      <td>-1075450.0</td>
      <td>-11520.0</td>
      <td>-2245.0</td>
      <td>7322.5</td>
      <td>0.0</td>
      <td>-4.855160e+06</td>
      <td>-2542250.0</td>
    </tr>
  </tbody>
</table>
</div>
</div>

</div>

<div class="jp-OutputArea-child">

    
    <div class="jp-OutputPrompt jp-OutputArea-prompt"></div>



<div class="jp-RenderedHTMLCommon jp-RenderedHTML jp-OutputArea-output">
<div>

<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Constraint</th>
      <th>Shadow Price</th>
      <th>Allowable Increase (RHS)</th>
      <th>Allowable Decrease (RHS)</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>82</th>
      <td>capacity_IBM 1996 Q1</td>
      <td>0.0</td>
      <td>inf</td>
      <td>5000.0</td>
    </tr>
    <tr>
      <th>83</th>
      <td>capacity_Mac 1996 Q1</td>
      <td>0.0</td>
      <td>inf</td>
      <td>0.0</td>
    </tr>
    <tr>
      <th>84</th>
      <td>capacity_IBM 1996 Q2</td>
      <td>0.0</td>
      <td>inf</td>
      <td>8050.0</td>
    </tr>
    <tr>
      <th>85</th>
      <td>capacity_Mac 1996 Q2</td>
      <td>0.0</td>
      <td>inf</td>
      <td>1110.0</td>
    </tr>
    <tr>
      <th>86</th>
      <td>capacity_IBM 1996 Q3</td>
      <td>0.0</td>
      <td>inf</td>
      <td>10075.0</td>
    </tr>
    <tr>
      <th>87</th>
      <td>capacity_Mac 1996 Q3</td>
      <td>0.0</td>
      <td>inf</td>
      <td>1765.0</td>
    </tr>
    <tr>
      <th>90</th>
      <td>capacity_IBM 1996 Q4</td>
      <td>0.0</td>
      <td>inf</td>
      <td>16437.5</td>
    </tr>
    <tr>
      <th>91</th>
      <td>capacity_Mac 1996 Q4</td>
      <td>0.0</td>
      <td>inf</td>
      <td>4800.0</td>
    </tr>
  </tbody>
</table>
</div>
</div>

</div>

</div>

</div>

</div>
<div class="jp-Cell jp-MarkdownCell jp-Notebook-cell">
<div class="jp-Cell-inputWrapper">
<div class="jp-Collapser jp-InputCollapser jp-Cell-inputCollapser">
</div>
<div class="jp-InputArea jp-Cell-inputArea"><div class="jp-InputPrompt jp-InputArea-prompt">
</div><div class="jp-RenderedHTMLCommon jp-RenderedMarkdown jp-MarkdownOutput">
<p><strong>5. Change in Inventory Cushion</strong></p>
<p>As explained in the earlier section, an increase in the safety cushion for production and inventory for the first three quarters does not have an effect on the original solution. As presented in the constraint and the optimal solution table, production is still pushed to its maximum capacity, surpassing the cushion requirement by great amounts. In this case, each dollar spent can be transformed into revenue instead of being trapped to finance the inventory carry-on cost. Consequently, the additional credit line cannot be allocated to further enhance production and can only be directed towards short-term investments to minimize losses. This explains why the model yields the same achieved profit as the solution in which the same extra credit line is introduced while sharing the same cushion percentage with the original model. However, to the end, AOS still has to bear the additional credit cost coming from the extra credit line, which leads to lower achieved profit.</p>

</div>
</div>
</div>
</div><div class="jp-Cell jp-CodeCell jp-Notebook-cell">
<div class="jp-Cell-inputWrapper">
<div class="jp-Collapser jp-InputCollapser jp-Cell-inputCollapser">
</div>
<div class="jp-InputArea jp-Cell-inputArea">
<div class="jp-InputPrompt jp-InputArea-prompt">In&#160;[44]:</div>
<div class="jp-CodeMirrorEditor jp-Editor jp-InputArea-editor">
     <div class="CodeMirror cm-s-jupyter">
<div class="highlight hl-ipython3"><pre><span></span><span class="n">status_rinv</span><span class="p">,</span> <span class="n">variables_rinv_df</span><span class="p">,</span> <span class="n">constraints_rinv_df</span><span class="p">,</span> <span class="n">var_dict_rinv</span> <span class="o">=</span> <span class="n">AOS</span><span class="p">(</span><span class="n">inv_cushion</span><span class="o">=</span><span class="mf">0.2</span><span class="p">,</span><span class="n">creditLine</span> <span class="o">=</span> <span class="mi">1750000</span><span class="p">)</span>
<span class="n">df_rinv</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">var_dict_rinv</span><span class="p">,</span> <span class="n">index</span> <span class="o">=</span> <span class="n">id_lbl</span><span class="p">)[</span><span class="mi">3</span><span class="p">:]</span>
<span class="n">display</span><span class="p">(</span><span class="n">df_rinv</span><span class="p">)</span>
<span class="n">display</span><span class="p">(</span><span class="n">constraints_rinv_df</span><span class="p">[</span><span class="n">constraints_rinv_df</span><span class="p">[</span><span class="s1">&#39;Constraint&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">str</span><span class="o">.</span><span class="n">contains</span><span class="p">(</span><span class="s1">&#39;prod&#39;</span><span class="p">)])</span>
</pre></div>

     </div>
</div>
</div>
</div>

<div class="jp-Cell-outputWrapper">
<div class="jp-Collapser jp-OutputCollapser jp-Cell-outputCollapser">
</div>


<div class="jp-OutputArea jp-Cell-outputArea">

<div class="jp-OutputArea-child">

    
    <div class="jp-OutputPrompt jp-OutputArea-prompt"></div>


<div class="jp-RenderedText jp-OutputArea-output">
<pre>Gurobi Optimizer version 11.0.0 build v11.0.0rc2 (win64 - Windows 11+.0 (22631.2))

CPU model: AMD Ryzen 7 6800HS with Radeon Graphics, instruction set [SSE2|AVX|AVX2]
Thread count: 8 physical cores, 16 logical processors, using up to 16 threads

Optimize a model with 92 rows, 84 columns and 225 nonzeros
Model fingerprint: 0xd8d7fb18
Coefficient statistics:
  Matrix range     [1e-01, 2e+02]
  Objective range  [1e-02, 1e+00]
  Bounds range     [0e+00, 0e+00]
  RHS range        [1e+03, 2e+06]
Presolve removed 57 rows and 50 columns
Presolve time: 0.00s
Presolved: 35 rows, 34 columns, 131 nonzeros

Iteration    Objective       Primal Inf.    Dual Inf.      Time
       0    3.8400000e+30   5.075000e+29   3.840000e+00      0s
      19    9.2034742e+06   0.000000e+00   0.000000e+00      0s

Solved in 19 iterations and 0.01 seconds (0.00 work units)
Optimal objective  9.203474199e+06

Optimal Values for Decision Variables:
The objective value achieved in profit: 9203474.2 dollars
</pre>
</div>
</div>

<div class="jp-OutputArea-child">

    
    <div class="jp-OutputPrompt jp-OutputArea-prompt"></div>



<div class="jp-RenderedHTMLCommon jp-RenderedHTML jp-OutputArea-output">
<div>

<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>ADV</th>
      <th>ADV_IBM</th>
      <th>ADV_MAC</th>
      <th>IBM</th>
      <th>MAC</th>
      <th>PROD</th>
      <th>SIBM</th>
      <th>SMAC</th>
      <th>INVIBM</th>
      <th>INVMAC</th>
      <th>INVEST</th>
      <th>REV</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>1996 Q1</th>
      <td>330000.0</td>
      <td>226000.0</td>
      <td>104000.0</td>
      <td>21600.0</td>
      <td>7200.0</td>
      <td>2952000.0</td>
      <td>31600.0</td>
      <td>12200.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>4.733125e+06</td>
      <td>6480750.0</td>
    </tr>
    <tr>
      <th>1996 Q2</th>
      <td>168000.0</td>
      <td>116000.0</td>
      <td>52000.0</td>
      <td>21600.0</td>
      <td>7200.0</td>
      <td>2952000.0</td>
      <td>21600.0</td>
      <td>7200.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>6.905747e+06</td>
      <td>5437250.0</td>
    </tr>
    <tr>
      <th>1996 Q3</th>
      <td>156000.0</td>
      <td>106000.0</td>
      <td>50000.0</td>
      <td>21600.0</td>
      <td>7200.0</td>
      <td>2952000.0</td>
      <td>21600.0</td>
      <td>7200.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>8.895408e+06</td>
      <td>5209700.0</td>
    </tr>
    <tr>
      <th>1996 Q4</th>
      <td>170400.0</td>
      <td>115200.0</td>
      <td>55200.0</td>
      <td>23760.0</td>
      <td>7920.0</td>
      <td>3247200.0</td>
      <td>23520.0</td>
      <td>7920.0</td>
      <td>240.0</td>
      <td>0.0</td>
      <td>1.095347e+07</td>
      <td>5558100.0</td>
    </tr>
  </tbody>
</table>
</div>
</div>

</div>

<div class="jp-OutputArea-child">

    
    <div class="jp-OutputPrompt jp-OutputArea-prompt"></div>



<div class="jp-RenderedHTMLCommon jp-RenderedHTML jp-OutputArea-output">
<div>

<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Constraint</th>
      <th>Shadow Price</th>
      <th>Allowable Increase (RHS)</th>
      <th>Allowable Decrease (RHS)</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>76</th>
      <td>prod_IBM 1996 Q1</td>
      <td>0.00</td>
      <td>21600.0</td>
      <td>-inf</td>
    </tr>
    <tr>
      <th>77</th>
      <td>prod_Mac 1996 Q1</td>
      <td>0.00</td>
      <td>7200.0</td>
      <td>-inf</td>
    </tr>
    <tr>
      <th>78</th>
      <td>prod_IBM 1996 Q2</td>
      <td>0.00</td>
      <td>21600.0</td>
      <td>-inf</td>
    </tr>
    <tr>
      <th>79</th>
      <td>prod_Mac 1996 Q2</td>
      <td>0.00</td>
      <td>7200.0</td>
      <td>-inf</td>
    </tr>
    <tr>
      <th>80</th>
      <td>prod_IBM 1996 Q3</td>
      <td>0.00</td>
      <td>21600.0</td>
      <td>-inf</td>
    </tr>
    <tr>
      <th>81</th>
      <td>prod_Mac 1996 Q3</td>
      <td>0.00</td>
      <td>7200.0</td>
      <td>-inf</td>
    </tr>
    <tr>
      <th>88</th>
      <td>prod_IBM 1996 Q4</td>
      <td>-122.25</td>
      <td>35520.0</td>
      <td>23760.0</td>
    </tr>
    <tr>
      <th>89</th>
      <td>prod_Mac 1996 Q4</td>
      <td>0.00</td>
      <td>7920.0</td>
      <td>-inf</td>
    </tr>
  </tbody>
</table>
</div>
</div>

</div>

</div>

</div>

</div>
<div class="jp-Cell jp-MarkdownCell jp-Notebook-cell">
<div class="jp-Cell-inputWrapper">
<div class="jp-Collapser jp-InputCollapser jp-Cell-inputCollapser">
</div>
<div class="jp-InputArea jp-Cell-inputArea"><div class="jp-InputPrompt jp-InputArea-prompt">
</div><div class="jp-RenderedHTMLCommon jp-RenderedMarkdown jp-MarkdownOutput">
<p><strong>6. Need for an Addtional 8 Million</strong></p>
<p>In light of the simulated scenario where advertisement effectiveness drastically declines, AOS faces a substantial decrease in revenue and sales volume across all quarters. This sharp reduction in advertising effectiveness results in a diminished return on investment for advertising expenditure. Consequently, AOS reallocates resources away from advertising, opting instead to store items due to the negligible cost of carrying inventory. Adjusting production levels to align with reduced demand projections leads to decreased production plans and excess production capacity. Heretofore, the model responded the same way as it did with the 1 million credit line.</p>
<p>Anomalies arise from figures of achieved profit. The $8 million credit line presents an even more perplexing situation than adding 1 million, as the significant reduction in revenue makes it increasingly challenging to justify the need for additional credit when the primary issue lies in declining sales and advertising effectiveness. The influx of additional funds does help AOS to retain more excess funds throughout the year; however, the achieved profit is further damaged by the astronomical figures of the credit cost incurred, pure cost of 140000 (8M&#183;(0.07/4)) per quarter with 0 revenue generation.</p>
<p>Therefore, in this scenario, the proposed $8 million credit line appears redundant and may exacerbate the company&#39;s financial challenges rather than alleviating them.</p>

</div>
</div>
</div>
</div><div class="jp-Cell jp-CodeCell jp-Notebook-cell">
<div class="jp-Cell-inputWrapper">
<div class="jp-Collapser jp-InputCollapser jp-Cell-inputCollapser">
</div>
<div class="jp-InputArea jp-Cell-inputArea">
<div class="jp-InputPrompt jp-InputArea-prompt">In&#160;[45]:</div>
<div class="jp-CodeMirrorEditor jp-Editor jp-InputArea-editor">
     <div class="CodeMirror cm-s-jupyter">
<div class="highlight hl-ipython3"><pre><span></span><span class="c1"># solution with the new credit line</span>
<span class="n">status_adv</span><span class="p">,</span> <span class="n">variables_adv_df</span><span class="p">,</span> <span class="n">constraints_adv_df</span><span class="p">,</span> <span class="n">var_dict_adv</span> <span class="o">=</span> <span class="n">AOS</span><span class="p">(</span><span class="n">adv_eff</span><span class="o">=</span><span class="mi">100</span><span class="p">,</span><span class="n">creditLine</span> <span class="o">=</span> <span class="mi">8750000</span><span class="p">)</span>
<span class="n">df_adv</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">var_dict_adv</span><span class="p">,</span> <span class="n">index</span> <span class="o">=</span> <span class="n">id_lbl</span><span class="p">)[</span><span class="mi">3</span><span class="p">:]</span>
<span class="n">display</span><span class="p">(</span><span class="n">df_adv</span><span class="o">-</span><span class="n">df_original</span><span class="p">)</span>
<span class="n">display</span><span class="p">(</span><span class="n">constraints_adv_df</span><span class="p">[</span><span class="n">constraints_adv_df</span><span class="p">[</span><span class="s1">&#39;Constraint&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">str</span><span class="o">.</span><span class="n">contains</span><span class="p">(</span><span class="s1">&#39;capacity&#39;</span><span class="p">)])</span>
</pre></div>

     </div>
</div>
</div>
</div>

<div class="jp-Cell-outputWrapper">
<div class="jp-Collapser jp-OutputCollapser jp-Cell-outputCollapser">
</div>


<div class="jp-OutputArea jp-Cell-outputArea">

<div class="jp-OutputArea-child">

    
    <div class="jp-OutputPrompt jp-OutputArea-prompt"></div>


<div class="jp-RenderedText jp-OutputArea-output">
<pre>Gurobi Optimizer version 11.0.0 build v11.0.0rc2 (win64 - Windows 11+.0 (22631.2))

CPU model: AMD Ryzen 7 6800HS with Radeon Graphics, instruction set [SSE2|AVX|AVX2]
Thread count: 8 physical cores, 16 logical processors, using up to 16 threads

Optimize a model with 92 rows, 84 columns and 225 nonzeros
Model fingerprint: 0x0fc4f297
Coefficient statistics:
  Matrix range     [1e-02, 2e+02]
  Objective range  [1e-02, 1e+00]
  Bounds range     [0e+00, 0e+00]
  RHS range        [1e+03, 8e+06]
Presolve removed 57 rows and 50 columns
Presolve time: 0.00s
Presolved: 35 rows, 34 columns, 131 nonzeros

Iteration    Objective       Primal Inf.    Dual Inf.      Time
       0    2.8800000e+30   5.150000e+29   2.880000e+00      0s
      27    2.7019313e+06   0.000000e+00   0.000000e+00      0s

Solved in 27 iterations and 0.01 seconds (0.00 work units)
Optimal objective  2.701931329e+06

Optimal Values for Decision Variables:
The objective value achieved in profit: 2701931.33 dollars
</pre>
</div>
</div>

<div class="jp-OutputArea-child">

    
    <div class="jp-OutputPrompt jp-OutputArea-prompt"></div>



<div class="jp-RenderedHTMLCommon jp-RenderedHTML jp-OutputArea-output">
<div>

<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>ADV</th>
      <th>ADV_IBM</th>
      <th>ADV_MAC</th>
      <th>IBM</th>
      <th>MAC</th>
      <th>PROD</th>
      <th>SIBM</th>
      <th>SMAC</th>
      <th>INVIBM</th>
      <th>INVMAC</th>
      <th>INVEST</th>
      <th>REV</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>1996 Q1</th>
      <td>-230000.0</td>
      <td>-226000.0</td>
      <td>-4000.0</td>
      <td>-16600.0</td>
      <td>-7200.0</td>
      <td>-2452000.0</td>
      <td>-22600.0</td>
      <td>-9400.0</td>
      <td>6000.0</td>
      <td>2200.0</td>
      <td>5.903330e+06</td>
      <td>-4470250.0</td>
    </tr>
    <tr>
      <th>1996 Q2</th>
      <td>-168000.0</td>
      <td>-116000.0</td>
      <td>-52000.0</td>
      <td>-13550.0</td>
      <td>-6090.0</td>
      <td>-2024900.0</td>
      <td>-11600.0</td>
      <td>-5200.0</td>
      <td>4050.0</td>
      <td>1310.0</td>
      <td>4.526989e+06</td>
      <td>-3352300.0</td>
    </tr>
    <tr>
      <th>1996 Q3</th>
      <td>-156000.0</td>
      <td>-106000.0</td>
      <td>-50000.0</td>
      <td>-11525.0</td>
      <td>-5435.0</td>
      <td>-1750350.0</td>
      <td>-10600.0</td>
      <td>-5000.0</td>
      <td>3125.0</td>
      <td>875.0</td>
      <td>3.272856e+06</td>
      <td>-2924300.0</td>
    </tr>
    <tr>
      <th>1996 Q4</th>
      <td>157100.0</td>
      <td>-115200.0</td>
      <td>272300.0</td>
      <td>-7322.5</td>
      <td>-3120.0</td>
      <td>-1075450.0</td>
      <td>-11520.0</td>
      <td>-2245.0</td>
      <td>7322.5</td>
      <td>0.0</td>
      <td>1.390727e+06</td>
      <td>-2542250.0</td>
    </tr>
  </tbody>
</table>
</div>
</div>

</div>

<div class="jp-OutputArea-child">

    
    <div class="jp-OutputPrompt jp-OutputArea-prompt"></div>



<div class="jp-RenderedHTMLCommon jp-RenderedHTML jp-OutputArea-output">
<div>

<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Constraint</th>
      <th>Shadow Price</th>
      <th>Allowable Increase (RHS)</th>
      <th>Allowable Decrease (RHS)</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>82</th>
      <td>capacity_IBM 1996 Q1</td>
      <td>0.0</td>
      <td>inf</td>
      <td>5000.0</td>
    </tr>
    <tr>
      <th>83</th>
      <td>capacity_Mac 1996 Q1</td>
      <td>0.0</td>
      <td>inf</td>
      <td>0.0</td>
    </tr>
    <tr>
      <th>84</th>
      <td>capacity_IBM 1996 Q2</td>
      <td>0.0</td>
      <td>inf</td>
      <td>8050.0</td>
    </tr>
    <tr>
      <th>85</th>
      <td>capacity_Mac 1996 Q2</td>
      <td>0.0</td>
      <td>inf</td>
      <td>1110.0</td>
    </tr>
    <tr>
      <th>86</th>
      <td>capacity_IBM 1996 Q3</td>
      <td>0.0</td>
      <td>inf</td>
      <td>10075.0</td>
    </tr>
    <tr>
      <th>87</th>
      <td>capacity_Mac 1996 Q3</td>
      <td>0.0</td>
      <td>inf</td>
      <td>1765.0</td>
    </tr>
    <tr>
      <th>90</th>
      <td>capacity_IBM 1996 Q4</td>
      <td>0.0</td>
      <td>inf</td>
      <td>16437.5</td>
    </tr>
    <tr>
      <th>91</th>
      <td>capacity_Mac 1996 Q4</td>
      <td>0.0</td>
      <td>inf</td>
      <td>4800.0</td>
    </tr>
  </tbody>
</table>
</div>
</div>

</div>

</div>

</div>

</div>
<div class="jp-Cell jp-MarkdownCell jp-Notebook-cell">
<div class="jp-Cell-inputWrapper">
<div class="jp-Collapser jp-InputCollapser jp-Cell-inputCollapser">
</div>
<div class="jp-InputArea jp-Cell-inputArea"><div class="jp-InputPrompt jp-InputArea-prompt">
</div><div class="jp-RenderedHTMLCommon jp-RenderedMarkdown jp-MarkdownOutput">
<h4>Conclusion<a rel="noopener" class="anchor-link" href="#Conclusion">&#182;</a></h4><p>In summary, an additional credit line is not desparately needed by AOS. The company&#39;s current production capacity is constrained, as evidenced by the utilization of the existing credit line. This limits the company&#39;s ability to efficiently convert additional funds into production outputs that can generate revenue. Consequently, if the firm is exposed to challenges such as fluctuating sales prices and increasing variable costs, simply injecting more funds into the company without addressing fixed production abilities would not lead to improved profitability.</p>
<p>Moreover, the injection of redundant funds undermines the purpose of strategic investments for securing returns and enhancing financial stability. Unless the company can use these funds to expand its production facilities or invest in capital projects that boost production capabilities, the extra credit line would remain underutilized and even hinder profits because of accured interests.</p>
<p>Therefore, the conclusion emerges that under the current production capacity, the extra credit line is not needed at this juncture. Instead, the company should focus on addressing production capacity limitations, optimizing cost structures, and exploring avenues for strategic investments that can enhance its competitive position in the market.</p>

</div>
</div>
</div>
</div>
<div class="jp-Cell jp-MarkdownCell jp-Notebook-cell">
<div class="jp-Cell-inputWrapper">
<div class="jp-Collapser jp-InputCollapser jp-Cell-inputCollapser">
</div>
<div class="jp-InputArea jp-Cell-inputArea"><div class="jp-InputPrompt jp-InputArea-prompt">
</div><div class="jp-RenderedHTMLCommon jp-RenderedMarkdown jp-MarkdownOutput">
<h3>V. Conclusion<a rel="noopener" class="anchor-link" href="#V.-Conclusion">&#182;</a></h3><p>The linear optimization model suggests a set of solution that will help AOS to maximize profits under an array of estimations and assumptions. The model is exposed to variations in price, cost, production capacity, advertisement effectiveness, and production capacity, while the feasibility of new proposed plans for renovated collectibles rates and extra credit lines are assessed. In short, the model illustrates robustness in production planning and customer acquisition against general changes in price, cost, inventory cushion, rates of collectibles, credit costs, and the presence of the addtional credit line. However, it is overly sensitive with drastic changes in advertisement effectiveness.</p>

</div>
</div>
</div>
</div>
<div class="jp-Cell jp-MarkdownCell jp-Notebook-cell">
<div class="jp-Cell-inputWrapper">
<div class="jp-Collapser jp-InputCollapser jp-Cell-inputCollapser">
</div>
<div class="jp-InputArea jp-Cell-inputArea"><div class="jp-InputPrompt jp-InputArea-prompt">
</div><div class="jp-RenderedHTMLCommon jp-RenderedMarkdown jp-MarkdownOutput">
<h3>VI. Limitations<a rel="noopener" class="anchor-link" href="#VI.-Limitations">&#182;</a></h3><p>The formulated model is built upon various assumptions and data, which may become obsolete if market realities undergo drastic changes. In response to this potential concern, several limitations of the existing model are presented below. By acknowledging these constraints, stakeholders can adopt a more nuanced understanding of the model&#39;s predictive capabilities and make informed decisions regarding its implementation and reliance in real-world scenarios.</p>
<ul>
<li><strong>Quarterly matured investments:</strong> To faciliate model formulation, short-term investments are assumed to mature quarterly. Subjecting to the executive team&#39;s requirement, all excess funds are reinvested. However, in reality, it is very unlikely for any company to leave no cash on its book as safety reserves. Therefore, AOS&#39; real cashflow in the year of 1996 may deviates from what was computed by the model.</li>
</ul>
<ul>
<li><p><strong>Factory Operation Capacity:</strong> Constraints for factory capacity does not include potential downtimes or variability in worker productivity. In real operations, factories may face inefficiency in production process and fail to maintain operating at maximum theoretical capacity.</p>
</li>
<li><p><strong>Unitary Fixed Cost:</strong> Given that a linear optimization formulation is selected, the current model assumes the fixed cost to be a real value that stays constant regardless of production decisions. Under real-life scenario, fixed cost can often be decomposed into several layers. If the company chooses to not produce in a specific time period, some of the fixed cost will not be active (i.e.manufacturing). If model formulation is based on the theoretical framework of mixed-integer, or even non-linear optimization, the concerns will be resolved.</p>
</li>
<li><p><strong>Inventory Carry-on Cost:</strong> The current inventory carry-on cost is calculated as a simple percentage of the variable cost of the items in stock. However, spoilage, obsolescence, and varying storage costs for different product lines may lead to varying costs.</p>
</li>
<li><p><strong>Rule of Thumb for Safety Cushion:</strong> To reduce inventory carry-on cost, the current safety cushion of AOS is based on the total number of items produced and at hand at the end of each quarter. The current model, adhering to this rule, chooses to escape the cost as much as possible by boosting production. This leaves AOS with zero inventory throughout most of the quarters, making it extremely fragile in front of accidental supply and demand shocks. The safety cushion under the current definition fails to protect the firm as it should have. Therefore, it is suggested that the safety cushion requirement should undergo a reformation that protects the company while not bringing siginificant burdens to AOS&#39; operations.</p>
</li>
</ul>
<ul>
<li><p><strong>Immediate Effect of Advertisement on Sales:</strong> The assumption that advertisement efforts immediately reflect on sales within the same quarter may not be realistic. Usually, it may take some period of time for the initial &#39;investment&#39; to reach the expected growth of customer volume and community response.</p>
</li>
<li><p><strong>Credit Line Assumption</strong>: Since a linear optimization model framework is chosen, the model cannot include binary variables to denote for decisions such as how much to borrow below the limit and when to pay back the credits. The credit line secured is assumed to be used as a lump sum loan, ignoring its flexibility, which could provide more rooms for AOS&#39; growth. Some may argue that such a model can also be realized in linear programming. However, with the special accounting method (all cashflow activities happen at the end of each quarter), the model with flexibilities in borrow options may lead to a set of results that let AOS to operate in all quarters without actually using the credit line since the operational profits can already be enough to finance all costs. However, it is very unrealistic for any company to initial operations with no cash on its books. The code for such a model is attached below for reference, but it is not the optimal model that this report recommend to pursue.</p>
</li>
</ul>

</div>
</div>
</div>
</div><div class="jp-Cell jp-CodeCell jp-Notebook-cell jp-mod-noOutputs">
<div class="jp-Cell-inputWrapper">
<div class="jp-Collapser jp-InputCollapser jp-Cell-inputCollapser">
</div>
<div class="jp-InputArea jp-Cell-inputArea">
<div class="jp-InputPrompt jp-InputArea-prompt">In&#160;[&#160;]:</div>
<div class="jp-CodeMirrorEditor jp-Editor jp-InputArea-editor">
     <div class="CodeMirror cm-s-jupyter">
<div class="highlight hl-ipython3"><pre><span></span><span class="c1"># LP model: reference use</span>
<span class="k">def</span> <span class="nf">AOS_ref</span><span class="p">(</span><span class="n">display</span><span class="p">:</span><span class="nb">bool</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">price</span><span class="p">:</span><span class="nb">tuple</span><span class="o">=</span><span class="p">(</span><span class="mi">175</span><span class="p">,</span><span class="mi">200</span><span class="p">),</span> <span class="n">cost</span><span class="p">:</span><span class="nb">tuple</span><span class="o">=</span><span class="p">(</span><span class="mi">100</span><span class="p">,</span><span class="mi">110</span><span class="p">),</span> <span class="n">adv_eff</span><span class="p">:</span><span class="nb">float</span><span class="o">=</span><span class="mi">10</span><span class="p">,</span> <span class="n">collect_rate</span><span class="p">:</span><span class="nb">dict</span><span class="o">=</span><span class="n">coll_rate</span><span class="p">,</span> <span class="n">rate_loan</span><span class="p">:</span><span class="nb">float</span><span class="o">=</span><span class="mf">0.15</span><span class="p">,</span> <span class="n">inv_cushion</span><span class="p">:</span><span class="nb">float</span><span class="o">=</span><span class="mf">0.1</span><span class="p">,</span> <span class="n">prodCap_Q4</span><span class="p">:</span><span class="nb">float</span><span class="o">=</span><span class="mf">0.1</span><span class="p">,</span> <span class="n">creditLine</span><span class="p">:</span><span class="nb">int</span><span class="o">=</span><span class="mi">750000</span><span class="p">,</span><span class="n">demand_ibm</span><span class="o">=</span><span class="n">demand_ibm</span><span class="p">,</span> <span class="n">demand_mac</span><span class="o">=</span><span class="n">demand_mac</span><span class="p">):</span>
    <span class="n">FixedCost</span> <span class="o">=</span> <span class="mi">150000</span>
    <span class="c1"># price</span>
    <span class="n">price_ibm</span> <span class="o">=</span> <span class="n">price</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
    <span class="n">price_mac</span> <span class="o">=</span> <span class="n">price</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>
    
    <span class="c1"># cost</span>
    <span class="n">cost_ibm</span> <span class="o">=</span> <span class="n">cost</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
    <span class="n">cost_mac</span> <span class="o">=</span> <span class="n">cost</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>
    
    <span class="c1"># collectible rate</span>
    
    <span class="n">coll_ibm</span> <span class="o">=</span> <span class="n">collect_rate</span><span class="p">[</span><span class="s1">&#39;ibm&#39;</span><span class="p">]</span>
    <span class="n">coll_mac</span> <span class="o">=</span> <span class="n">collect_rate</span><span class="p">[</span><span class="s1">&#39;mac&#39;</span><span class="p">]</span>
    
    <span class="c1"># create model</span>
    <span class="n">m</span> <span class="o">=</span> <span class="n">gp</span><span class="o">.</span><span class="n">Model</span><span class="p">()</span>

    <span class="c1"># cal credit cost</span>
    <span class="n">CreditCost</span> <span class="o">=</span> <span class="n">creditLine</span><span class="o">*</span><span class="n">rate_loan</span><span class="o">/</span><span class="mi">4</span>

    <span class="c1"># decision variables</span>
    <span class="n">Adv</span> <span class="o">=</span> <span class="n">m</span><span class="o">.</span><span class="n">addVars</span><span class="p">(</span><span class="mi">7</span><span class="p">,</span> <span class="n">lb</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">name</span><span class="o">=</span><span class="p">[</span><span class="n">i</span><span class="o">+</span><span class="s1">&#39; Adv&#39;</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">id_lbl</span><span class="p">])</span>
    <span class="n">AdvIbm</span> <span class="o">=</span> <span class="n">m</span><span class="o">.</span><span class="n">addVars</span><span class="p">(</span><span class="mi">7</span><span class="p">,</span> <span class="n">lb</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">name</span><span class="o">=</span><span class="p">[</span><span class="n">i</span><span class="o">+</span><span class="s1">&#39; AdvIbm&#39;</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">id_lbl</span><span class="p">])</span>
    <span class="n">AdvMac</span> <span class="o">=</span> <span class="n">m</span><span class="o">.</span><span class="n">addVars</span><span class="p">(</span><span class="mi">7</span><span class="p">,</span> <span class="n">lb</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">name</span><span class="o">=</span><span class="p">[</span><span class="n">i</span><span class="o">+</span><span class="s1">&#39; AdvMac&#39;</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">id_lbl</span><span class="p">])</span>
    <span class="n">Ibm</span> <span class="o">=</span> <span class="n">m</span><span class="o">.</span><span class="n">addVars</span><span class="p">(</span><span class="mi">7</span><span class="p">,</span> <span class="n">lb</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span><span class="n">name</span><span class="o">=</span><span class="p">[</span><span class="n">i</span><span class="o">+</span><span class="s1">&#39; Ibm&#39;</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">id_lbl</span><span class="p">])</span>
    <span class="n">Mac</span> <span class="o">=</span> <span class="n">m</span><span class="o">.</span><span class="n">addVars</span><span class="p">(</span><span class="mi">7</span><span class="p">,</span> <span class="n">lb</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">name</span><span class="o">=</span><span class="p">[</span><span class="n">i</span><span class="o">+</span><span class="s1">&#39; Mac&#39;</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">id_lbl</span><span class="p">])</span>
    <span class="n">Prod</span> <span class="o">=</span> <span class="n">m</span><span class="o">.</span><span class="n">addVars</span><span class="p">(</span><span class="mi">7</span><span class="p">,</span> <span class="n">lb</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">name</span><span class="o">=</span><span class="p">[</span><span class="n">i</span><span class="o">+</span><span class="s1">&#39; Prod&#39;</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">id_lbl</span><span class="p">])</span>
    <span class="n">Sibm</span> <span class="o">=</span> <span class="n">m</span><span class="o">.</span><span class="n">addVars</span><span class="p">(</span><span class="mi">7</span><span class="p">,</span> <span class="n">lb</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">name</span><span class="o">=</span><span class="p">[</span><span class="n">i</span><span class="o">+</span><span class="s1">&#39; Sibm&#39;</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">id_lbl</span><span class="p">])</span>
    <span class="n">Smac</span> <span class="o">=</span> <span class="n">m</span><span class="o">.</span><span class="n">addVars</span><span class="p">(</span><span class="mi">7</span><span class="p">,</span> <span class="n">lb</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">name</span><span class="o">=</span><span class="p">[</span><span class="n">i</span><span class="o">+</span><span class="s1">&#39; Smac&#39;</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">id_lbl</span><span class="p">])</span>
    <span class="n">InvIbm</span> <span class="o">=</span> <span class="n">m</span><span class="o">.</span><span class="n">addVars</span><span class="p">(</span><span class="mi">7</span><span class="p">,</span> <span class="n">lb</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">name</span><span class="o">=</span><span class="p">[</span><span class="n">i</span><span class="o">+</span><span class="s1">&#39; InvIbm&#39;</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">id_lbl</span><span class="p">])</span>
    <span class="n">InvMac</span> <span class="o">=</span> <span class="n">m</span><span class="o">.</span><span class="n">addVars</span><span class="p">(</span><span class="mi">7</span><span class="p">,</span> <span class="n">lb</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">name</span><span class="o">=</span><span class="p">[</span><span class="n">i</span><span class="o">+</span><span class="s1">&#39; InvMac&#39;</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">id_lbl</span><span class="p">])</span>
    <span class="n">Invest</span> <span class="o">=</span> <span class="n">m</span><span class="o">.</span><span class="n">addVars</span><span class="p">(</span><span class="mi">7</span><span class="p">,</span> <span class="n">lb</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">name</span><span class="o">=</span><span class="p">[</span><span class="n">i</span><span class="o">+</span><span class="s1">&#39; Invest&#39;</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">id_lbl</span><span class="p">])</span>
    <span class="n">Rev</span> <span class="o">=</span> <span class="n">m</span><span class="o">.</span><span class="n">addVars</span><span class="p">(</span><span class="mi">7</span><span class="p">,</span> <span class="n">lb</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">name</span><span class="o">=</span><span class="p">[</span><span class="n">i</span><span class="o">+</span><span class="s1">&#39; Rev&#39;</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">id_lbl</span><span class="p">])</span>
    <span class="n">borr</span> <span class="o">=</span> <span class="n">m</span><span class="o">.</span><span class="n">addVars</span><span class="p">(</span><span class="mi">7</span><span class="p">,</span> <span class="n">lb</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">name</span><span class="o">=</span><span class="p">[</span><span class="n">i</span><span class="o">+</span><span class="s1">&#39; borr&#39;</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">id_lbl</span><span class="p">])</span>
    <span class="n">pay_back</span><span class="o">=</span> <span class="n">m</span><span class="o">.</span><span class="n">addVars</span><span class="p">(</span><span class="mi">7</span><span class="p">,</span> <span class="n">lb</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">name</span><span class="o">=</span><span class="p">[</span><span class="n">i</span><span class="o">+</span><span class="s1">&#39; pay_back&#39;</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">id_lbl</span><span class="p">])</span>
    <span class="n">cc</span> <span class="o">=</span> <span class="n">m</span><span class="o">.</span><span class="n">addVars</span><span class="p">(</span><span class="mi">7</span><span class="p">,</span> <span class="n">lb</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">name</span><span class="o">=</span><span class="p">[</span><span class="n">i</span><span class="o">+</span><span class="s1">&#39; cc&#39;</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">id_lbl</span><span class="p">])</span>

    <span class="c1"># constraints</span>

    <span class="c1"># start blank in 1996</span>
    <span class="k">for</span> <span class="n">t</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">3</span><span class="p">):</span>
        <span class="n">m</span><span class="o">.</span><span class="n">addConstr</span><span class="p">(</span><span class="n">AdvIbm</span><span class="p">[</span><span class="n">t</span><span class="p">]</span><span class="o">==</span><span class="mi">0</span><span class="p">)</span>
        <span class="n">m</span><span class="o">.</span><span class="n">addConstr</span><span class="p">(</span><span class="n">AdvMac</span><span class="p">[</span><span class="n">t</span><span class="p">]</span><span class="o">==</span><span class="mi">0</span><span class="p">)</span>
        <span class="n">m</span><span class="o">.</span><span class="n">addConstr</span><span class="p">(</span><span class="n">Adv</span><span class="p">[</span><span class="n">t</span><span class="p">]</span><span class="o">==</span><span class="mi">0</span><span class="p">)</span>
        <span class="n">m</span><span class="o">.</span><span class="n">addConstr</span><span class="p">(</span><span class="n">Ibm</span><span class="p">[</span><span class="n">t</span><span class="p">]</span><span class="o">==</span><span class="mi">0</span><span class="p">)</span>
        <span class="n">m</span><span class="o">.</span><span class="n">addConstr</span><span class="p">(</span><span class="n">Mac</span><span class="p">[</span><span class="n">t</span><span class="p">]</span><span class="o">==</span><span class="mi">0</span><span class="p">)</span>
        <span class="n">m</span><span class="o">.</span><span class="n">addConstr</span><span class="p">(</span><span class="n">Invest</span><span class="p">[</span><span class="n">t</span><span class="p">]</span><span class="o">==</span><span class="mi">0</span><span class="p">)</span>
        <span class="n">m</span><span class="o">.</span><span class="n">addConstr</span><span class="p">(</span><span class="n">Rev</span><span class="p">[</span><span class="n">t</span><span class="p">]</span><span class="o">==</span><span class="mi">0</span><span class="p">)</span>
        <span class="n">m</span><span class="o">.</span><span class="n">addConstr</span><span class="p">(</span><span class="n">pay_back</span><span class="p">[</span><span class="n">t</span><span class="p">]</span><span class="o">==</span><span class="mi">0</span><span class="p">)</span>
        <span class="n">m</span><span class="o">.</span><span class="n">addConstr</span><span class="p">(</span><span class="n">cc</span><span class="p">[</span><span class="n">t</span><span class="p">]</span><span class="o">==</span><span class="mi">0</span><span class="p">)</span>

    <span class="k">for</span> <span class="n">t</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">2</span><span class="p">):</span>
        <span class="n">m</span><span class="o">.</span><span class="n">addConstr</span><span class="p">(</span><span class="n">InvIbm</span><span class="p">[</span><span class="n">t</span><span class="p">]</span><span class="o">==</span><span class="mi">0</span><span class="p">)</span>
        <span class="n">m</span><span class="o">.</span><span class="n">addConstr</span><span class="p">(</span><span class="n">InvMac</span><span class="p">[</span><span class="n">t</span><span class="p">]</span><span class="o">==</span><span class="mi">0</span><span class="p">)</span>
        <span class="n">m</span><span class="o">.</span><span class="n">addConstr</span><span class="p">(</span><span class="n">borr</span><span class="p">[</span><span class="n">t</span><span class="p">]</span><span class="o">==</span><span class="mi">0</span><span class="p">)</span>

    <span class="c1"># beginning of Q1 1996</span>
    <span class="n">m</span><span class="o">.</span><span class="n">addConstr</span><span class="p">(</span><span class="n">InvIbm</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span><span class="o">==</span><span class="mi">10000</span><span class="p">)</span>
    <span class="n">m</span><span class="o">.</span><span class="n">addConstr</span><span class="p">(</span><span class="n">InvMac</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span><span class="o">==</span><span class="mi">5000</span><span class="p">)</span>
    <span class="n">m</span><span class="o">.</span><span class="n">addConstr</span><span class="p">(</span><span class="n">borr</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span><span class="o">&lt;=</span><span class="n">creditLine</span><span class="p">)</span>
    
    <span class="k">for</span> <span class="n">t</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span><span class="mi">7</span><span class="p">):</span>
        <span class="n">m</span><span class="o">.</span><span class="n">addConstr</span><span class="p">(</span><span class="n">cc</span><span class="p">[</span><span class="n">t</span><span class="p">]</span><span class="o">==</span><span class="p">(</span><span class="n">borr</span><span class="p">[</span><span class="n">t</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span><span class="o">-</span><span class="n">pay_back</span><span class="p">[</span><span class="n">t</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span><span class="o">+</span><span class="n">borr</span><span class="p">[</span><span class="n">t</span><span class="o">-</span><span class="mi">2</span><span class="p">]</span><span class="o">-</span><span class="n">pay_back</span><span class="p">[</span><span class="n">t</span><span class="o">-</span><span class="mi">2</span><span class="p">]</span><span class="o">+</span><span class="n">borr</span><span class="p">[</span><span class="n">t</span><span class="o">-</span><span class="mi">3</span><span class="p">]</span><span class="o">-</span><span class="n">pay_back</span><span class="p">[</span><span class="n">t</span><span class="o">-</span><span class="mi">3</span><span class="p">])</span><span class="o">*</span><span class="n">rate_loan</span><span class="o">/</span><span class="mi">4</span><span class="p">)</span>
        <span class="n">m</span><span class="o">.</span><span class="n">addConstr</span><span class="p">(</span><span class="n">pay_back</span><span class="p">[</span><span class="n">t</span><span class="p">]</span><span class="o">&lt;=</span><span class="n">borr</span><span class="p">[</span><span class="n">t</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span><span class="o">-</span><span class="n">pay_back</span><span class="p">[</span><span class="n">t</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span><span class="o">+</span><span class="n">borr</span><span class="p">[</span><span class="n">t</span><span class="o">-</span><span class="mi">2</span><span class="p">]</span><span class="o">-</span><span class="n">pay_back</span><span class="p">[</span><span class="n">t</span><span class="o">-</span><span class="mi">2</span><span class="p">]</span><span class="o">+</span><span class="n">borr</span><span class="p">[</span><span class="n">t</span><span class="o">-</span><span class="mi">3</span><span class="p">]</span><span class="o">-</span><span class="n">pay_back</span><span class="p">[</span><span class="n">t</span><span class="o">-</span><span class="mi">3</span><span class="p">])</span>
        <span class="n">m</span><span class="o">.</span><span class="n">addConstr</span><span class="p">(</span><span class="n">borr</span><span class="p">[</span><span class="n">t</span><span class="p">]</span><span class="o">&lt;=</span><span class="n">creditLine</span><span class="o">-</span><span class="n">borr</span><span class="p">[</span><span class="n">t</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span><span class="o">-</span><span class="n">borr</span><span class="p">[</span><span class="n">t</span><span class="o">-</span><span class="mi">2</span><span class="p">]</span><span class="o">-</span><span class="n">borr</span><span class="p">[</span><span class="n">t</span><span class="o">-</span><span class="mi">3</span><span class="p">]</span><span class="o">+</span><span class="n">pay_back</span><span class="p">[</span><span class="n">t</span><span class="p">]</span><span class="o">+</span><span class="n">pay_back</span><span class="p">[</span><span class="n">t</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span><span class="o">+</span><span class="n">pay_back</span><span class="p">[</span><span class="n">t</span><span class="o">-</span><span class="mi">2</span><span class="p">]</span><span class="o">+</span><span class="n">pay_back</span><span class="p">[</span><span class="n">t</span><span class="o">-</span><span class="mi">3</span><span class="p">])</span>
        
    <span class="c1"># def rev</span>
    <span class="k">for</span> <span class="n">t</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span><span class="mi">7</span><span class="p">):</span>
        <span class="n">m</span><span class="o">.</span><span class="n">addConstr</span><span class="p">(</span><span class="n">Rev</span><span class="p">[</span><span class="n">t</span><span class="p">]</span><span class="o">==</span><span class="n">coll_ibm</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">*</span><span class="n">price_ibm</span><span class="o">*</span><span class="n">Sibm</span><span class="p">[</span><span class="n">t</span><span class="p">]</span><span class="o">+</span><span class="n">coll_mac</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">*</span><span class="n">price_mac</span><span class="o">*</span><span class="n">Smac</span><span class="p">[</span><span class="n">t</span><span class="p">]</span><span class="o">+</span><span class="n">coll_ibm</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">*</span><span class="n">price_ibm</span><span class="o">*</span><span class="p">(</span><span class="n">Sibm</span><span class="p">[</span><span class="n">t</span><span class="o">-</span><span class="mi">1</span><span class="p">])</span><span class="o">+</span><span class="n">coll_mac</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">*</span><span class="n">price_mac</span><span class="o">*</span><span class="p">(</span><span class="n">Smac</span><span class="p">[</span><span class="n">t</span><span class="o">-</span><span class="mi">1</span><span class="p">])</span><span class="o">+</span><span class="n">coll_ibm</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span><span class="o">*</span><span class="n">price_ibm</span><span class="o">*</span><span class="p">(</span><span class="n">Sibm</span><span class="p">[</span><span class="n">t</span><span class="o">-</span><span class="mi">2</span><span class="p">])</span><span class="o">+</span><span class="n">coll_mac</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span><span class="o">*</span><span class="n">price_mac</span><span class="o">*</span><span class="p">(</span><span class="n">Smac</span><span class="p">[</span><span class="n">t</span><span class="o">-</span><span class="mi">2</span><span class="p">])</span><span class="o">+</span><span class="n">coll_ibm</span><span class="p">[</span><span class="mi">3</span><span class="p">]</span><span class="o">*</span><span class="mf">0.5</span><span class="o">*</span><span class="n">price_ibm</span><span class="o">*</span><span class="p">(</span><span class="n">Sibm</span><span class="p">[</span><span class="n">t</span><span class="o">-</span><span class="mi">3</span><span class="p">])</span><span class="o">+</span><span class="n">coll_mac</span><span class="p">[</span><span class="mi">3</span><span class="p">]</span><span class="o">*</span><span class="mf">0.5</span><span class="o">*</span><span class="n">price_mac</span><span class="o">*</span><span class="p">(</span><span class="n">Smac</span><span class="p">[</span><span class="n">t</span><span class="o">-</span><span class="mi">3</span><span class="p">]))</span>

    <span class="c1"># def inventory </span>
    <span class="k">for</span> <span class="n">t</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span><span class="mi">7</span><span class="p">):</span>
        <span class="n">m</span><span class="o">.</span><span class="n">addConstr</span><span class="p">(</span><span class="n">InvIbm</span><span class="p">[</span><span class="n">t</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span><span class="o">+</span><span class="n">Ibm</span><span class="p">[</span><span class="n">t</span><span class="p">]</span><span class="o">-</span><span class="n">Sibm</span><span class="p">[</span><span class="n">t</span><span class="p">]</span><span class="o">==</span><span class="n">InvIbm</span><span class="p">[</span><span class="n">t</span><span class="p">],</span> <span class="n">name</span><span class="o">=</span><span class="s1">&#39;inv_IBM &#39;</span><span class="o">+</span><span class="n">id_lbl</span><span class="p">[</span><span class="n">t</span><span class="p">])</span>
        <span class="n">m</span><span class="o">.</span><span class="n">addConstr</span><span class="p">(</span><span class="n">InvMac</span><span class="p">[</span><span class="n">t</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span><span class="o">+</span><span class="n">Mac</span><span class="p">[</span><span class="n">t</span><span class="p">]</span><span class="o">-</span><span class="n">Smac</span><span class="p">[</span><span class="n">t</span><span class="p">]</span><span class="o">==</span><span class="n">InvMac</span><span class="p">[</span><span class="n">t</span><span class="p">],</span> <span class="n">name</span><span class="o">=</span><span class="s1">&#39;inv_Mac &#39;</span><span class="o">+</span><span class="n">id_lbl</span><span class="p">[</span><span class="n">t</span><span class="p">])</span>

    <span class="c1"># sales</span>
    <span class="c1"># actual sales in 1995</span>
    <span class="k">for</span> <span class="n">t</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">3</span><span class="p">):</span>
        <span class="n">m</span><span class="o">.</span><span class="n">addConstr</span><span class="p">(</span><span class="n">Sibm</span><span class="p">[</span><span class="n">t</span><span class="p">]</span><span class="o">==</span><span class="n">demand_ibm</span><span class="p">[</span><span class="n">t</span><span class="p">])</span> 
        <span class="n">m</span><span class="o">.</span><span class="n">addConstr</span><span class="p">(</span><span class="n">Smac</span><span class="p">[</span><span class="n">t</span><span class="p">]</span><span class="o">==</span><span class="n">demand_mac</span><span class="p">[</span><span class="n">t</span><span class="p">])</span>
    
    <span class="c1"># def adv</span>
    <span class="k">for</span> <span class="n">t</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span><span class="mi">7</span><span class="p">):</span>
        <span class="n">m</span><span class="o">.</span><span class="n">addConstr</span><span class="p">(</span><span class="n">AdvIbm</span><span class="p">[</span><span class="n">t</span><span class="p">]</span><span class="o">+</span><span class="n">AdvMac</span><span class="p">[</span><span class="n">t</span><span class="p">]</span><span class="o">==</span><span class="n">Adv</span><span class="p">[</span><span class="n">t</span><span class="p">])</span>
    
    <span class="c1"># sales &lt;= E[demand]+Adv effect</span>
    <span class="k">for</span> <span class="n">t</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span><span class="mi">7</span><span class="p">):</span>
        <span class="n">m</span><span class="o">.</span><span class="n">addConstr</span><span class="p">(</span><span class="n">Sibm</span><span class="p">[</span><span class="n">t</span><span class="p">]</span><span class="o">&lt;=</span><span class="n">demand_ibm</span><span class="p">[</span><span class="n">t</span><span class="p">]</span><span class="o">+</span><span class="p">(</span><span class="n">AdvIbm</span><span class="p">[</span><span class="n">t</span><span class="p">]</span><span class="o">/</span><span class="n">adv_eff</span><span class="p">),</span> <span class="n">name</span><span class="o">=</span><span class="s1">&#39;demand_IBM &#39;</span><span class="o">+</span><span class="n">id_lbl</span><span class="p">[</span><span class="n">t</span><span class="p">])</span>
        <span class="n">m</span><span class="o">.</span><span class="n">addConstr</span><span class="p">(</span><span class="n">Smac</span><span class="p">[</span><span class="n">t</span><span class="p">]</span><span class="o">&lt;=</span><span class="n">demand_mac</span><span class="p">[</span><span class="n">t</span><span class="p">]</span><span class="o">+</span><span class="p">(</span><span class="n">AdvMac</span><span class="p">[</span><span class="n">t</span><span class="p">]</span><span class="o">/</span><span class="n">adv_eff</span><span class="p">),</span> <span class="n">name</span><span class="o">=</span><span class="s1">&#39;demand_Mac &#39;</span><span class="o">+</span><span class="n">id_lbl</span><span class="p">[</span><span class="n">t</span><span class="p">])</span>

    <span class="c1"># sales &lt;= Inventory in stock</span>
    <span class="k">for</span> <span class="n">t</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span><span class="mi">7</span><span class="p">):</span>
        <span class="n">m</span><span class="o">.</span><span class="n">addConstr</span><span class="p">(</span><span class="n">Sibm</span><span class="p">[</span><span class="n">t</span><span class="p">]</span><span class="o">&lt;=</span><span class="n">InvIbm</span><span class="p">[</span><span class="n">t</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span><span class="o">+</span><span class="n">Ibm</span><span class="p">[</span><span class="n">t</span><span class="p">],</span> <span class="n">name</span><span class="o">=</span><span class="s1">&#39;stock_IBM &#39;</span><span class="o">+</span><span class="n">id_lbl</span><span class="p">[</span><span class="n">t</span><span class="p">])</span>
        <span class="n">m</span><span class="o">.</span><span class="n">addConstr</span><span class="p">(</span><span class="n">Smac</span><span class="p">[</span><span class="n">t</span><span class="p">]</span><span class="o">&lt;=</span><span class="n">InvMac</span><span class="p">[</span><span class="n">t</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span><span class="o">+</span><span class="n">Mac</span><span class="p">[</span><span class="n">t</span><span class="p">],</span> <span class="n">name</span><span class="o">=</span><span class="s1">&#39;stock_Mac &#39;</span><span class="o">+</span><span class="n">id_lbl</span><span class="p">[</span><span class="n">t</span><span class="p">])</span>

    <span class="c1"># def production cost</span>
    <span class="k">for</span> <span class="n">t</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">7</span><span class="p">):</span>
        <span class="n">m</span><span class="o">.</span><span class="n">addConstr</span><span class="p">(</span><span class="n">cost_ibm</span><span class="o">*</span><span class="n">Ibm</span><span class="p">[</span><span class="n">t</span><span class="p">]</span><span class="o">+</span><span class="n">cost_mac</span><span class="o">*</span><span class="n">Mac</span><span class="p">[</span><span class="n">t</span><span class="p">]</span><span class="o">==</span><span class="n">Prod</span><span class="p">[</span><span class="n">t</span><span class="p">])</span>

    <span class="c1"># def cashflow</span>
    <span class="c1"># inital credit 750000</span>
    <span class="c1"># excess funds in quarter 1</span>
    <span class="n">m</span><span class="o">.</span><span class="n">addConstr</span><span class="p">(</span><span class="n">Invest</span><span class="p">[</span><span class="mi">3</span><span class="p">]</span><span class="o">+</span><span class="n">Prod</span><span class="p">[</span><span class="mi">3</span><span class="p">]</span><span class="o">+</span><span class="n">Adv</span><span class="p">[</span><span class="mi">3</span><span class="p">]</span><span class="o">+</span><span class="n">CreditCost</span><span class="o">+</span><span class="n">FixedCost</span><span class="o">+</span><span class="mf">0.01</span><span class="o">*</span><span class="p">(</span><span class="n">cost_ibm</span><span class="o">*</span><span class="n">InvIbm</span><span class="p">[</span><span class="mi">3</span><span class="p">]</span><span class="o">+</span><span class="n">cost_mac</span><span class="o">*</span><span class="n">InvMac</span><span class="p">[</span><span class="mi">3</span><span class="p">])</span><span class="o">+</span><span class="n">cc</span><span class="p">[</span><span class="mi">3</span><span class="p">]</span><span class="o">+</span><span class="n">pay_back</span><span class="p">[</span><span class="mi">3</span><span class="p">]</span><span class="o">==</span><span class="n">borr</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span><span class="o">+</span><span class="n">borr</span><span class="p">[</span><span class="mi">3</span><span class="p">]</span><span class="o">+</span><span class="n">Rev</span><span class="p">[</span><span class="mi">3</span><span class="p">],</span> <span class="n">name</span><span class="o">=</span><span class="s1">&#39;Invest &#39;</span><span class="o">+</span><span class="n">id_lbl</span><span class="p">[</span><span class="mi">3</span><span class="p">])</span>
    <span class="c1"># excess funds in quarter 2-4</span>
    <span class="k">for</span> <span class="n">t</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">4</span><span class="p">,</span><span class="mi">7</span><span class="p">):</span>
        <span class="n">m</span><span class="o">.</span><span class="n">addConstr</span><span class="p">(</span><span class="n">Invest</span><span class="p">[</span><span class="n">t</span><span class="p">]</span><span class="o">+</span><span class="n">Prod</span><span class="p">[</span><span class="n">t</span><span class="p">]</span><span class="o">+</span><span class="n">Adv</span><span class="p">[</span><span class="n">t</span><span class="p">]</span><span class="o">+</span><span class="n">CreditCost</span><span class="o">+</span><span class="n">FixedCost</span><span class="o">+</span><span class="mf">0.01</span><span class="o">*</span><span class="p">(</span><span class="n">cost_ibm</span><span class="o">*</span><span class="n">InvIbm</span><span class="p">[</span><span class="n">t</span><span class="p">]</span><span class="o">+</span><span class="n">cost_mac</span><span class="o">*</span><span class="n">InvMac</span><span class="p">[</span><span class="n">t</span><span class="p">])</span><span class="o">+</span><span class="n">cc</span><span class="p">[</span><span class="n">t</span><span class="p">]</span><span class="o">+</span><span class="n">pay_back</span><span class="p">[</span><span class="n">t</span><span class="p">]</span><span class="o">==</span><span class="p">(</span><span class="mi">1</span><span class="o">+</span><span class="mf">0.06</span><span class="o">/</span><span class="mi">4</span><span class="p">)</span><span class="o">*</span><span class="n">Invest</span><span class="p">[</span><span class="n">t</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span><span class="o">+</span><span class="n">borr</span><span class="p">[</span><span class="n">t</span><span class="p">]</span><span class="o">+</span><span class="n">Rev</span><span class="p">[</span><span class="n">t</span><span class="p">],</span> <span class="n">name</span><span class="o">=</span><span class="s1">&#39;Invest &#39;</span><span class="o">+</span><span class="n">id_lbl</span><span class="p">[</span><span class="n">t</span><span class="p">])</span>


    <span class="c1"># production</span>
    <span class="c1"># t&lt;4</span>
    <span class="k">for</span> <span class="n">t</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span><span class="mi">6</span><span class="p">):</span>
        <span class="n">m</span><span class="o">.</span><span class="n">addConstr</span><span class="p">(</span><span class="n">Ibm</span><span class="p">[</span><span class="n">t</span><span class="p">]</span><span class="o">+</span><span class="n">InvIbm</span><span class="p">[</span><span class="n">t</span><span class="p">]</span><span class="o">&gt;=</span><span class="p">(</span><span class="mi">1</span><span class="o">+</span><span class="n">inv_cushion</span><span class="p">)</span><span class="o">*</span><span class="n">demand_ibm</span><span class="p">[</span><span class="n">t</span><span class="o">+</span><span class="mi">1</span><span class="p">],</span> <span class="n">name</span><span class="o">=</span><span class="s1">&#39;prod_IBM &#39;</span><span class="o">+</span><span class="n">id_lbl</span><span class="p">[</span><span class="n">t</span><span class="p">])</span>
        <span class="n">m</span><span class="o">.</span><span class="n">addConstr</span><span class="p">(</span><span class="n">Mac</span><span class="p">[</span><span class="n">t</span><span class="p">]</span><span class="o">+</span><span class="n">InvMac</span><span class="p">[</span><span class="n">t</span><span class="p">]</span><span class="o">&gt;=</span><span class="p">(</span><span class="mi">1</span><span class="o">+</span><span class="n">inv_cushion</span><span class="p">)</span><span class="o">*</span><span class="n">demand_mac</span><span class="p">[</span><span class="n">t</span><span class="o">+</span><span class="mi">1</span><span class="p">],</span> <span class="n">name</span><span class="o">=</span><span class="s1">&#39;prod_Mac &#39;</span><span class="o">+</span><span class="n">id_lbl</span><span class="p">[</span><span class="n">t</span><span class="p">])</span>

    <span class="k">for</span> <span class="n">t</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span><span class="mi">6</span><span class="p">):</span>
        <span class="n">m</span><span class="o">.</span><span class="n">addConstr</span><span class="p">(</span><span class="n">Ibm</span><span class="p">[</span><span class="n">t</span><span class="p">]</span><span class="o">&lt;=</span><span class="mi">30</span><span class="o">*</span><span class="mi">12</span><span class="o">*</span><span class="mi">20</span><span class="o">*</span><span class="mi">3</span><span class="p">,</span> <span class="n">name</span><span class="o">=</span><span class="s1">&#39;capacity_IBM &#39;</span><span class="o">+</span><span class="n">id_lbl</span><span class="p">[</span><span class="n">t</span><span class="p">])</span>
        <span class="n">m</span><span class="o">.</span><span class="n">addConstr</span><span class="p">(</span><span class="n">Mac</span><span class="p">[</span><span class="n">t</span><span class="p">]</span><span class="o">&lt;=</span><span class="mi">10</span><span class="o">*</span><span class="mi">12</span><span class="o">*</span><span class="mi">20</span><span class="o">*</span><span class="mi">3</span><span class="p">,</span> <span class="n">name</span><span class="o">=</span><span class="s1">&#39;capacity_Mac &#39;</span><span class="o">+</span><span class="n">id_lbl</span><span class="p">[</span><span class="n">t</span><span class="p">])</span>

    <span class="c1"># t=4</span>
    <span class="n">m</span><span class="o">.</span><span class="n">addConstr</span><span class="p">(</span><span class="n">Ibm</span><span class="p">[</span><span class="mi">6</span><span class="p">]</span><span class="o">+</span><span class="n">InvIbm</span><span class="p">[</span><span class="mi">6</span><span class="p">]</span><span class="o">&gt;=</span><span class="mi">2</span><span class="o">*</span><span class="n">demand_ibm</span><span class="p">[</span><span class="mi">6</span><span class="p">],</span> <span class="n">name</span><span class="o">=</span><span class="s1">&#39;prod_IBM &#39;</span><span class="o">+</span><span class="n">id_lbl</span><span class="p">[</span><span class="mi">6</span><span class="p">])</span>
    <span class="n">m</span><span class="o">.</span><span class="n">addConstr</span><span class="p">(</span><span class="n">Mac</span><span class="p">[</span><span class="mi">6</span><span class="p">]</span><span class="o">+</span><span class="n">InvMac</span><span class="p">[</span><span class="mi">6</span><span class="p">]</span><span class="o">&gt;=</span><span class="mi">2</span><span class="o">*</span><span class="n">demand_mac</span><span class="p">[</span><span class="mi">6</span><span class="p">],</span> <span class="n">name</span><span class="o">=</span><span class="s1">&#39;prod_Mac &#39;</span><span class="o">+</span><span class="n">id_lbl</span><span class="p">[</span><span class="mi">6</span><span class="p">])</span>

    <span class="n">m</span><span class="o">.</span><span class="n">addConstr</span><span class="p">(</span><span class="n">Ibm</span><span class="p">[</span><span class="mi">6</span><span class="p">]</span><span class="o">&lt;=</span><span class="p">(</span><span class="mi">1</span><span class="o">+</span><span class="n">prodCap_Q4</span><span class="p">)</span><span class="o">*</span><span class="mi">30</span><span class="o">*</span><span class="mi">12</span><span class="o">*</span><span class="mi">20</span><span class="o">*</span><span class="mi">3</span><span class="p">,</span> <span class="n">name</span><span class="o">=</span><span class="s1">&#39;capacity_IBM &#39;</span><span class="o">+</span><span class="n">id_lbl</span><span class="p">[</span><span class="mi">6</span><span class="p">])</span>
    <span class="n">m</span><span class="o">.</span><span class="n">addConstr</span><span class="p">(</span><span class="n">Mac</span><span class="p">[</span><span class="mi">6</span><span class="p">]</span><span class="o">&lt;=</span><span class="p">(</span><span class="mi">1</span><span class="o">+</span><span class="n">prodCap_Q4</span><span class="p">)</span><span class="o">*</span><span class="mi">10</span><span class="o">*</span><span class="mi">12</span><span class="o">*</span><span class="mi">20</span><span class="o">*</span><span class="mi">3</span><span class="p">,</span> <span class="n">name</span><span class="o">=</span><span class="s1">&#39;capacity_Mac &#39;</span><span class="o">+</span><span class="n">id_lbl</span><span class="p">[</span><span class="mi">6</span><span class="p">])</span>

    <span class="c1"># objective function: max(profit)</span>
    <span class="n">m</span><span class="o">.</span><span class="n">setObjective</span><span class="p">(</span><span class="n">gp</span><span class="o">.</span><span class="n">quicksum</span><span class="p">((</span><span class="mf">0.06</span><span class="o">/</span><span class="mi">4</span><span class="p">)</span><span class="o">*</span><span class="n">Invest</span><span class="p">[</span><span class="n">t</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span><span class="o">+</span><span class="n">Rev</span><span class="p">[</span><span class="n">t</span><span class="p">]</span><span class="o">-</span><span class="n">Adv</span><span class="p">[</span><span class="n">t</span><span class="p">]</span><span class="o">-</span><span class="n">Prod</span><span class="p">[</span><span class="n">t</span><span class="p">]</span><span class="o">-</span><span class="mf">0.01</span><span class="o">*</span><span class="p">(</span><span class="n">cost_ibm</span><span class="o">*</span><span class="n">InvIbm</span><span class="p">[</span><span class="n">t</span><span class="p">]</span><span class="o">+</span><span class="n">cost_mac</span><span class="o">*</span><span class="n">InvMac</span><span class="p">[</span><span class="n">t</span><span class="p">])</span><span class="o">-</span><span class="n">cc</span><span class="p">[</span><span class="n">t</span><span class="p">]</span><span class="o">-</span><span class="n">pay_back</span><span class="p">[</span><span class="n">t</span><span class="p">]</span><span class="o">-</span><span class="n">FixedCost</span>  <span class="k">for</span> <span class="n">t</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span><span class="mi">7</span><span class="p">)),</span> <span class="n">GRB</span><span class="o">.</span><span class="n">MAXIMIZE</span><span class="p">)</span>

    <span class="n">status</span> <span class="o">=</span> <span class="n">m</span><span class="o">.</span><span class="n">optimize</span><span class="p">()</span>
    
    <span class="nb">print</span><span class="p">()</span>
    <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Optimal Values for Decision Variables:&#39;</span><span class="p">)</span>
    <span class="n">adv</span> <span class="o">=</span> <span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">*</span> <span class="mi">7</span>
    <span class="n">advibm</span> <span class="o">=</span> <span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">*</span> <span class="mi">7</span>
    <span class="n">advmac</span> <span class="o">=</span> <span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">*</span> <span class="mi">7</span>
    <span class="n">ibm</span> <span class="o">=</span> <span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">*</span> <span class="mi">7</span>
    <span class="n">mac</span> <span class="o">=</span> <span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">*</span> <span class="mi">7</span>
    <span class="n">prod</span> <span class="o">=</span> <span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">*</span> <span class="mi">7</span>
    <span class="n">sibm</span> <span class="o">=</span> <span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">*</span> <span class="mi">7</span>
    <span class="n">smac</span> <span class="o">=</span> <span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">*</span> <span class="mi">7</span>
    <span class="n">invibm</span> <span class="o">=</span> <span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">*</span> <span class="mi">7</span>
    <span class="n">invmac</span> <span class="o">=</span> <span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">*</span> <span class="mi">7</span>
    <span class="n">invest</span> <span class="o">=</span> <span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">*</span> <span class="mi">7</span>
    <span class="n">rev</span> <span class="o">=</span> <span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">*</span> <span class="mi">7</span>
    <span class="n">pb</span> <span class="o">=</span> <span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">*</span><span class="mi">7</span>
    <span class="n">bor</span><span class="o">=</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">*</span><span class="mi">7</span>
    <span class="n">creditCost</span><span class="o">=</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">*</span><span class="mi">7</span>

    <span class="k">for</span> <span class="n">t</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">7</span><span class="p">):</span>
        <span class="n">adv</span><span class="p">[</span><span class="n">t</span><span class="p">]</span><span class="o">=</span><span class="n">Adv</span><span class="p">[</span><span class="n">t</span><span class="p">]</span><span class="o">.</span><span class="n">x</span>  
        <span class="n">advibm</span><span class="p">[</span><span class="n">t</span><span class="p">]</span><span class="o">=</span><span class="n">AdvIbm</span><span class="p">[</span><span class="n">t</span><span class="p">]</span><span class="o">.</span><span class="n">x</span>
        <span class="n">advmac</span><span class="p">[</span><span class="n">t</span><span class="p">]</span><span class="o">=</span><span class="n">AdvMac</span><span class="p">[</span><span class="n">t</span><span class="p">]</span><span class="o">.</span><span class="n">x</span>
        <span class="n">ibm</span><span class="p">[</span><span class="n">t</span><span class="p">]</span><span class="o">=</span><span class="n">Ibm</span><span class="p">[</span><span class="n">t</span><span class="p">]</span><span class="o">.</span><span class="n">x</span>
        <span class="n">mac</span><span class="p">[</span><span class="n">t</span><span class="p">]</span><span class="o">=</span><span class="n">Mac</span><span class="p">[</span><span class="n">t</span><span class="p">]</span><span class="o">.</span><span class="n">x</span>
        <span class="n">prod</span><span class="p">[</span><span class="n">t</span><span class="p">]</span><span class="o">=</span><span class="n">Prod</span><span class="p">[</span><span class="n">t</span><span class="p">]</span><span class="o">.</span><span class="n">x</span>
        <span class="n">sibm</span><span class="p">[</span><span class="n">t</span><span class="p">]</span><span class="o">=</span><span class="n">Sibm</span><span class="p">[</span><span class="n">t</span><span class="p">]</span><span class="o">.</span><span class="n">x</span>
        <span class="n">smac</span><span class="p">[</span><span class="n">t</span><span class="p">]</span><span class="o">=</span><span class="n">Smac</span><span class="p">[</span><span class="n">t</span><span class="p">]</span><span class="o">.</span><span class="n">x</span>
        <span class="n">invibm</span><span class="p">[</span><span class="n">t</span><span class="p">]</span><span class="o">=</span><span class="n">InvIbm</span><span class="p">[</span><span class="n">t</span><span class="p">]</span><span class="o">.</span><span class="n">x</span>
        <span class="n">invmac</span><span class="p">[</span><span class="n">t</span><span class="p">]</span><span class="o">=</span><span class="n">InvMac</span><span class="p">[</span><span class="n">t</span><span class="p">]</span><span class="o">.</span><span class="n">x</span>
        <span class="n">invest</span><span class="p">[</span><span class="n">t</span><span class="p">]</span><span class="o">=</span><span class="n">Invest</span><span class="p">[</span><span class="n">t</span><span class="p">]</span><span class="o">.</span><span class="n">x</span>
        <span class="n">rev</span><span class="p">[</span><span class="n">t</span><span class="p">]</span><span class="o">=</span><span class="n">Rev</span><span class="p">[</span><span class="n">t</span><span class="p">]</span><span class="o">.</span><span class="n">x</span>
        <span class="n">pb</span><span class="p">[</span><span class="n">t</span><span class="p">]</span><span class="o">=</span><span class="n">pay_back</span><span class="p">[</span><span class="n">t</span><span class="p">]</span><span class="o">.</span><span class="n">x</span>
        <span class="n">creditCost</span><span class="p">[</span><span class="n">t</span><span class="p">]</span><span class="o">=</span><span class="n">cc</span><span class="p">[</span><span class="n">t</span><span class="p">]</span><span class="o">.</span><span class="n">x</span>
        <span class="n">bor</span><span class="p">[</span><span class="n">t</span><span class="p">]</span><span class="o">=</span><span class="n">borr</span><span class="p">[</span><span class="n">t</span><span class="p">]</span><span class="o">.</span><span class="n">x</span>
        
    <span class="n">var_dict</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;ADV&#39;</span><span class="p">:</span><span class="n">adv</span><span class="p">,</span>
                <span class="s1">&#39;ADV_IBM&#39;</span><span class="p">:</span><span class="n">advibm</span><span class="p">,</span>
                <span class="s1">&#39;ADV_MAC&#39;</span><span class="p">:</span><span class="n">advmac</span><span class="p">,</span>
                <span class="s1">&#39;IBM&#39;</span><span class="p">:</span><span class="n">ibm</span><span class="p">,</span>
                <span class="s1">&#39;MAC&#39;</span><span class="p">:</span><span class="n">mac</span><span class="p">,</span>
                <span class="s1">&#39;PROD&#39;</span><span class="p">:</span><span class="n">prod</span><span class="p">,</span>
                <span class="s1">&#39;SIBM&#39;</span><span class="p">:</span><span class="n">sibm</span><span class="p">,</span>
                <span class="s1">&#39;SMAC&#39;</span><span class="p">:</span><span class="n">smac</span><span class="p">,</span>
                <span class="s1">&#39;INVIBM&#39;</span><span class="p">:</span><span class="n">invibm</span><span class="p">,</span>
                <span class="s1">&#39;INVMAC&#39;</span><span class="p">:</span><span class="n">invmac</span><span class="p">,</span>
                <span class="s1">&#39;INVEST&#39;</span><span class="p">:</span><span class="n">invest</span><span class="p">,</span>
                <span class="s1">&#39;REV&#39;</span><span class="p">:</span><span class="n">rev</span><span class="p">,</span>
               <span class="s1">&#39;PAY BACK&#39;</span><span class="p">:</span><span class="n">pb</span><span class="p">,</span>
               <span class="s1">&#39;BORR&#39;</span><span class="p">:</span><span class="n">bor</span><span class="p">,</span>
               <span class="s1">&#39;CC&#39;</span><span class="p">:</span><span class="n">creditCost</span><span class="p">}</span>
    
    <span class="k">if</span> <span class="n">display</span><span class="o">==</span><span class="kc">True</span><span class="p">:</span>
        <span class="n">i</span><span class="o">=</span><span class="mi">1</span>
        <span class="k">for</span> <span class="n">v</span> <span class="ow">in</span> <span class="n">m</span><span class="o">.</span><span class="n">getVars</span><span class="p">():</span> 
            <span class="k">if</span> <span class="n">i</span> <span class="o">&lt;</span> <span class="mi">7</span><span class="p">:</span>
                <span class="n">i</span><span class="o">+=</span><span class="mi">1</span>
                <span class="k">if</span> <span class="n">v</span><span class="o">.</span><span class="n">varName</span><span class="p">[</span><span class="mi">0</span><span class="p">:</span><span class="mi">4</span><span class="p">]</span><span class="o">!=</span><span class="s1">&#39;1995&#39;</span> <span class="ow">or</span> <span class="n">v</span><span class="o">.</span><span class="n">varName</span><span class="p">[</span><span class="mi">0</span><span class="p">:</span><span class="mi">7</span><span class="p">]</span><span class="o">==</span><span class="s1">&#39;1995 Q4&#39;</span><span class="p">:</span>
                    <span class="k">if</span> <span class="n">v</span><span class="o">.</span><span class="n">varName</span><span class="p">[</span><span class="mi">8</span><span class="p">:]</span> <span class="ow">in</span> <span class="p">[</span><span class="s1">&#39;Ibm&#39;</span><span class="p">,</span><span class="s1">&#39;Mac&#39;</span><span class="p">,</span><span class="s1">&#39;Sibm&#39;</span><span class="p">,</span><span class="s1">&#39;Smac&#39;</span><span class="p">,</span><span class="s1">&#39;InvIbm&#39;</span><span class="p">,</span><span class="s1">&#39;InvMac&#39;</span><span class="p">]:</span>
                        <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;%s: %g &#39;</span> <span class="o">%</span><span class="p">(</span><span class="n">v</span><span class="o">.</span><span class="n">varName</span><span class="p">,</span><span class="n">math</span><span class="o">.</span><span class="n">floor</span><span class="p">(</span><span class="n">v</span><span class="o">.</span><span class="n">x</span><span class="p">)),</span> <span class="n">end</span><span class="o">=</span><span class="s1">&#39;| &#39;</span><span class="p">)</span>
                    <span class="k">else</span><span class="p">:</span> 
                        <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;%s: %g &#39;</span> <span class="o">%</span><span class="p">(</span><span class="n">v</span><span class="o">.</span><span class="n">varName</span><span class="p">,</span><span class="n">v</span><span class="o">.</span><span class="n">x</span><span class="p">),</span> <span class="n">end</span><span class="o">=</span><span class="s1">&#39;| &#39;</span><span class="p">)</span>

            <span class="k">else</span><span class="p">:</span>
                <span class="n">i</span><span class="o">=</span><span class="mi">1</span>
                <span class="k">if</span> <span class="n">v</span><span class="o">.</span><span class="n">varName</span><span class="p">[</span><span class="mi">0</span><span class="p">:</span><span class="mi">4</span><span class="p">]</span><span class="o">!=</span><span class="s1">&#39;1995&#39;</span> <span class="ow">or</span> <span class="n">v</span><span class="o">.</span><span class="n">varName</span><span class="p">[</span><span class="mi">0</span><span class="p">:</span><span class="mi">7</span><span class="p">]</span><span class="o">==</span><span class="s1">&#39;1995 Q4&#39;</span><span class="p">:</span>
                    <span class="k">if</span> <span class="n">v</span><span class="o">.</span><span class="n">varName</span><span class="p">[</span><span class="mi">8</span><span class="p">:]</span> <span class="ow">in</span> <span class="p">[</span><span class="s1">&#39;Ibm&#39;</span><span class="p">,</span><span class="s1">&#39;Mac&#39;</span><span class="p">,</span><span class="s1">&#39;Sibm&#39;</span><span class="p">,</span><span class="s1">&#39;Smac&#39;</span><span class="p">,</span><span class="s1">&#39;InvIbm&#39;</span><span class="p">,</span><span class="s1">&#39;InvMac&#39;</span><span class="p">]:</span>
                        <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;%s: %g &#39;</span> <span class="o">%</span><span class="p">(</span><span class="n">v</span><span class="o">.</span><span class="n">varName</span><span class="p">,</span><span class="n">math</span><span class="o">.</span><span class="n">floor</span><span class="p">(</span><span class="n">v</span><span class="o">.</span><span class="n">x</span><span class="p">)))</span>
                    <span class="k">else</span><span class="p">:</span> 
                        <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;%s: %g &#39;</span> <span class="o">%</span><span class="p">(</span><span class="n">v</span><span class="o">.</span><span class="n">varName</span><span class="p">,</span><span class="n">v</span><span class="o">.</span><span class="n">x</span><span class="p">))</span>
                <span class="nb">print</span><span class="p">()</span>
            
    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;The objective value achieved in profit: </span><span class="si">{</span><span class="nb">round</span><span class="p">(</span><span class="n">m</span><span class="o">.</span><span class="n">objVal</span><span class="p">,</span><span class="mi">2</span><span class="p">)</span><span class="si">}</span><span class="s1"> dollars&#39;</span><span class="p">)</span>
    
    <span class="n">variables_df</span><span class="p">,</span> <span class="n">constraints_df</span> <span class="o">=</span> <span class="n">sensitivity_analysis_table</span><span class="p">(</span><span class="n">m</span><span class="p">)</span>
    
    <span class="k">return</span> <span class="n">status</span><span class="p">,</span> <span class="n">variables_df</span><span class="p">,</span> <span class="n">constraints_df</span><span class="p">,</span> <span class="n">var_dict</span>

<span class="c1">## output present</span>
<span class="c1"># status_or, variables_df, constraints_df, var_dict = AOS_ref()</span>
<span class="c1"># pd.DataFrame(var_dict, index = id_lbl)[3:]</span>
</pre></div>

     </div>
</div>
</div>
</div>

</div>









<script type="module" src="https://s.brightspace.com/lib/bsi/2024.12.210/unbundled/mathjax.js"></script><script type="text/javascript">document.addEventListener('DOMContentLoaded', function() {
						if (document.querySelector('math') || /\$\$|\\\(|\\\[|\\begin{|\\ref{|\\eqref{/.test(document.body.innerHTML)) {
							document.querySelectorAll('mspace[linebreak="newline"]').forEach(elm => {
								elm.setAttribute('style', 'display: block; height: 0.5rem;');
							});

							window.D2L.MathJax.loadMathJax({
								outputScale: 1.5,
								renderLatex: true,
								enableMML3Support: false
							});
						}
					});</script><script type="module" src="https://s.brightspace.com/lib/bsi/2024.12.210/unbundled/prism.js"></script><script type="text/javascript">document.addEventListener('DOMContentLoaded', function() {
					document.querySelectorAll('.d2l-code').forEach(code => {
						window.D2L.Prism.formatCodeElement(code);
					});
				});</script><script type="module" src="https://s.brightspace.com/lib/bsi/2024.12.210/unbundled/embeds.js"></script><script type="text/javascript">document.addEventListener('DOMContentLoaded', function() {
					window.D2L.EmbedRenderer.renderEmbeds(document.body);
				});</script></body></html>